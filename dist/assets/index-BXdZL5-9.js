import{r as w,d as ce,c as j,a as Rt,b as i,n as h,e as st,f as ft,m as te,g as ee,w as N,h as g,i as t,F as H,j as c,t as r,k as Ee,l as lt,T as Ne,o as G,p as Ue,u as Le,q as Q,s as Ve,v as Be,x as Fe,y as ue,z as n,A as se,B as A,C as bt,D as dt,E as Lt,G as E,H as et,I as me,J as jt,K as rt,L as ot,M as Kt,N as Tt,O as Xt,P as Yt,Q as Mt,R as Oe,S as qe,U as je}from"./vendor-XKJqpTIx.js";import{M as Gt}from"./ui-CY1Kz5oP.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))s(m);new MutationObserver(m=>{for(const u of m)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function d(m){const u={};return m.integrity&&(u.integrity=m.integrity),m.referrerPolicy&&(u.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?u.credentials="include":m.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(m){if(m.ep)return;m.ep=!0;const u=d(m);fetch(m.href,u)}})();const K={users:[{id:"1",email:"admin@company.com",firstName:"Администратор",lastName:"Системы",middleName:"",role:"admin",department:"IT",position:"Системный администратор",points:1250,avatar:null,phone:"+7 (999) 123-45-67",createdAt:"2024-01-15T10:00:00Z",lastLoginAt:"2024-12-19T14:30:00Z"},{id:"2",email:"moderator@company.com",firstName:"Модератор",lastName:"Событий",middleName:"",role:"moderator",department:"HR",position:"HR-менеджер",points:890,avatar:null,phone:"+7 (999) 234-56-78",createdAt:"2024-02-20T09:00:00Z",lastLoginAt:"2024-12-19T13:45:00Z"},{id:"3",email:"user@company.com",firstName:"Иван",lastName:"Петров",middleName:"Сергеевич",role:"user",department:"Разработка",position:"Frontend разработчик",points:650,avatar:null,phone:"+7 (999) 345-67-89",createdAt:"2024-03-10T11:00:00Z",lastLoginAt:"2024-12-19T12:15:00Z"}],events:[{id:"1",title:"Тренинг по личной эффективности",description:"Интенсивный тренинг по развитию личной эффективности и тайм-менеджменту",startDate:"2024-12-25T10:00:00Z",endDate:"2024-12-25T18:00:00Z",location:"Конференц-зал А",type:"training",category:"training",pointsReward:50,maxParticipants:30,currentParticipants:15,status:"upcoming",registrationDeadline:"2024-12-24T18:00:00Z",isRegistrationOpen:!0,image:null,tags:["эффективность","тайм-менеджмент"],organizer:{id:"2",name:"Модератор Событий"},createdAt:"2024-12-15T10:00:00Z"},{id:"2",title:"Корпоративный хакатон",description:"24-часовой хакатон для разработки инновационных решений",startDate:"2024-12-28T09:00:00Z",endDate:"2024-12-29T09:00:00Z",location:"IT-центр",type:"workshop",category:"workshop",pointsReward:100,maxParticipants:50,currentParticipants:35,status:"upcoming",registrationDeadline:"2024-12-27T18:00:00Z",isRegistrationOpen:!0,image:null,tags:["разработка","инновации"],organizer:{id:"1",name:"Администратор Системы"},createdAt:"2024-12-10T14:00:00Z"},{id:"3",title:"Новогодний корпоратив",description:"Праздничное мероприятие для всей компании",startDate:"2024-12-30T19:00:00Z",endDate:"2024-12-31T02:00:00Z",location:'Ресторан "Праздник"',type:"social",category:"social",pointsReward:25,maxParticipants:200,currentParticipants:180,status:"upcoming",registrationDeadline:"2024-12-29T18:00:00Z",isRegistrationOpen:!0,image:null,tags:["праздник","корпоратив"],organizer:{id:"2",name:"Модератор Событий"},createdAt:"2024-12-01T12:00:00Z"},{id:"4",title:"Мастер-класс по публичным выступлениям",description:"Обучение навыкам эффективных публичных выступлений",startDate:"2024-12-22T14:00:00Z",endDate:"2024-12-22T17:00:00Z",location:"Аудитория 301",type:"training",category:"training",pointsReward:40,maxParticipants:25,currentParticipants:20,status:"upcoming",registrationDeadline:"2024-12-21T18:00:00Z",isRegistrationOpen:!0,image:null,tags:["выступления","коммуникация"],organizer:{id:"2",name:"Модератор Событий"},createdAt:"2024-12-12T09:00:00Z"}],registrations:[{id:"1",eventId:"2",userId:"3",status:"approved",registeredAt:"2024-12-15T10:30:00Z",attended:!1,feedback:null,pointsAwarded:null},{id:"2",eventId:"3",userId:"3",status:"approved",registeredAt:"2024-12-05T14:20:00Z",attended:!1,feedback:null,pointsAwarded:null}],rewards:[{id:"1",title:"Бесплатный обед в кафетерии",description:"Ваучер на бесплатный обед в корпоративном кафетерии",pointsCost:50,type:"service",category:"food",quantity:100,availableQuantity:85,image:null,isActive:!0,createdAt:"2024-11-01T10:00:00Z"},{id:"2",title:"Корпоративная футболка",description:"Стильная футболка с логотипом компании",pointsCost:200,type:"prize",category:"clothing",quantity:50,availableQuantity:32,image:null,isActive:!0,createdAt:"2024-11-05T14:00:00Z"},{id:"3",title:"День удаленной работы",description:"Возможность работать удаленно в течение одного дня",pointsCost:300,type:"privilege",category:"work",quantity:30,availableQuantity:18,image:null,isActive:!0,createdAt:"2024-11-10T09:00:00Z"},{id:"4",title:"Билет в кино",description:"Билет на любой фильм в кинотеатре",pointsCost:150,type:"voucher",category:"entertainment",quantity:80,availableQuantity:45,image:null,isActive:!0,createdAt:"2024-11-15T16:00:00Z"}],purchases:[{id:"1",rewardId:"1",userId:"3",status:"completed",pointsSpent:50,purchasedAt:"2024-12-10T12:00:00Z",completedAt:"2024-12-10T12:30:00Z",feedback:null},{id:"2",rewardId:"2",userId:"3",status:"pending",pointsSpent:200,purchasedAt:"2024-12-18T15:00:00Z",completedAt:null,feedback:null}],pointsHistory:[{id:"1",userId:"3",type:"earned",amount:50,description:"Участие в мастер-классе по публичным выступлениям",eventId:"4",createdAt:"2024-12-18T16:30:00Z"},{id:"2",userId:"3",type:"spent",amount:-200,description:"Покупка корпоративной футболки",purchaseId:"2",createdAt:"2024-12-18T15:00:00Z"},{id:"3",userId:"3",type:"spent",amount:-50,description:"Покупка бесплатного обеда",purchaseId:"1",createdAt:"2024-12-10T12:00:00Z"}]},nt=w({currentUser:null,isAuthenticated:!1}),tt={generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)},filterData(a,e){return a.filter(d=>{if(e.search){const s=e.search.toLowerCase();if(d.title&&!d.title.toLowerCase().includes(s)||d.description&&!d.description.toLowerCase().includes(s))return!1}return!(e.category&&d.category!==e.category||e.status&&d.status!==e.status||e.type&&d.type!==e.type)})},sortData(a,e,d="asc"){return[...a].sort((s,m)=>{let u,o;switch(e){case"start_date":u=new Date(s.startDate),o=new Date(m.startDate);break;case"title":u=s.title.toLowerCase(),o=m.title.toLowerCase();break;case"points":u=s.pointsReward||s.pointsCost||0,o=m.pointsReward||m.pointsCost||0;break;case"created_at":u=new Date(s.createdAt),o=new Date(m.createdAt);break;default:return 0}return d==="desc"?u<o?1:u>o?-1:0:u>o?1:u<o?-1:0})},paginateData(a,e=1,d=10){const s=(e-1)*d,m=s+d;return{data:a.slice(s,m),pagination:{page:e,limit:d,total:a.length,totalPages:Math.ceil(a.length/d)}}},async delay(a=500){return new Promise(e=>setTimeout(e,a))}},ct={auth:{async login(a){await tt.delay(800);const e=K.users.find(d=>d.email===a.email);if(!e||a.password!=="password")throw new Error("Неверный email или пароль");return nt.value.currentUser=e,nt.value.isAuthenticated=!0,{user:e,accessToken:"mock-token-"+Date.now(),refreshToken:"mock-refresh-"+Date.now()}},async register(a){if(await tt.delay(1e3),K.users.find(s=>s.email===a.email))throw new Error("Пользователь с таким email уже существует");const d={id:tt.generateId(),...a,role:"user",points:0,avatar:null,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()};return K.users.push(d),nt.value.currentUser=d,nt.value.isAuthenticated=!0,{user:d,accessToken:"mock-token-"+Date.now(),refreshToken:"mock-refresh-"+Date.now()}},async logout(){return await tt.delay(300),nt.value.currentUser=null,nt.value.isAuthenticated=!1,{success:!0}},async me(){if(await tt.delay(200),!nt.value.isAuthenticated)throw new Error("Не авторизован");return{user:nt.value.currentUser}}},users:{async list(a={}){await tt.delay(600);let e=[...K.users];if(a.search){const m=a.search.toLowerCase();e=e.filter(u=>u.firstName.toLowerCase().includes(m)||u.lastName.toLowerCase().includes(m)||u.email.toLowerCase().includes(m))}a.role&&(e=e.filter(m=>m.role===a.role));const d=tt.sortData(e,a.sortBy||"created_at",a.sortOrder),s=tt.paginateData(d,a.page,a.limit);return{users:s.data,pagination:s.pagination}},async get(a){await tt.delay(300);const e=K.users.find(d=>d.id===a);if(!e)throw new Error("Пользователь не найден");return{user:e}},async update(a,e){await tt.delay(500);const d=K.users.findIndex(s=>s.id===a);if(d===-1)throw new Error("Пользователь не найден");return K.users[d]={...K.users[d],...e},{user:K.users[d]}},async leaderboard(a={}){await tt.delay(400);const e=[...K.users].filter(s=>s.role==="user").sort((s,m)=>m.points-s.points),d=tt.paginateData(e,a.page,a.limit);return{leaderboard:d.data.map((s,m)=>({...s,rank:d.pagination.page*d.pagination.limit-d.pagination.limit+m+1})),pagination:d.pagination}}},events:{async list(a={}){await tt.delay(600);let e=[...K.events];if(a.search){const m=a.search.toLowerCase();e=e.filter(u=>u.title.toLowerCase().includes(m)||u.description.toLowerCase().includes(m))}if(a.category&&(e=e.filter(m=>m.category===a.category)),a.status&&(e=e.filter(m=>m.status===a.status)),a.upcoming){const m=new Date;e=e.filter(u=>new Date(u.startDate)>m)}const d=tt.sortData(e,a.sortBy||"start_date",a.sortOrder),s=tt.paginateData(d,a.page,a.limit);return{events:s.data,pagination:s.pagination}},async get(a){await tt.delay(300);const e=K.events.find(d=>d.id===a);if(!e)throw new Error("Мероприятие не найдено");return{event:e}},async create(a){await tt.delay(800);const e={id:tt.generateId(),...a,currentParticipants:0,status:"upcoming",isRegistrationOpen:!0,image:null,tags:a.tags||[],organizer:{id:nt.value.currentUser.id,name:`${nt.value.currentUser.firstName} ${nt.value.currentUser.lastName}`},createdAt:new Date().toISOString()};return K.events.push(e),{event:e}},async update(a,e){await tt.delay(600);const d=K.events.findIndex(s=>s.id===a);if(d===-1)throw new Error("Мероприятие не найдено");return K.events[d]={...K.events[d],...e},{event:K.events[d]}},async delete(a){await tt.delay(400);const e=K.events.findIndex(d=>d.id===a);if(e===-1)throw new Error("Мероприятие не найдено");return K.events.splice(e,1),{success:!0}}},registrations:{async create(a){await tt.delay(500);const e=K.events.find(u=>u.id===a);if(!e)throw new Error("Мероприятие не найдено");if(!e.isRegistrationOpen)throw new Error("Регистрация на мероприятие закрыта");if(e.currentParticipants>=e.maxParticipants)throw new Error("Достигнут лимит участников");if(K.registrations.find(u=>u.eventId===a&&u.userId===nt.value.currentUser.id))throw new Error("Вы уже зарегистрированы на это мероприятие");const s={id:tt.generateId(),eventId:a,userId:nt.value.currentUser.id,status:"pending",registeredAt:new Date().toISOString(),attended:!1,feedback:null,pointsAwarded:null};K.registrations.push(s);const m=K.events.findIndex(u=>u.id===a);return K.events[m].currentParticipants++,{registration:s}},async my(a={}){await tt.delay(400);const d=K.registrations.filter(u=>u.userId===nt.value.currentUser.id).map(u=>{const o=K.events.find(l=>l.id===u.eventId);return{...u,event:o}}),s=tt.sortData(d,a.sortBy||"registered_at","desc"),m=tt.paginateData(s,a.page,a.limit);return{registrations:m.data,pagination:m.pagination}},async cancel(a){await tt.delay(400);const e=K.registrations.findIndex(m=>m.id===a);if(e===-1)throw new Error("Регистрация не найдена");const d=K.registrations[e];if(d.userId!==nt.value.currentUser.id)throw new Error("Нет прав для отмены этой регистрации");const s=K.events.findIndex(m=>m.id===d.eventId);return s!==-1&&K.events[s].currentParticipants--,K.registrations.splice(e,1),{success:!0}}},rewards:{async list(a={}){await tt.delay(500);let e=K.rewards.filter(m=>m.isActive);if(a.search){const m=a.search.toLowerCase();e=e.filter(u=>u.title.toLowerCase().includes(m)||u.description.toLowerCase().includes(m))}a.type&&(e=e.filter(m=>m.type===a.type)),a.category&&(e=e.filter(m=>m.category===a.category));const d=tt.sortData(e,a.sortBy||"created_at","desc"),s=tt.paginateData(d,a.page,a.limit);return{rewards:s.data,pagination:s.pagination}},async get(a){await tt.delay(300);const e=K.rewards.find(d=>d.id===a);if(!e)throw new Error("Награда не найдена");return{reward:e}},async purchase(a){await tt.delay(600);const e=K.rewards.find(o=>o.id===a);if(!e)throw new Error("Награда не найдена");if(!e.isActive)throw new Error("Награда недоступна");if(e.availableQuantity<=0)throw new Error("Награда закончилась");if(nt.value.currentUser.points<e.pointsCost)throw new Error("Недостаточно баллов");const d={id:tt.generateId(),rewardId:a,userId:nt.value.currentUser.id,status:"pending",pointsSpent:e.pointsCost,purchasedAt:new Date().toISOString(),completedAt:null,feedback:null};K.purchases.push(d);const s=K.rewards.findIndex(o=>o.id===a);K.rewards[s].availableQuantity--;const m=K.users.findIndex(o=>o.id===nt.value.currentUser.id);K.users[m].points-=e.pointsCost,nt.value.currentUser.points-=e.pointsCost;const u={id:tt.generateId(),userId:nt.value.currentUser.id,type:"spent",amount:-e.pointsCost,description:`Покупка "${e.title}"`,purchaseId:d.id,createdAt:new Date().toISOString()};return K.pointsHistory.push(u),{purchase:d}}},purchases:{async my(a={}){await tt.delay(400);const d=K.purchases.filter(u=>u.userId===nt.value.currentUser.id).map(u=>{const o=K.rewards.find(l=>l.id===u.rewardId);return{...u,reward:o}}),s=tt.sortData(d,a.sortBy||"purchased_at","desc"),m=tt.paginateData(s,a.page,a.limit);return{purchases:m.data,pagination:m.pagination}}},statistics:{async dashboard(){await tt.delay(400);const a=K.registrations.filter(f=>f.userId===nt.value.currentUser.id),e=K.purchases.filter(f=>f.userId===nt.value.currentUser.id),d=a.filter(f=>f.attended).length,s=a.filter(f=>!f.attended&&f.status==="approved").length,m=e.length,u=e.reduce((f,_)=>f+_.pointsSpent,0),v=K.users.filter(f=>f.role==="user").sort((f,_)=>_.points-f.points).findIndex(f=>f.id===nt.value.currentUser.id)+1;return{attendedEvents:d,upcomingEvents:s,totalPurchases:m,pointsSpent:u,pointsThisMonth:Math.floor(Math.random()*200)+50,rank:v,department:nt.value.currentUser.department}}}},ht={auth:{login:a=>ct.auth.login(a),register:a=>ct.auth.register(a),logout:()=>ct.auth.logout(),refresh:a=>Promise.resolve({data:{accessToken:"new-token"}}),me:()=>ct.auth.me(),changePassword:a=>Promise.resolve({success:!0})},users:{list:a=>ct.users.list(a),get:a=>ct.users.get(a),update:(a,e)=>ct.users.update(a,e),delete:a=>Promise.resolve({success:!0}),pointsHistory:(a,e)=>Promise.resolve({data:[]}),awardPoints:(a,e)=>Promise.resolve({success:!0}),leaderboard:a=>ct.users.leaderboard(a),stats:()=>Promise.resolve({data:{}})},events:{list:a=>ct.events.list(a),get:a=>ct.events.get(a),create:a=>ct.events.create(a),update:(a,e)=>ct.events.update(a,e),delete:a=>ct.events.delete(a),participants:(a,e)=>Promise.resolve({data:[]}),stats:a=>Promise.resolve({data:{}})},registrations:{create:a=>ct.registrations.create(a),my:a=>ct.registrations.my(a),get:a=>Promise.resolve({data:{}}),approve:a=>Promise.resolve({success:!0}),reject:(a,e)=>Promise.resolve({success:!0}),attendance:(a,e)=>Promise.resolve({success:!0}),cancel:a=>ct.registrations.cancel(a),feedback:(a,e)=>Promise.resolve({success:!0}),pending:a=>Promise.resolve({data:[]})},rewards:{list:a=>ct.rewards.list(a),get:a=>ct.rewards.get(a),create:a=>Promise.resolve({data:{}}),update:(a,e)=>Promise.resolve({data:{}}),delete:a=>Promise.resolve({success:!0}),purchase:a=>ct.rewards.purchase(a),stats:a=>Promise.resolve({data:{}})},purchases:{my:a=>ct.purchases.my(a),list:a=>Promise.resolve({data:[]}),get:a=>Promise.resolve({data:{}}),process:(a,e)=>Promise.resolve({success:!0}),complete:(a,e)=>Promise.resolve({success:!0}),deliver:(a,e)=>Promise.resolve({success:!0}),cancel:(a,e)=>Promise.resolve({success:!0}),refund:(a,e)=>Promise.resolve({success:!0}),feedback:(a,e)=>Promise.resolve({success:!0}),pending:a=>Promise.resolve({data:[]}),stats:a=>Promise.resolve({data:{}})},statistics:{dashboard:a=>ct.statistics.dashboard(a),engagement:a=>Promise.resolve({data:{}}),eventsAnalytics:a=>Promise.resolve({data:{}}),pointsAnalytics:a=>Promise.resolve({data:{}})}},pt=ce("auth",()=>{const a=w(null),e=w(localStorage.getItem("token")),d=w(localStorage.getItem("refreshToken")),s=w(!1),m=j(()=>!!e.value&&!!a.value),u=j(()=>{var D;return((D=a.value)==null?void 0:D.role)==="admin"}),o=j(()=>{var D;return((D=a.value)==null?void 0:D.role)==="moderator"||u.value}),l=j(()=>{var D;return((D=a.value)==null?void 0:D.role)==="user"}),v=j(()=>{if(!a.value)return"";const{firstName:D,lastName:L,middleName:W}=a.value;return`${L} ${D}${W?" "+W:""}`}),f=j(()=>{if(!a.value)return"";const{firstName:D,lastName:L}=a.value;return`${(D==null?void 0:D[0])||""}${(L==null?void 0:L[0])||""}`.toUpperCase()}),_=async D=>{var L,W;try{s.value=!0;const q=await ht.auth.login(D),{user:O,accessToken:C,refreshToken:b}=q.data||q;return a.value=O,e.value=C,d.value=b,localStorage.setItem("token",C),localStorage.setItem("refreshToken",b),{success:!0,user:O}}catch(q){return console.error("Ошибка входа:",q),{success:!1,error:((W=(L=q.response)==null?void 0:L.data)==null?void 0:W.error)||q.message||"Ошибка входа в систему"}}finally{s.value=!1}},M=async D=>{var L,W;try{s.value=!0;const q=await ht.auth.register(D),{user:O,accessToken:C,refreshToken:b}=q.data||q;return a.value=O,e.value=C,d.value=b,localStorage.setItem("token",C),localStorage.setItem("refreshToken",b),{success:!0,user:O}}catch(q){return console.error("Ошибка регистрации:",q),{success:!1,error:((W=(L=q.response)==null?void 0:L.data)==null?void 0:W.error)||q.message||"Ошибка регистрации"}}finally{s.value=!1}},R=async()=>{try{e.value&&await ht.auth.logout()}catch(D){console.error("Ошибка при выходе:",D)}finally{k(),Bt.push("/auth/login")}},k=()=>{a.value=null,e.value=null,d.value=null,localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},V=async()=>{var L,W;const D=localStorage.getItem("token");if(!D)return k(),!1;try{const q=await ht.auth.me();return a.value=((L=q.data)==null?void 0:L.user)||q.user,e.value=D,d.value=localStorage.getItem("refreshToken"),!0}catch(q){return console.error("Ошибка проверки аутентификации:",q),((W=q.response)==null?void 0:W.status)===401&&await I()?!0:(k(),!1)}},I=async()=>{const D=localStorage.getItem("refreshToken");if(!D)return!1;try{const L=await ht.auth.refresh(D),{accessToken:W,refreshToken:q}=L.data||L;return e.value=W,d.value=q,localStorage.setItem("token",W),localStorage.setItem("refreshToken",q),!0}catch(L){return console.error("Ошибка обновления токена:",L),!1}},F=async D=>{var L,W,q;try{s.value=!0;const O=await ht.users.update(a.value.id,D);return a.value={...a.value,...((L=O.data)==null?void 0:L.user)||O.user},{success:!0,user:a.value}}catch(O){return console.error("Ошибка обновления профиля:",O),{success:!1,error:((q=(W=O.response)==null?void 0:W.data)==null?void 0:q.error)||O.message||"Ошибка обновления профиля"}}finally{s.value=!1}},$=async D=>{var L,W;try{return s.value=!0,await ht.auth.changePassword(D),{success:!0}}catch(q){return console.error("Ошибка смены пароля:",q),{success:!1,error:((W=(L=q.response)==null?void 0:L.data)==null?void 0:W.error)||q.message||"Ошибка смены пароля"}}finally{s.value=!1}},x=D=>{if(!a.value)return!1;const L={user:1,moderator:2,admin:3},W=L[a.value.role]||0,q=L[D]||0;return W>=q};return{user:a,token:e,refreshToken:d,isLoading:s,isAuthenticated:m,isAdmin:u,isModerator:o,isUser:l,fullName:v,initials:f,login:_,register:M,logout:R,clearAuth:k,checkAuth:V,refreshAuthToken:I,updateProfile:F,changePassword:$,hasPermission:x,canAccessRoute:D=>{var L,W;return(L=D.meta)!=null&&L.requiresAuth?m.value?(W=D.meta)!=null&&W.roles?D.meta.roles.some(q=>x(q)):!0:!1:!0}}}),ut=ce("app",()=>{const a=w(!1),e=w(!1),d=w(localStorage.getItem("theme")||"light"),s=w([]),m=w([]),u=w(""),o=w(""),l=w({itemsPerPage:20,dateFormat:"dd.MM.yyyy",timeFormat:"24h",language:"ru",timezone:"Europe/Moscow"}),v=j(()=>s.value.filter(S=>!S.isRead).length),f=S=>{a.value=S},_=()=>{e.value=!e.value},M=S=>{e.value=S},R=S=>{d.value=S,localStorage.setItem("theme",S),document.documentElement.setAttribute("data-theme",S)},k=()=>{const S=d.value==="light"?"dark":"light";R(S)},V=S=>{m.value=S},I=S=>{m.value.push(S)},F=(S,Z="")=>{u.value=S,o.value=Z,document.title=S?`${S} - Учёт активности предприятия`:"Учёт активности предприятия"},$=S=>{const Z={id:Date.now()+Math.random(),timestamp:new Date,isRead:!1,...S};s.value.unshift(Z),s.value.length>50&&(s.value=s.value.slice(0,50))},x=S=>{const Z=s.value.find(X=>X.id===S);Z&&(Z.isRead=!0)},y=()=>{s.value.forEach(S=>{S.isRead=!0})},D=S=>{const Z=s.value.findIndex(X=>X.id===S);Z>-1&&s.value.splice(Z,1)},L=()=>{s.value=[]},W=S=>{l.value={...l.value,...S},localStorage.setItem("appSettings",JSON.stringify(l.value))},q=()=>{const S=localStorage.getItem("appSettings");if(S)try{const Z=JSON.parse(S);l.value={...l.value,...Z}}catch(Z){console.error("Ошибка загрузки настроек:",Z)}},O=(S,Z=null)=>{if(!S)return"";const X=new Date(S);if(isNaN(X.getTime()))return"";const _t=Z||l.value.dateFormat,gt=String(X.getDate()).padStart(2,"0"),$t=String(X.getMonth()+1).padStart(2,"0"),Pt=X.getFullYear(),Zt=String(X.getHours()).padStart(2,"0"),Nt=String(X.getMinutes()).padStart(2,"0");switch(_t){case"dd.MM.yyyy":return`${gt}.${$t}.${Pt}`;case"dd.MM.yyyy HH:mm":return`${gt}.${$t}.${Pt} ${Zt}:${Nt}`;case"DD MMM YYYY":return`${gt} ${["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"][X.getMonth()]} ${Pt}`;case"relative":return C(X);default:return`${gt}.${$t}.${Pt}`}},C=S=>{const X=new Date-S,_t=Math.floor(X/1e3),gt=Math.floor(_t/60),$t=Math.floor(gt/60),Pt=Math.floor($t/24);return _t<60?"только что":gt<60?`${gt} мин назад`:$t<24?`${$t} ч назад`:Pt<7?`${Pt} дн назад`:O(S,"dd.MM.yyyy")},b=S=>!S&&S!==0?"":new Intl.NumberFormat("ru-RU").format(S),B=(S,Z)=>{const X=[2,0,1,1,1,2];return Z[S%100>4&&S%100<20?2:X[S%10<5?S%10:5]]},at=(S,Z=100)=>S?S.length<=Z?S:S.slice(0,Z)+"...":"",p=(S,Z)=>{try{localStorage.setItem(S,JSON.stringify(Z))}catch(X){console.error("Ошибка сохранения в localStorage:",X)}},T=(S,Z=null)=>{try{const X=localStorage.getItem(S);return X?JSON.parse(X):Z}catch(X){return console.error("Ошибка чтения из localStorage:",X),Z}},P=S=>{try{localStorage.removeItem(S)}catch(Z){console.error("Ошибка удаления из localStorage:",Z)}},z=()=>{q(),document.documentElement.setAttribute("data-theme",d.value);const S=()=>{window.innerWidth>=992&&M(!1)};window.addEventListener("resize",S),S()},it=w(navigator.onLine),kt=()=>{it.value=navigator.onLine};window.addEventListener("online",kt),window.addEventListener("offline",kt);const U=()=>{it.value||$({type:"warning",title:"Нет подключения к интернету",message:"Проверьте подключение к сети"})};return z(),{isLoading:a,isSidebarOpen:e,theme:d,notifications:s,breadcrumbs:m,pageTitle:u,pageSubtitle:o,settings:l,isOnline:it,unreadNotificationsCount:v,setLoading:f,toggleSidebar:_,setSidebarOpen:M,setTheme:R,toggleTheme:k,setBreadcrumbs:V,addBreadcrumb:I,setPageTitle:F,addNotification:$,markNotificationAsRead:x,markAllNotificationsAsRead:y,removeNotification:D,clearNotifications:L,updateSettings:W,loadSettings:q,formatDate:O,formatRelativeDate:C,formatNumber:b,pluralize:B,truncate:at,setLocalStorage:p,getLocalStorage:T,removeLocalStorage:P,showConnectionStatus:U}});var He=Object.defineProperty,oe=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable,ne=(a,e,d)=>e in a?He(a,e,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[e]=d,ve=(a,e)=>{for(var d in e||(e={}))ze.call(e,d)&&ne(a,d,e[d]);if(oe)for(var d of oe(e))Ze.call(e,d)&&ne(a,d,e[d]);return a},Ht=a=>typeof a=="function",zt=a=>typeof a=="string",fe=a=>zt(a)&&a.trim().length>0,We=a=>typeof a=="number",It=a=>typeof a>"u",Ut=a=>typeof a=="object"&&a!==null,Ye=a=>St(a,"tag")&&fe(a.tag),ge=a=>window.TouchEvent&&a instanceof TouchEvent,pe=a=>St(a,"component")&&be(a.component),Ge=a=>Ht(a)||Ut(a),be=a=>!It(a)&&(zt(a)||Ge(a)||pe(a)),ie=a=>Ut(a)&&["height","width","right","left","top","bottom"].every(e=>We(a[e])),St=(a,e)=>(Ut(a)||Ht(a))&&e in a,Qe=(a=>()=>a++)(0);function Qt(a){return ge(a)?a.targetTouches[0].clientX:a.clientX}function le(a){return ge(a)?a.targetTouches[0].clientY:a.clientY}var Ke=a=>{It(a.remove)?a.parentNode&&a.parentNode.removeChild(a):a.remove()},Vt=a=>pe(a)?Vt(a.component):Ye(a)?Rt({render(){return a}}):typeof a=="string"?a:Ue(Le(a)),Xe=a=>{if(typeof a=="string")return a;const e=St(a,"props")&&Ut(a.props)?a.props:{},d=St(a,"listeners")&&Ut(a.listeners)?a.listeners:{};return{component:Vt(a),props:e,listeners:d}},Je=()=>typeof window<"u",ae=class{constructor(){this.allHandlers={}}getHandlers(a){return this.allHandlers[a]||[]}on(a,e){const d=this.getHandlers(a);d.push(e),this.allHandlers[a]=d}off(a,e){const d=this.getHandlers(a);d.splice(d.indexOf(e)>>>0,1)}emit(a,e){this.getHandlers(a).forEach(s=>s(e))}},ts=a=>["on","off","emit"].every(e=>St(a,e)&&Ht(a[e])),yt;(function(a){a.SUCCESS="success",a.ERROR="error",a.WARNING="warning",a.INFO="info",a.DEFAULT="default"})(yt||(yt={}));var qt;(function(a){a.TOP_LEFT="top-left",a.TOP_CENTER="top-center",a.TOP_RIGHT="top-right",a.BOTTOM_LEFT="bottom-left",a.BOTTOM_CENTER="bottom-center",a.BOTTOM_RIGHT="bottom-right"})(qt||(qt={}));var wt;(function(a){a.ADD="add",a.DISMISS="dismiss",a.UPDATE="update",a.CLEAR="clear",a.UPDATE_DEFAULTS="update_defaults"})(wt||(wt={}));var xt="Vue-Toastification",Ct={type:{type:String,default:yt.DEFAULT},classNames:{type:[String,Array],default:()=>[]},trueBoolean:{type:Boolean,default:!0}},he={type:Ct.type,customIcon:{type:[String,Boolean,Object,Function],default:!0}},Ot={component:{type:[String,Object,Function,Boolean],default:"button"},classNames:Ct.classNames,showOnHover:{type:Boolean,default:!1},ariaLabel:{type:String,default:"close"}},Jt={timeout:{type:[Number,Boolean],default:5e3},hideProgressBar:{type:Boolean,default:!1},isRunning:{type:Boolean,default:!1}},_e={transition:{type:[Object,String],default:`${xt}__bounce`}},es={position:{type:String,default:qt.TOP_RIGHT},draggable:Ct.trueBoolean,draggablePercent:{type:Number,default:.6},pauseOnFocusLoss:Ct.trueBoolean,pauseOnHover:Ct.trueBoolean,closeOnClick:Ct.trueBoolean,timeout:Jt.timeout,hideProgressBar:Jt.hideProgressBar,toastClassName:Ct.classNames,bodyClassName:Ct.classNames,icon:he.customIcon,closeButton:Ot.component,closeButtonClassName:Ot.classNames,showCloseButtonOnHover:Ot.showOnHover,accessibility:{type:Object,default:()=>({toastRole:"alert",closeButtonLabel:"close"})},rtl:{type:Boolean,default:!1},eventBus:{type:Object,required:!1,default:()=>new ae}},ss={id:{type:[String,Number],required:!0,default:0},type:Ct.type,content:{type:[String,Object,Function],required:!0,default:""},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0}},as={container:{type:[Object,Function],default:()=>document.body},newestOnTop:Ct.trueBoolean,maxToasts:{type:Number,default:20},transition:_e.transition,toastDefaults:Object,filterBeforeCreate:{type:Function,default:a=>a},filterToasts:{type:Function,default:a=>a},containerClassName:Ct.classNames,onMounted:Function,shareAppContext:[Boolean,Object]},Dt={CORE_TOAST:es,TOAST:ss,CONTAINER:as,PROGRESS_BAR:Jt,ICON:he,TRANSITION:_e,CLOSE_BUTTON:Ot},ye=Rt({name:"VtProgressBar",props:Dt.PROGRESS_BAR,data(){return{hasClass:!0}},computed:{style(){return{animationDuration:`${this.timeout}ms`,animationPlayState:this.isRunning?"running":"paused",opacity:this.hideProgressBar?0:1}},cpClass(){return this.hasClass?`${xt}__progress-bar`:""}},watch:{timeout(){this.hasClass=!1,this.$nextTick(()=>this.hasClass=!0)}},mounted(){this.$el.addEventListener("animationend",this.animationEnded)},beforeUnmount(){this.$el.removeEventListener("animationend",this.animationEnded)},methods:{animationEnded(){this.$emit("close-toast")}}});function os(a,e){return n(),i("div",{style:st(a.style),class:h(a.cpClass)},null,6)}ye.render=os;var ns=ye,we=Rt({name:"VtCloseButton",props:Dt.CLOSE_BUTTON,computed:{buttonComponent(){return this.component!==!1?Vt(this.component):"button"},classes(){const a=[`${xt}__close-button`];return this.showOnHover&&a.push("show-on-hover"),a.concat(this.classNames)}}}),is=c(" × ");function ls(a,e){return n(),ft(ee(a.buttonComponent),te({"aria-label":a.ariaLabel,class:a.classes},a.$attrs),{default:N(()=>[is]),_:1},16,["aria-label","class"])}we.render=ls;var rs=we,ke={},ds={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",class:"svg-inline--fa fa-check-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},cs=t("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),us=[cs];function ms(a,e){return n(),i("svg",ds,us)}ke.render=ms;var vs=ke,Ce={},fs={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},gs=t("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},null,-1),ps=[gs];function bs(a,e){return n(),i("svg",fs,ps)}Ce.render=bs;var re=Ce,xe={},hs={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-circle",class:"svg-inline--fa fa-exclamation-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},_s=t("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),ys=[_s];function ws(a,e){return n(),i("svg",hs,ys)}xe.render=ws;var ks=xe,Se={},Cs={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-triangle",class:"svg-inline--fa fa-exclamation-triangle fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},xs=t("path",{fill:"currentColor",d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),Ss=[xs];function $s(a,e){return n(),i("svg",Cs,Ss)}Se.render=$s;var Ps=Se,$e=Rt({name:"VtIcon",props:Dt.ICON,computed:{customIconChildren(){return St(this.customIcon,"iconChildren")?this.trimValue(this.customIcon.iconChildren):""},customIconClass(){return zt(this.customIcon)?this.trimValue(this.customIcon):St(this.customIcon,"iconClass")?this.trimValue(this.customIcon.iconClass):""},customIconTag(){return St(this.customIcon,"iconTag")?this.trimValue(this.customIcon.iconTag,"i"):"i"},hasCustomIcon(){return this.customIconClass.length>0},component(){return this.hasCustomIcon?this.customIconTag:be(this.customIcon)?Vt(this.customIcon):this.iconTypeComponent},iconTypeComponent(){return{[yt.DEFAULT]:re,[yt.INFO]:re,[yt.SUCCESS]:vs,[yt.ERROR]:Ps,[yt.WARNING]:ks}[this.type]},iconClasses(){const a=[`${xt}__icon`];return this.hasCustomIcon?a.concat(this.customIconClass):a}},methods:{trimValue(a,e=""){return fe(a)?a.trim():e}}});function Ds(a,e){return n(),ft(ee(a.component),{class:h(a.iconClasses)},{default:N(()=>[c(r(a.customIconChildren),1)]),_:1},8,["class"])}$e.render=Ds;var Ts=$e,Pe=Rt({name:"VtToast",components:{ProgressBar:ns,CloseButton:rs,Icon:Ts},inheritAttrs:!1,props:Object.assign({},Dt.CORE_TOAST,Dt.TOAST),data(){return{isRunning:!0,disableTransitions:!1,beingDragged:!1,dragStart:0,dragPos:{x:0,y:0},dragRect:{}}},computed:{classes(){const a=[`${xt}__toast`,`${xt}__toast--${this.type}`,`${this.position}`].concat(this.toastClassName);return this.disableTransitions&&a.push("disable-transition"),this.rtl&&a.push(`${xt}__toast--rtl`),a},bodyClasses(){return[`${xt}__toast-${zt(this.content)?"body":"component-body"}`].concat(this.bodyClassName)},draggableStyle(){return this.dragStart===this.dragPos.x?{}:this.beingDragged?{transform:`translateX(${this.dragDelta}px)`,opacity:1-Math.abs(this.dragDelta/this.removalDistance)}:{transition:"transform 0.2s, opacity 0.2s",transform:"translateX(0)",opacity:1}},dragDelta(){return this.beingDragged?this.dragPos.x-this.dragStart:0},removalDistance(){return ie(this.dragRect)?(this.dragRect.right-this.dragRect.left)*this.draggablePercent:0}},mounted(){this.draggable&&this.draggableSetup(),this.pauseOnFocusLoss&&this.focusSetup()},beforeUnmount(){this.draggable&&this.draggableCleanup(),this.pauseOnFocusLoss&&this.focusCleanup()},methods:{hasProp:St,getVueComponentFromObj:Vt,closeToast(){this.eventBus.emit(wt.DISMISS,this.id)},clickHandler(){this.onClick&&this.onClick(this.closeToast),this.closeOnClick&&(!this.beingDragged||this.dragStart===this.dragPos.x)&&this.closeToast()},timeoutHandler(){this.closeToast()},hoverPause(){this.pauseOnHover&&(this.isRunning=!1)},hoverPlay(){this.pauseOnHover&&(this.isRunning=!0)},focusPause(){this.isRunning=!1},focusPlay(){this.isRunning=!0},focusSetup(){addEventListener("blur",this.focusPause),addEventListener("focus",this.focusPlay)},focusCleanup(){removeEventListener("blur",this.focusPause),removeEventListener("focus",this.focusPlay)},draggableSetup(){const a=this.$el;a.addEventListener("touchstart",this.onDragStart,{passive:!0}),a.addEventListener("mousedown",this.onDragStart),addEventListener("touchmove",this.onDragMove,{passive:!1}),addEventListener("mousemove",this.onDragMove),addEventListener("touchend",this.onDragEnd),addEventListener("mouseup",this.onDragEnd)},draggableCleanup(){const a=this.$el;a.removeEventListener("touchstart",this.onDragStart),a.removeEventListener("mousedown",this.onDragStart),removeEventListener("touchmove",this.onDragMove),removeEventListener("mousemove",this.onDragMove),removeEventListener("touchend",this.onDragEnd),removeEventListener("mouseup",this.onDragEnd)},onDragStart(a){this.beingDragged=!0,this.dragPos={x:Qt(a),y:le(a)},this.dragStart=Qt(a),this.dragRect=this.$el.getBoundingClientRect()},onDragMove(a){this.beingDragged&&(a.preventDefault(),this.isRunning&&(this.isRunning=!1),this.dragPos={x:Qt(a),y:le(a)})},onDragEnd(){this.beingDragged&&(Math.abs(this.dragDelta)>=this.removalDistance?(this.disableTransitions=!0,this.$nextTick(()=>this.closeToast())):setTimeout(()=>{this.beingDragged=!1,ie(this.dragRect)&&this.pauseOnHover&&this.dragRect.bottom>=this.dragPos.y&&this.dragPos.y>=this.dragRect.top&&this.dragRect.left<=this.dragPos.x&&this.dragPos.x<=this.dragRect.right?this.isRunning=!1:this.isRunning=!0}))}}}),Ms=["role"];function Is(a,e){const d=Q("Icon"),s=Q("CloseButton"),m=Q("ProgressBar");return n(),i("div",{class:h(a.classes),style:st(a.draggableStyle),onClick:e[0]||(e[0]=(...u)=>a.clickHandler&&a.clickHandler(...u)),onMouseenter:e[1]||(e[1]=(...u)=>a.hoverPause&&a.hoverPause(...u)),onMouseleave:e[2]||(e[2]=(...u)=>a.hoverPlay&&a.hoverPlay(...u))},[a.icon?(n(),ft(d,{key:0,"custom-icon":a.icon,type:a.type},null,8,["custom-icon","type"])):g("v-if",!0),t("div",{role:a.accessibility.toastRole||"alert",class:h(a.bodyClasses)},[typeof a.content=="string"?(n(),i(H,{key:0},[c(r(a.content),1)],2112)):(n(),ft(ee(a.getVueComponentFromObj(a.content)),te({key:1,"toast-id":a.id},a.hasProp(a.content,"props")?a.content.props:{},Ee(a.hasProp(a.content,"listeners")?a.content.listeners:{}),{onCloseToast:a.closeToast}),null,16,["toast-id","onCloseToast"]))],10,Ms),a.closeButton?(n(),ft(s,{key:1,component:a.closeButton,"class-names":a.closeButtonClassName,"show-on-hover":a.showCloseButtonOnHover,"aria-label":a.accessibility.closeButtonLabel,onClick:lt(a.closeToast,["stop"])},null,8,["component","class-names","show-on-hover","aria-label","onClick"])):g("v-if",!0),a.timeout?(n(),ft(m,{key:2,"is-running":a.isRunning,"hide-progress-bar":a.hideProgressBar,timeout:a.timeout,onCloseToast:a.timeoutHandler},null,8,["is-running","hide-progress-bar","timeout","onCloseToast"])):g("v-if",!0)],38)}Pe.render=Is;var As=Pe,De=Rt({name:"VtTransition",props:Dt.TRANSITION,emits:["leave"],methods:{hasProp:St,leave(a){a instanceof HTMLElement&&(a.style.left=a.offsetLeft+"px",a.style.top=a.offsetTop+"px",a.style.width=getComputedStyle(a).width,a.style.position="absolute")}}});function Rs(a,e){return n(),ft(Ne,{tag:"div","enter-active-class":a.transition.enter?a.transition.enter:`${a.transition}-enter-active`,"move-class":a.transition.move?a.transition.move:`${a.transition}-move`,"leave-active-class":a.transition.leave?a.transition.leave:`${a.transition}-leave-active`,onLeave:a.leave},{default:N(()=>[se(a.$slots,"default")]),_:3},8,["enter-active-class","move-class","leave-active-class","onLeave"])}De.render=Rs;var Es=De,Te=Rt({name:"VueToastification",devtools:{hide:!0},components:{Toast:As,VtTransition:Es},props:Object.assign({},Dt.CORE_TOAST,Dt.CONTAINER,Dt.TRANSITION),data(){return{count:0,positions:Object.values(qt),toasts:{},defaults:{}}},computed:{toastArray(){return Object.values(this.toasts)},filteredToasts(){return this.defaults.filterToasts(this.toastArray)}},beforeMount(){const a=this.eventBus;a.on(wt.ADD,this.addToast),a.on(wt.CLEAR,this.clearToasts),a.on(wt.DISMISS,this.dismissToast),a.on(wt.UPDATE,this.updateToast),a.on(wt.UPDATE_DEFAULTS,this.updateDefaults),this.defaults=this.$props},mounted(){this.setup(this.container)},methods:{async setup(a){Ht(a)&&(a=await a()),Ke(this.$el),a.appendChild(this.$el)},setToast(a){It(a.id)||(this.toasts[a.id]=a)},addToast(a){a.content=Xe(a.content);const e=Object.assign({},this.defaults,a.type&&this.defaults.toastDefaults&&this.defaults.toastDefaults[a.type],a),d=this.defaults.filterBeforeCreate(e,this.toastArray);d&&this.setToast(d)},dismissToast(a){const e=this.toasts[a];!It(e)&&!It(e.onClose)&&e.onClose(),delete this.toasts[a]},clearToasts(){Object.keys(this.toasts).forEach(a=>{this.dismissToast(a)})},getPositionToasts(a){const e=this.filteredToasts.filter(d=>d.position===a).slice(0,this.defaults.maxToasts);return this.defaults.newestOnTop?e.reverse():e},updateDefaults(a){It(a.container)||this.setup(a.container),this.defaults=Object.assign({},this.defaults,a)},updateToast({id:a,options:e,create:d}){this.toasts[a]?(e.timeout&&e.timeout===this.toasts[a].timeout&&e.timeout++,this.setToast(Object.assign({},this.toasts[a],e))):d&&this.addToast(Object.assign({},{id:a},e))},getClasses(a){return[`${xt}__container`,a].concat(this.defaults.containerClassName)}}});function Ns(a,e){const d=Q("Toast"),s=Q("VtTransition");return n(),i("div",null,[(n(!0),i(H,null,G(a.positions,m=>(n(),i("div",{key:m},[A(s,{transition:a.defaults.transition,class:h(a.getClasses(m))},{default:N(()=>[(n(!0),i(H,null,G(a.getPositionToasts(m),u=>(n(),ft(d,te({key:u.id},u),null,16))),128))]),_:2},1032,["transition","class"])]))),128))])}Te.render=Ns;var Us=Te,de=(a={},e=!0)=>{const d=a.eventBus=a.eventBus||new ae;e&&Fe(()=>{const u=ue(Us,ve({},a)),o=u.mount(document.createElement("div")),l=a.onMounted;if(It(l)||l(o,u),a.shareAppContext){const v=a.shareAppContext;v===!0?console.warn(`[${xt}] App to share context with was not provided.`):(u._context.components=v._context.components,u._context.directives=v._context.directives,u._context.mixins=v._context.mixins,u._context.provides=v._context.provides,u.config.globalProperties=v.config.globalProperties)}});const s=(u,o)=>{const l=Object.assign({},{id:Qe(),type:yt.DEFAULT},o,{content:u});return d.emit(wt.ADD,l),l.id};s.clear=()=>d.emit(wt.CLEAR,void 0),s.updateDefaults=u=>{d.emit(wt.UPDATE_DEFAULTS,u)},s.dismiss=u=>{d.emit(wt.DISMISS,u)};function m(u,{content:o,options:l},v=!1){const f=Object.assign({},l,{content:o});d.emit(wt.UPDATE,{id:u,options:f,create:v})}return s.update=m,s.success=(u,o)=>s(u,Object.assign({},o,{type:yt.SUCCESS})),s.info=(u,o)=>s(u,Object.assign({},o,{type:yt.INFO})),s.error=(u,o)=>s(u,Object.assign({},o,{type:yt.ERROR})),s.warning=(u,o)=>s(u,Object.assign({},o,{type:yt.WARNING})),s},Ls=()=>{const a=()=>console.warn(`[${xt}] This plugin does not support SSR!`);return new Proxy(a,{get(){return a}})};function Me(a){return Je()?ts(a)?de({eventBus:a},!1):de(a,!0):Ls()}var Ie=Symbol("VueToastification"),Ae=new ae,Vs=(a,e)=>{(e==null?void 0:e.shareAppContext)===!0&&(e.shareAppContext=a);const d=Me(ve({eventBus:Ae},e));a.provide(Ie,d)},mt=a=>{const e=Ve()?Be(Ie,void 0):void 0;return e||Me(Ae)},Bs=Vs;const J=(a,e)=>{const d=a.__vccOpts||a;for(const[s,m]of e)d[s]=m;return d},Fs={name:"AppHeader",emits:["toggleSidebar"],setup(){const a=bt(),e=mt(),d=pt(),s=ut(),m=w(""),u=w([]),o=w(!1),l=w([]),v=w(!1),f=j(()=>l.value.filter(C=>!C.isRead).length),_=async()=>{if(m.value.length<2){u.value=[],o.value=!1;return}o.value=!0},M=()=>{m.value.trim()&&(a.push({name:"Search",query:{q:m.value.trim()}}),o.value=!1)},R=C=>{o.value=!1,m.value="",C.type==="event"?a.push(`/events/${C.id}`):C.type==="reward"&&a.push(`/rewards/${C.id}`)},k=C=>({event:"fas fa-calendar-alt",reward:"fas fa-gift",user:"fas fa-user"})[C]||"fas fa-search",V=C=>({event:"Мероприятие",reward:"Награда",user:"Пользователь"})[C]||"Результат",I=async()=>{try{v.value=!0}catch(C){console.error("Ошибка загрузки уведомлений:",C)}finally{v.value=!1}},F=async C=>{C.isRead||(C.isRead=!0),C.actionUrl&&a.push(C.actionUrl)},$=async()=>{l.value.forEach(C=>C.isRead=!0),e.success("Все уведомления отмечены как прочитанные")},x=C=>({info:"fas fa-info-circle",success:"fas fa-check-circle",warning:"fas fa-exclamation-triangle",error:"fas fa-times-circle",event:"fas fa-calendar",points:"fas fa-coins",purchase:"fas fa-shopping-bag"})[C]||"fas fa-bell",y=C=>s.formatRelativeDate(new Date(C)),D=C=>s.formatNumber(C),L=C=>({user:"Сотрудник",moderator:"Модератор",admin:"Администратор"})[C]||"Пользователь",W=()=>{s.toggleTheme()},q=async()=>{try{await d.logout(),e.success("Вы успешно вышли из системы")}catch(C){console.error("Ошибка выхода:",C),e.error("Ошибка при выходе из системы")}},O=C=>{C.target.closest(".navbar-search")||(o.value=!1)};return dt(()=>{document.addEventListener("click",O),I()}),Lt(()=>{document.removeEventListener("click",O)}),{authStore:d,appStore:s,searchQuery:m,searchResults:u,showSearchResults:o,notifications:l,notificationsLoading:v,unreadNotificationsCount:f,onSearchInput:_,performSearch:M,selectSearchResult:R,getSearchResultIcon:k,getSearchResultType:V,loadNotifications:I,markAsRead:F,markAllAsRead:$,getNotificationIcon:x,formatRelativeTime:y,formatNumber:D,getRoleDisplayName:L,toggleTheme:W,logout:q}}},Os={class:"app-header navbar navbar-expand-lg navbar-dark bg-primary px-3 py-2"},qs={class:"container-fluid"},js={class:"d-flex align-items-center"},Hs={class:"navbar-search d-none d-lg-block flex-grow-1 mx-4"},zs={class:"position-relative",style:{"max-width":"400px"}},Zs={key:0,class:"search-dropdown position-absolute w-100 mt-1 bg-white rounded shadow-lg border",style:{"z-index":"1050","max-height":"300px","overflow-y":"auto"}},Ws=["onClick"],Ys={class:"d-flex align-items-center"},Gs={class:"fw-medium text-dark"},Qs={class:"text-muted"},Ks={class:"navbar-nav d-flex flex-row align-items-center"},Xs={class:"nav-item dropdown me-2"},Js={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",style:{"font-size":"0.6rem"}},ta={class:"dropdown-menu dropdown-menu-end notification-dropdown"},ea={class:"dropdown-header d-flex justify-content-between align-items-center"},sa={key:0,class:"text-center p-3"},aa={key:1,class:"text-center p-3 text-muted"},oa={key:2,class:"notification-list",style:{"max-height":"300px","overflow-y":"auto"}},na=["onClick"],ia={class:"d-flex"},la={class:"notification-icon me-2 mt-1"},ra={class:"flex-grow-1"},da={class:"notification-title fw-medium"},ca={class:"notification-message text-muted small"},ua={class:"notification-time text-muted small"},ma={key:3,class:"dropdown-divider"},va={class:"nav-item dropdown"},fa={id:"userDropdown",class:"btn btn-link text-white d-flex align-items-center p-2","data-bs-toggle":"dropdown","aria-expanded":"false"},ga={class:"user-avatar me-2"},pa={key:0,class:"avatar-image"},ba=["src","alt"],ha={key:1,class:"avatar-initials"},_a={class:"d-none d-md-block text-start me-2"},ya={class:"user-name"},wa={class:"user-role small opacity-75"},ka={class:"dropdown-menu dropdown-menu-end user-dropdown"},Ca={class:"dropdown-header"},xa={class:"d-flex align-items-center"},Sa={class:"user-avatar me-3"},$a={key:0,class:"avatar-image"},Pa=["src","alt"],Da={key:1,class:"avatar-initials"},Ta={class:"fw-medium"},Ma={class:"text-muted small"},Ia={class:"text-muted small"},Aa={class:"dropdown-item-text"},Ra={class:"d-flex justify-content-between align-items-center"},Ea={class:"fw-bold text-primary"};function Na(a,e,d,s,m,u){var l,v,f,_,M,R;const o=Q("router-link");return n(),i("header",Os,[t("div",qs,[t("div",js,[t("button",{class:"btn btn-link text-white p-2 me-3 d-lg-none",onClick:e[0]||(e[0]=k=>a.$emit("toggleSidebar")),type:"button","aria-label":"Открыть меню"},e[9]||(e[9]=[t("i",{class:"fas fa-bars"},null,-1)])),A(o,{to:"/dashboard",class:"navbar-brand d-flex align-items-center text-decoration-none"},{default:N(()=>e[10]||(e[10]=[t("i",{class:"fas fa-building me-2"},null,-1),t("span",{class:"fw-bold d-none d-sm-inline"},"Учёт активности",-1)])),_:1,__:[10]})]),t("div",Hs,[t("div",zs,[E(t("input",{"onUpdate:modelValue":e[1]||(e[1]=k=>s.searchQuery=k),type:"search",class:"form-control bg-white bg-opacity-10 border-0 text-white placeholder-white-50",placeholder:"Поиск мероприятий, наград...",onKeyup:e[2]||(e[2]=me((...k)=>s.performSearch&&s.performSearch(...k),["enter"])),onInput:e[3]||(e[3]=(...k)=>s.onSearchInput&&s.onSearchInput(...k))},null,544),[[et,s.searchQuery]]),t("button",{class:"btn position-absolute end-0 top-0 text-white-50",style:{border:"none",background:"none"},onClick:e[4]||(e[4]=(...k)=>s.performSearch&&s.performSearch(...k)),type:"button"},e[11]||(e[11]=[t("i",{class:"fas fa-search"},null,-1)])),s.searchResults.length>0&&s.showSearchResults?(n(),i("div",Zs,[(n(!0),i(H,null,G(s.searchResults,k=>(n(),i("div",{key:`${k.type}-${k.id}`,class:"search-result-item p-3 border-bottom cursor-pointer",onClick:V=>s.selectSearchResult(k)},[t("div",Ys,[t("i",{class:h([s.getSearchResultIcon(k.type),"me-2","text-primary"])},null,2),t("div",null,[t("div",Gs,r(k.title),1),t("small",Qs,r(s.getSearchResultType(k.type)),1)])])],8,Ws))),128))])):g("",!0)])]),t("div",Ks,[t("div",Xs,[t("button",{id:"notificationsDropdown",class:"btn btn-link text-white position-relative p-2","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:e[5]||(e[5]=(...k)=>s.loadNotifications&&s.loadNotifications(...k))},[e[12]||(e[12]=t("i",{class:"fas fa-bell"},null,-1)),s.unreadNotificationsCount>0?(n(),i("span",Js,r(s.unreadNotificationsCount>9?"9+":s.unreadNotificationsCount),1)):g("",!0)]),t("div",ta,[t("div",ea,[e[13]||(e[13]=t("span",{class:"fw-medium"},"Уведомления",-1)),s.notifications.length>0?(n(),i("button",{key:0,class:"btn btn-sm btn-link text-muted p-0",onClick:e[6]||(e[6]=(...k)=>s.markAllAsRead&&s.markAllAsRead(...k))}," Прочитать все ")):g("",!0)]),e[16]||(e[16]=t("div",{class:"dropdown-divider"},null,-1)),s.notificationsLoading?(n(),i("div",sa,e[14]||(e[14]=[t("div",{class:"spinner-border spinner-border-sm text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):s.notifications.length===0?(n(),i("div",aa," Нет уведомлений ")):(n(),i("div",oa,[(n(!0),i(H,null,G(s.notifications.slice(0,10),k=>(n(),i("div",{key:k.id,class:h(["dropdown-item notification-item",{unread:!k.isRead}]),onClick:V=>s.markAsRead(k)},[t("div",ia,[t("div",la,[t("i",{class:h([s.getNotificationIcon(k.type),"text-primary"])},null,2)]),t("div",ra,[t("div",da,r(k.title),1),t("div",ca,r(k.message),1),t("div",ua,r(s.formatRelativeTime(k.createdAt)),1)])])],10,na))),128))])),s.notifications.length>10?(n(),i("div",ma)):g("",!0),s.notifications.length>10?(n(),ft(o,{key:4,to:"/notifications",class:"dropdown-item text-center text-primary"},{default:N(()=>e[15]||(e[15]=[c(" Показать все уведомления ",-1)])),_:1,__:[15]})):g("",!0)])]),t("div",va,[t("button",fa,[t("div",ga,[(l=s.authStore.user)!=null&&l.avatar?(n(),i("div",pa,[t("img",{src:s.authStore.user.avatar,alt:s.authStore.fullName},null,8,ba)])):(n(),i("div",ha,r(s.authStore.initials),1))]),t("div",_a,[t("div",ya,r(s.authStore.fullName),1),t("div",wa,r(s.getRoleDisplayName((v=s.authStore.user)==null?void 0:v.role)),1)]),e[17]||(e[17]=t("i",{class:"fas fa-chevron-down small"},null,-1))]),t("div",ka,[t("div",Ca,[t("div",xa,[t("div",Sa,[(f=s.authStore.user)!=null&&f.avatar?(n(),i("div",$a,[t("img",{src:s.authStore.user.avatar,alt:s.authStore.fullName},null,8,Pa)])):(n(),i("div",Da,r(s.authStore.initials),1))]),t("div",null,[t("div",Ta,r(s.authStore.fullName),1),t("div",Ma,r((_=s.authStore.user)==null?void 0:_.email),1),t("div",Ia,r(s.getRoleDisplayName((M=s.authStore.user)==null?void 0:M.role)),1)])])]),e[23]||(e[23]=t("div",{class:"dropdown-divider"},null,-1)),t("div",Aa,[t("div",Ra,[e[18]||(e[18]=t("span",{class:"text-muted"},"Баллы:",-1)),t("span",Ea,r(s.formatNumber(((R=s.authStore.user)==null?void 0:R.points)||0)),1)])]),e[24]||(e[24]=t("div",{class:"dropdown-divider"},null,-1)),A(o,{to:"/profile",class:"dropdown-item"},{default:N(()=>e[19]||(e[19]=[t("i",{class:"fas fa-user me-2"},null,-1),c(" Мой профиль ",-1)])),_:1,__:[19]}),A(o,{to:"/profile/purchases",class:"dropdown-item"},{default:N(()=>e[20]||(e[20]=[t("i",{class:"fas fa-shopping-bag me-2"},null,-1),c(" Мои покупки ",-1)])),_:1,__:[20]}),A(o,{to:"/profile/events",class:"dropdown-item"},{default:N(()=>e[21]||(e[21]=[t("i",{class:"fas fa-calendar me-2"},null,-1),c(" Мои мероприятия ",-1)])),_:1,__:[21]}),e[25]||(e[25]=t("div",{class:"dropdown-divider"},null,-1)),t("button",{class:"dropdown-item",onClick:e[7]||(e[7]=(...k)=>s.toggleTheme&&s.toggleTheme(...k))},[t("i",{class:h([s.appStore.theme==="dark"?"fas fa-sun":"fas fa-moon","me-2"])},null,2),c(" "+r(s.appStore.theme==="dark"?"Светлая тема":"Темная тема"),1)]),e[26]||(e[26]=t("div",{class:"dropdown-divider"},null,-1)),t("button",{class:"dropdown-item text-danger",onClick:e[8]||(e[8]=(...k)=>s.logout&&s.logout(...k))},e[22]||(e[22]=[t("i",{class:"fas fa-sign-out-alt me-2"},null,-1),c(" Выйти ",-1)]))])])])])])}const Ua=J(Fs,[["render",Na],["__scopeId","data-v-0beb3828"]]),La={name:"AppSidebar",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(a,{emit:e}){const d=bt(),s=mt(),m=pt(),u=ut(),o=w(0),l=w(0),v=w(0),f=w(0),_=x=>{if(!x)return"";const y=x.trim().split(" ");return y.length>=2?`${y[0]} ${y[1][0]}.`:x},M=x=>({user:"Сотрудник",moderator:"Модератор",admin:"Администратор"})[x]||"Пользователь",R=x=>u.formatNumber(x),k=()=>{e("close"),d.push("/events/create")},V=()=>{e("close"),d.push("/rewards/create")},I=()=>{u.toggleTheme()},F=async()=>{try{await m.logout(),s.success("Вы успешно вышли из системы")}catch{s.error("Ошибка при выходе из системы")}},$=async()=>{};return dt(()=>{$()}),{authStore:m,appStore:u,upcomingEventsCount:o,myRegistrationsCount:l,pendingRegistrationsCount:v,pendingPurchasesCount:f,getShortName:_,getRoleDisplayName:M,formatNumber:R,createEvent:k,createReward:V,toggleTheme:I,logout:F}}},Va={class:"sidebar-content"},Ba={class:"sidebar-header"},Fa={class:"sidebar-user"},Oa={class:"user-info d-flex align-items-center"},qa={class:"user-avatar"},ja={key:0,class:"avatar-image"},Ha=["src","alt"],za={key:1,class:"avatar-initials"},Za={class:"user-details"},Wa={class:"user-name"},Ya={class:"user-role"},Ga={class:"user-points"},Qa={class:"sidebar-nav"},Ka={class:"nav-section"},Xa={key:0,class:"nav-badge"},Ja={class:"nav-section"},to={key:0,class:"nav-badge"},eo={key:0,class:"nav-section"},so={key:0,class:"nav-badge bg-warning"},ao={key:0,class:"nav-badge bg-warning"},oo={class:"nav-section"},no={class:"sidebar-footer"},io={class:"sidebar-actions"},lo=["title"];function ro(a,e,d,s,m,u){var l,v,f;const o=Q("router-link");return n(),i("aside",{class:h(["app-sidebar",{"sidebar-open":d.isOpen}])},[t("div",Va,[t("div",Ba,[A(o,{to:"/dashboard",class:"sidebar-brand"},{default:N(()=>e[5]||(e[5]=[t("div",{class:"brand-icon"},[t("i",{class:"fas fa-building"})],-1),t("div",{class:"brand-text"},[t("div",{class:"brand-title"},"Активность"),t("div",{class:"brand-subtitle"},"Предприятия")],-1)])),_:1,__:[5]}),t("button",{class:"sidebar-close d-lg-none",onClick:e[0]||(e[0]=_=>a.$emit("close"))},e[6]||(e[6]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Fa,[t("div",Oa,[t("div",qa,[(l=s.authStore.user)!=null&&l.avatar?(n(),i("div",ja,[t("img",{src:s.authStore.user.avatar,alt:s.authStore.fullName},null,8,Ha)])):(n(),i("div",za,r(s.authStore.initials),1))]),t("div",Za,[t("div",Wa,r(s.getShortName(s.authStore.fullName)),1),t("div",Ya,r(s.getRoleDisplayName((v=s.authStore.user)==null?void 0:v.role)),1),t("div",Ga,[e[7]||(e[7]=t("i",{class:"fas fa-coins text-warning"},null,-1)),c(" "+r(s.formatNumber(((f=s.authStore.user)==null?void 0:f.points)||0)),1)])])])]),t("nav",Qa,[t("div",Ka,[e[13]||(e[13]=t("div",{class:"nav-section-title"},"Основное",-1)),A(o,{to:"/dashboard",class:h(["nav-item",{active:a.$route.name==="Dashboard"}])},{default:N(()=>e[8]||(e[8]=[t("i",{class:"nav-icon fas fa-home"},null,-1),t("span",{class:"nav-text"},"Главная",-1)])),_:1,__:[8]},8,["class"]),A(o,{to:"/events",class:h(["nav-item",{active:a.$route.path.startsWith("/events")}])},{default:N(()=>[e[9]||(e[9]=t("i",{class:"nav-icon fas fa-calendar-alt"},null,-1)),e[10]||(e[10]=t("span",{class:"nav-text"},"Мероприятия",-1)),s.upcomingEventsCount>0?(n(),i("span",Xa,r(s.upcomingEventsCount),1)):g("",!0)]),_:1,__:[9,10]},8,["class"]),A(o,{to:"/rewards",class:h(["nav-item",{active:a.$route.path.startsWith("/rewards")}])},{default:N(()=>e[11]||(e[11]=[t("i",{class:"nav-icon fas fa-gift"},null,-1),t("span",{class:"nav-text"},"Награды",-1)])),_:1,__:[11]},8,["class"]),A(o,{to:"/leaderboard",class:h(["nav-item",{active:a.$route.name==="Leaderboard"}])},{default:N(()=>e[12]||(e[12]=[t("i",{class:"nav-icon fas fa-trophy"},null,-1),t("span",{class:"nav-text"},"Рейтинг",-1)])),_:1,__:[12]},8,["class"])]),t("div",Ja,[e[19]||(e[19]=t("div",{class:"nav-section-title"},"Личное",-1)),A(o,{to:"/profile",class:h(["nav-item",{active:a.$route.path.startsWith("/profile")}])},{default:N(()=>e[14]||(e[14]=[t("i",{class:"nav-icon fas fa-user"},null,-1),t("span",{class:"nav-text"},"Мой профиль",-1)])),_:1,__:[14]},8,["class"]),A(o,{to:"/profile/events",class:h(["nav-item",{active:a.$route.path==="/profile/events"}])},{default:N(()=>[e[15]||(e[15]=t("i",{class:"nav-icon fas fa-calendar-check"},null,-1)),e[16]||(e[16]=t("span",{class:"nav-text"},"Мои мероприятия",-1)),s.myRegistrationsCount>0?(n(),i("span",to,r(s.myRegistrationsCount),1)):g("",!0)]),_:1,__:[15,16]},8,["class"]),A(o,{to:"/profile/purchases",class:h(["nav-item",{active:a.$route.path==="/profile/purchases"}])},{default:N(()=>e[17]||(e[17]=[t("i",{class:"nav-icon fas fa-shopping-bag"},null,-1),t("span",{class:"nav-text"},"Мои покупки",-1)])),_:1,__:[17]},8,["class"]),A(o,{to:"/profile/points",class:h(["nav-item",{active:a.$route.path==="/profile/points"}])},{default:N(()=>e[18]||(e[18]=[t("i",{class:"nav-icon fas fa-coins"},null,-1),t("span",{class:"nav-text"},"История баллов",-1)])),_:1,__:[18]},8,["class"])]),s.authStore.isModerator?(n(),i("div",eo,[e[29]||(e[29]=t("div",{class:"nav-section-title"},"Управление",-1)),A(o,{to:"/admin",class:h(["nav-item",{active:a.$route.name==="AdminDashboard"}])},{default:N(()=>e[20]||(e[20]=[t("i",{class:"nav-icon fas fa-cogs"},null,-1),t("span",{class:"nav-text"},"Панель управления",-1)])),_:1,__:[20]},8,["class"]),A(o,{to:"/admin/events",class:h(["nav-item",{active:a.$route.name==="EventsManagement"}])},{default:N(()=>e[21]||(e[21]=[t("i",{class:"nav-icon fas fa-calendar-plus"},null,-1),t("span",{class:"nav-text"},"Мероприятия",-1)])),_:1,__:[21]},8,["class"]),A(o,{to:"/admin/rewards",class:h(["nav-item",{active:a.$route.name==="RewardsManagement"}])},{default:N(()=>e[22]||(e[22]=[t("i",{class:"nav-icon fas fa-gift"},null,-1),t("span",{class:"nav-text"},"Награды",-1)])),_:1,__:[22]},8,["class"]),A(o,{to:"/admin/registrations",class:h(["nav-item",{active:a.$route.name==="RegistrationsManagement"}])},{default:N(()=>[e[23]||(e[23]=t("i",{class:"nav-icon fas fa-user-check"},null,-1)),e[24]||(e[24]=t("span",{class:"nav-text"},"Регистрации",-1)),s.pendingRegistrationsCount>0?(n(),i("span",so,r(s.pendingRegistrationsCount),1)):g("",!0)]),_:1,__:[23,24]},8,["class"]),A(o,{to:"/admin/purchases",class:h(["nav-item",{active:a.$route.name==="PurchasesManagement"}])},{default:N(()=>[e[25]||(e[25]=t("i",{class:"nav-icon fas fa-shopping-cart"},null,-1)),e[26]||(e[26]=t("span",{class:"nav-text"},"Покупки",-1)),s.pendingPurchasesCount>0?(n(),i("span",ao,r(s.pendingPurchasesCount),1)):g("",!0)]),_:1,__:[25,26]},8,["class"]),s.authStore.isAdmin?(n(),ft(o,{key:0,to:"/admin/users",class:h(["nav-item",{active:a.$route.name==="UsersManagement"}])},{default:N(()=>e[27]||(e[27]=[t("i",{class:"nav-icon fas fa-users"},null,-1),t("span",{class:"nav-text"},"Пользователи",-1)])),_:1,__:[27]},8,["class"])):g("",!0),s.authStore.isAdmin?(n(),ft(o,{key:1,to:"/admin/statistics",class:h(["nav-item",{active:a.$route.name==="StatisticsPage"}])},{default:N(()=>e[28]||(e[28]=[t("i",{class:"nav-icon fas fa-chart-bar"},null,-1),t("span",{class:"nav-text"},"Статистика",-1)])),_:1,__:[28]},8,["class"])):g("",!0)])):g("",!0),t("div",oo,[e[32]||(e[32]=t("div",{class:"nav-section-title"},"Действия",-1)),s.authStore.isModerator?(n(),i("button",{key:0,class:"nav-item nav-button",onClick:e[1]||(e[1]=(..._)=>s.createEvent&&s.createEvent(..._))},e[30]||(e[30]=[t("i",{class:"nav-icon fas fa-plus"},null,-1),t("span",{class:"nav-text"},"Создать мероприятие",-1)]))):g("",!0),s.authStore.isModerator?(n(),i("button",{key:1,class:"nav-item nav-button",onClick:e[2]||(e[2]=(..._)=>s.createReward&&s.createReward(..._))},e[31]||(e[31]=[t("i",{class:"nav-icon fas fa-plus"},null,-1),t("span",{class:"nav-text"},"Создать награду",-1)]))):g("",!0)])]),t("div",no,[e[34]||(e[34]=t("div",{class:"sidebar-version"},[t("small",{class:"text-muted"},"Версия 1.0.0")],-1)),t("div",io,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[3]||(e[3]=(..._)=>s.toggleTheme&&s.toggleTheme(..._)),title:s.appStore.theme==="dark"?"Светлая тема":"Темная тема"},[t("i",{class:h(s.appStore.theme==="dark"?"fas fa-sun":"fas fa-moon")},null,2)],8,lo),t("button",{class:"btn btn-sm btn-outline-danger",onClick:e[4]||(e[4]=(..._)=>s.logout&&s.logout(..._)),title:"Выйти"},e[33]||(e[33]=[t("i",{class:"fas fa-sign-out-alt"},null,-1)]))])])])],2)}const co=J(La,[["render",ro],["__scopeId","data-v-501a64f1"]]),uo={name:"AppBreadcrumbs",props:{items:{type:Array,default:()=>[]}},setup(){const a=jt();return{isCurrentRoute:d=>a.path===d}}},mo={"aria-label":"breadcrumb",class:"breadcrumb-container"},vo={class:"container-fluid"},fo={class:"breadcrumb mb-0 py-3"},go={class:"breadcrumb-item"},po={key:1,class:"breadcrumb-current"},bo={key:0,class:"breadcrumb-actions"};function ho(a,e,d,s,m,u){const o=Q("router-link");return n(),i("nav",mo,[t("div",vo,[t("ol",fo,[t("li",go,[A(o,{to:"/dashboard",class:h(["breadcrumb-link",{active:s.isCurrentRoute("/dashboard")}])},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-home me-1"},null,-1),t("span",null,"Главная",-1)])),_:1,__:[0]},8,["class"])]),(n(!0),i(H,null,G(d.items,(l,v)=>(n(),i("li",{key:v,class:h(["breadcrumb-item",{active:v===d.items.length-1}])},[l.to&&v!==d.items.length-1?(n(),ft(o,{key:0,to:l.to,class:"breadcrumb-link"},{default:N(()=>[l.icon?(n(),i("i",{key:0,class:h([l.icon,"me-1"])},null,2)):g("",!0),c(" "+r(l.text),1)]),_:2},1032,["to"])):(n(),i("span",po,[l.icon?(n(),i("i",{key:0,class:h([l.icon,"me-1"])},null,2)):g("",!0),c(" "+r(l.text),1)]))],2))),128))]),a.$slots.actions?(n(),i("div",bo,[se(a.$slots,"actions",{},void 0,!0)])):g("",!0)])])}const _o=J(uo,[["render",ho],["__scopeId","data-v-59afc73e"]]),yo={name:"AppFooter",setup(){const a=mt(),e=pt(),d=w({onlineUsers:0,totalEvents:0,totalUsers:0}),s=w({type:"",message:"",email:""}),m=w(!1);let u=null;const o=j(()=>new Date().getFullYear()),l=async()=>{try{d.value={onlineUsers:Math.floor(Math.random()*50)+10,totalEvents:Math.floor(Math.random()*100)+50,totalUsers:Math.floor(Math.random()*500)+200}}catch(R){console.error("Ошибка загрузки статистики футера:",R)}},v=()=>{Gt.getOrCreateInstance(document.getElementById("helpModal")).show()},f=()=>{var k;s.value.email=((k=e.user)==null?void 0:k.email)||"",Gt.getOrCreateInstance(document.getElementById("feedbackModal")).show()},_=async()=>{try{m.value=!0,await new Promise(V=>setTimeout(V,1e3)),a.success("Ваше сообщение отправлено! Мы свяжемся с вами в ближайшее время.");const R=document.getElementById("feedbackModal");Gt.getOrCreateInstance(R).hide(),s.value={type:"",message:"",email:""}}catch(R){console.error("Ошибка отправки обратной связи:",R),a.error("Ошибка отправки сообщения. Попробуйте позже.")}finally{m.value=!1}},M=()=>{u&&clearInterval(u),u=setInterval(l,6e4)};return dt(()=>{l(),M()}),Lt(()=>{u&&clearInterval(u)}),{authStore:e,stats:d,feedbackForm:s,feedbackLoading:m,currentYear:o,showHelp:v,showFeedback:f,submitFeedback:_}}},wo={class:"app-footer bg-white border-top"},ko={class:"container-fluid"},Co={class:"row align-items-center py-3"},xo={class:"col-md-6"},So={class:"footer-info d-flex align-items-center"},$o={class:"footer-text"},Po={class:"footer-subtitle text-muted"},Do={class:"col-md-6"},To={class:"footer-actions d-flex align-items-center justify-content-md-end"},Mo={class:"footer-stats d-none d-lg-flex me-4"},Io={key:0,class:"stat-item me-3"},Ao={class:"small"},Ro={key:1,class:"stat-item me-3"},Eo={class:"small"},No={key:2,class:"stat-item"},Uo={class:"small"},Lo={class:"footer-links d-flex align-items-center"},Vo={class:"row d-md-none"},Bo={class:"col-12"},Fo={class:"footer-mobile-stats text-center py-2 border-top"},Oo={class:"d-flex justify-content-center gap-3"},qo={key:0,class:"stat-item"},jo={class:"small ms-1"},Ho={key:1,class:"stat-item"},zo={class:"small ms-1"},Zo={key:2,class:"stat-item"},Wo={class:"small ms-1"},Yo={id:"feedbackModal",class:"modal fade",tabindex:"-1","aria-labelledby":"feedbackModalLabel","aria-hidden":"true"},Go={class:"modal-dialog"},Qo={class:"modal-content"},Ko={class:"modal-body"},Xo={class:"mb-3"},Jo={class:"mb-3"},tn={class:"mb-3"},en=["placeholder"],sn={class:"modal-footer"},an=["disabled"],on={key:0,class:"spinner-border spinner-border-sm me-1"},nn={key:1,class:"fas fa-paper-plane me-1"};function ln(a,e,d,s,m,u){var o;return n(),i("footer",wo,[t("div",ko,[t("div",Co,[t("div",xo,[t("div",So,[e[7]||(e[7]=t("div",{class:"footer-logo me-3"},[t("i",{class:"fas fa-building text-primary"})],-1)),t("div",$o,[e[6]||(e[6]=t("div",{class:"footer-title"}," Система учёта активности предприятия ",-1)),t("div",Po," Версия 1.0.0 | © "+r(s.currentYear)+" Все права защищены ",1)])])]),t("div",Do,[t("div",To,[t("div",Mo,[s.stats.onlineUsers?(n(),i("div",Io,[e[8]||(e[8]=t("i",{class:"fas fa-users text-success me-1"},null,-1)),t("span",Ao,r(s.stats.onlineUsers)+" онлайн",1)])):g("",!0),s.stats.totalEvents?(n(),i("div",Ro,[e[9]||(e[9]=t("i",{class:"fas fa-calendar text-primary me-1"},null,-1)),t("span",Eo,r(s.stats.totalEvents)+" мероприятий",1)])):g("",!0),s.stats.totalUsers?(n(),i("div",No,[e[10]||(e[10]=t("i",{class:"fas fa-user-friends text-info me-1"},null,-1)),t("span",Uo,r(s.stats.totalUsers)+" пользователей",1)])):g("",!0)]),t("div",Lo,[t("a",{href:"#",class:"footer-link me-3",onClick:e[0]||(e[0]=lt((...l)=>s.showHelp&&s.showHelp(...l),["prevent"])),title:"Справка"},e[11]||(e[11]=[t("i",{class:"fas fa-question-circle"},null,-1),t("span",{class:"d-none d-sm-inline ms-1"},"Справка",-1)])),e[13]||(e[13]=t("a",{href:"mailto:support@company.com",class:"footer-link me-3",title:"Поддержка"},[t("i",{class:"fas fa-headset"}),t("span",{class:"d-none d-sm-inline ms-1"},"Поддержка")],-1)),t("button",{class:"footer-link btn btn-link p-0",onClick:e[1]||(e[1]=(...l)=>s.showFeedback&&s.showFeedback(...l)),title:"Обратная связь"},e[12]||(e[12]=[t("i",{class:"fas fa-comment-dots"},null,-1),t("span",{class:"d-none d-sm-inline ms-1"},"Отзыв",-1)]))])])])]),t("div",Vo,[t("div",Bo,[t("div",Fo,[t("div",Oo,[s.stats.onlineUsers?(n(),i("div",qo,[e[14]||(e[14]=t("i",{class:"fas fa-users text-success"},null,-1)),t("span",jo,r(s.stats.onlineUsers),1)])):g("",!0),s.stats.totalEvents?(n(),i("div",Ho,[e[15]||(e[15]=t("i",{class:"fas fa-calendar text-primary"},null,-1)),t("span",zo,r(s.stats.totalEvents),1)])):g("",!0),s.stats.totalUsers?(n(),i("div",Zo,[e[16]||(e[16]=t("i",{class:"fas fa-user-friends text-info"},null,-1)),t("span",Wo,r(s.stats.totalUsers),1)])):g("",!0)])])])])]),e[24]||(e[24]=rt('<div id="helpModal" class="modal fade" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true" data-v-12e43afc><div class="modal-dialog modal-lg" data-v-12e43afc><div class="modal-content" data-v-12e43afc><div class="modal-header" data-v-12e43afc><h5 id="helpModalLabel" class="modal-title" data-v-12e43afc><i class="fas fa-question-circle me-2" data-v-12e43afc></i> Справка по системе </h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть" data-v-12e43afc></button></div><div class="modal-body" data-v-12e43afc><div class="help-content" data-v-12e43afc><div class="help-section mb-4" data-v-12e43afc><h6 data-v-12e43afc><i class="fas fa-calendar-alt me-2 text-primary" data-v-12e43afc></i>Мероприятия</h6><p class="small text-muted mb-2" data-v-12e43afc> Участвуйте в корпоративных мероприятиях и зарабатывайте баллы за активность. </p><ul class="small" data-v-12e43afc><li data-v-12e43afc>Регистрируйтесь на интересные события</li><li data-v-12e43afc>Посещайте мероприятия и получайте баллы</li><li data-v-12e43afc>Оставляйте отзывы и оценки</li></ul></div><div class="help-section mb-4" data-v-12e43afc><h6 data-v-12e43afc><i class="fas fa-gift me-2 text-success" data-v-12e43afc></i>Награды</h6><p class="small text-muted mb-2" data-v-12e43afc> Обменивайте накопленные баллы на ценные призы и услуги. </p><ul class="small" data-v-12e43afc><li data-v-12e43afc>Выбирайте из каталога наград</li><li data-v-12e43afc>Оплачивайте баллами</li><li data-v-12e43afc>Получайте призы и услуги</li></ul></div><div class="help-section mb-4" data-v-12e43afc><h6 data-v-12e43afc><i class="fas fa-trophy me-2 text-warning" data-v-12e43afc></i>Рейтинг</h6><p class="small text-muted mb-2" data-v-12e43afc> Соревнуйтесь с коллегами в активности и занимайте верхние позиции. </p><ul class="small" data-v-12e43afc><li data-v-12e43afc>Отслеживайте свою позицию</li><li data-v-12e43afc>Сравнивайте результаты с коллегами</li><li data-v-12e43afc>Стремитесь к лидерству</li></ul></div><div class="help-section" data-v-12e43afc><h6 data-v-12e43afc><i class="fas fa-user me-2 text-info" data-v-12e43afc></i>Профиль</h6><p class="small text-muted mb-2" data-v-12e43afc> Управляйте своим профилем и отслеживайте личную статистику. </p><ul class="small" data-v-12e43afc><li data-v-12e43afc>Просматривайте историю активности</li><li data-v-12e43afc>Отслеживайте баланс баллов</li><li data-v-12e43afc>Обновляйте личную информацию</li></ul></div></div></div><div class="modal-footer" data-v-12e43afc><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-v-12e43afc> Закрыть </button><a href="mailto:support@company.com" class="btn btn-primary" data-v-12e43afc><i class="fas fa-envelope me-1" data-v-12e43afc></i> Связаться с поддержкой </a></div></div></div></div>',1)),t("div",Yo,[t("div",Go,[t("div",Qo,[e[23]||(e[23]=t("div",{class:"modal-header"},[t("h5",{id:"feedbackModalLabel",class:"modal-title"},[t("i",{class:"fas fa-comment-dots me-2"}),c(" Обратная связь ")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("form",{onSubmit:e[5]||(e[5]=lt((...l)=>s.submitFeedback&&s.submitFeedback(...l),["prevent"]))},[t("div",Ko,[t("div",Xo,[e[18]||(e[18]=t("label",{for:"feedbackType",class:"form-label"},"Тип обращения",-1)),E(t("select",{id:"feedbackType","onUpdate:modelValue":e[2]||(e[2]=l=>s.feedbackForm.type=l),class:"form-select",required:""},e[17]||(e[17]=[rt('<option value="" data-v-12e43afc>Выберите тип</option><option value="bug" data-v-12e43afc>Сообщить об ошибке</option><option value="feature" data-v-12e43afc>Предложить улучшение</option><option value="question" data-v-12e43afc>Задать вопрос</option><option value="other" data-v-12e43afc>Другое</option>',5)]),512),[[ot,s.feedbackForm.type]])]),t("div",Jo,[e[19]||(e[19]=t("label",{for:"feedbackMessage",class:"form-label"},"Сообщение",-1)),E(t("textarea",{id:"feedbackMessage","onUpdate:modelValue":e[3]||(e[3]=l=>s.feedbackForm.message=l),class:"form-control",rows:"4",placeholder:"Опишите вашу проблему или предложение...",required:""},null,512),[[et,s.feedbackForm.message]])]),t("div",tn,[e[20]||(e[20]=t("label",{for:"feedbackEmail",class:"form-label"},"Email для ответа (необязательно)",-1)),E(t("input",{id:"feedbackEmail","onUpdate:modelValue":e[4]||(e[4]=l=>s.feedbackForm.email=l),type:"email",class:"form-control",placeholder:((o=s.authStore.user)==null?void 0:o.email)||"ваш@email.com"},null,8,en),[[et,s.feedbackForm.email]])])]),t("div",sn,[e[22]||(e[22]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Отмена ",-1)),t("button",{type:"submit",class:"btn btn-primary",disabled:s.feedbackLoading},[s.feedbackLoading?(n(),i("span",on)):(n(),i("i",nn)),e[21]||(e[21]=c(" Отправить ",-1))],8,an)])],32)])])])])}const Re=J(yo,[["render",ln],["__scopeId","data-v-12e43afc"]]),rn={name:"DefaultLayout",components:{AppHeader:Ua,AppSidebar:co,AppBreadcrumbs:_o,AppFooter:Re},setup(){const a=ut(),e=w(window.innerWidth<992),d=()=>{e.value=window.innerWidth<992,window.innerWidth>=992&&a.setSidebarOpen(!1)};return dt(()=>{window.addEventListener("resize",d),d()}),Lt(()=>{window.removeEventListener("resize",d)}),{appStore:a,isMobile:e}}},dn={class:"app-layout d-flex"},cn={class:"main-content flex-grow-1 d-flex flex-column"},un={class:"page-content flex-grow-1 p-4"},mn={class:"container-fluid"},vn={key:0,class:"page-header mb-4"},fn={class:"d-flex justify-content-between align-items-center"},gn={class:"page-title mb-1"},pn={key:0,class:"page-subtitle text-muted mb-0"},bn={key:0,class:"page-actions"},hn={class:"page-body"};function _n(a,e,d,s,m,u){const o=Q("AppSidebar"),l=Q("AppHeader"),v=Q("AppBreadcrumbs"),f=Q("router-view"),_=Q("AppFooter");return n(),i("div",dn,[A(o,{"is-open":s.appStore.isSidebarOpen,onClose:e[0]||(e[0]=M=>s.appStore.setSidebarOpen(!1))},null,8,["is-open"]),t("div",cn,[A(l,{onToggleSidebar:s.appStore.toggleSidebar},null,8,["onToggleSidebar"]),s.appStore.breadcrumbs.length>0?(n(),ft(v,{key:0,items:s.appStore.breadcrumbs},null,8,["items"])):g("",!0),t("main",un,[t("div",mn,[s.appStore.pageTitle?(n(),i("div",vn,[t("div",fn,[t("div",null,[t("h1",gn,r(s.appStore.pageTitle),1),s.appStore.pageSubtitle?(n(),i("p",pn,r(s.appStore.pageSubtitle),1)):g("",!0)]),a.$slots.pageActions?(n(),i("div",bn,[se(a.$slots,"pageActions",{},void 0,!0)])):g("",!0)])])):g("",!0),t("div",hn,[A(f)])])]),A(_)]),s.appStore.isSidebarOpen&&s.isMobile?(n(),i("div",{key:0,class:"sidebar-overlay",onClick:e[1]||(e[1]=M=>s.appStore.setSidebarOpen(!1))})):g("",!0)])}const yn=J(rn,[["render",_n],["__scopeId","data-v-0d89a757"]]),wn={name:"AuthLayout"},kn={class:"auth-layout min-vh-100 d-flex"},Cn={class:"auth-main flex-grow-1 d-flex flex-column justify-content-center"},xn={class:"container"},Sn={class:"row justify-content-center"},$n={class:"col-md-8 col-lg-6 col-xl-5"},Pn={class:"auth-card card border-0 shadow-lg"},Dn={class:"card-body p-4 p-md-5"},Tn={class:"auth-switch text-center mt-4"};function Mn(a,e,d,s,m,u){const o=Q("router-view"),l=Q("router-link");return n(),i("div",kn,[e[4]||(e[4]=rt('<div class="auth-sidebar d-none d-lg-flex flex-column justify-content-center align-items-center" data-v-72a975ad><div class="auth-brand mb-5" data-v-72a975ad><div class="brand-logo mb-3" data-v-72a975ad><i class="fas fa-building fa-4x text-white" data-v-72a975ad></i></div><h2 class="text-white fw-bold text-center" data-v-72a975ad> Учёт активности предприятия </h2><p class="text-white-50 text-center mb-0" data-v-72a975ad> Система управления мероприятиями и начисления баллов </p></div><div class="auth-features" data-v-72a975ad><div class="feature-item d-flex align-items-center mb-3" data-v-72a975ad><div class="feature-icon me-3" data-v-72a975ad><i class="fas fa-calendar-check" data-v-72a975ad></i></div><div data-v-72a975ad><h6 class="text-white mb-1" data-v-72a975ad>Управление мероприятиями</h6><p class="text-white-50 mb-0 small" data-v-72a975ad> Создавайте и участвуйте в корпоративных событиях </p></div></div><div class="feature-item d-flex align-items-center mb-3" data-v-72a975ad><div class="feature-icon me-3" data-v-72a975ad><i class="fas fa-coins" data-v-72a975ad></i></div><div data-v-72a975ad><h6 class="text-white mb-1" data-v-72a975ad>Система баллов</h6><p class="text-white-50 mb-0 small" data-v-72a975ad> Зарабатывайте баллы за активное участие </p></div></div><div class="feature-item d-flex align-items-center mb-3" data-v-72a975ad><div class="feature-icon me-3" data-v-72a975ad><i class="fas fa-gift" data-v-72a975ad></i></div><div data-v-72a975ad><h6 class="text-white mb-1" data-v-72a975ad>Обмен на награды</h6><p class="text-white-50 mb-0 small" data-v-72a975ad> Обменивайте баллы на ценные призы и услуги </p></div></div><div class="feature-item d-flex align-items-center" data-v-72a975ad><div class="feature-icon me-3" data-v-72a975ad><i class="fas fa-chart-line" data-v-72a975ad></i></div><div data-v-72a975ad><h6 class="text-white mb-1" data-v-72a975ad>Аналитика</h6><p class="text-white-50 mb-0 small" data-v-72a975ad> Отслеживайте свой прогресс и достижения </p></div></div></div></div>',1)),t("div",Cn,[t("div",xn,[t("div",Sn,[t("div",$n,[e[2]||(e[2]=rt('<div class="auth-header d-lg-none text-center mb-4" data-v-72a975ad><div class="brand-logo mb-3" data-v-72a975ad><i class="fas fa-building fa-3x text-primary" data-v-72a975ad></i></div><h3 class="fw-bold text-dark mb-2" data-v-72a975ad> Учёт активности предприятия </h3><p class="text-muted" data-v-72a975ad> Система управления мероприятиями </p></div>',1)),t("div",Pn,[t("div",Dn,[A(o)])]),t("div",Tn,[a.$route.name==="Login"?(n(),ft(l,{key:0,to:"/auth/register",class:"text-decoration-none"},{default:N(()=>e[0]||(e[0]=[c(" Нет аккаунта? ",-1),t("strong",null,"Зарегистрироваться",-1)])),_:1,__:[0]})):g("",!0),a.$route.name==="Register"?(n(),ft(l,{key:1,to:"/auth/login",class:"text-decoration-none"},{default:N(()=>e[1]||(e[1]=[c(" Уже есть аккаунт? ",-1),t("strong",null,"Войти",-1)])),_:1,__:[1]})):g("",!0)]),e[3]||(e[3]=t("div",{class:"auth-support text-center mt-4"},[t("p",{class:"text-muted small"},[c(" Нужна помощь? Обратитесь к "),t("a",{href:"mailto:support@company.com",class:"text-decoration-none"}," службе поддержки ")])],-1))])])])])])}const In=J(wn,[["render",Mn],["__scopeId","data-v-72a975ad"]]),An={name:"LoginPage",setup(){const a=bt(),e=mt(),d=pt(),s=Xt({email:"",password:"",remember:!1}),m=Xt({}),u=w(""),o=w(!1),l=w(!1);return{form:s,errors:m,error:u,isLoading:o,showPassword:l,fillDemoAccount:_=>{const R={admin:{email:"admin@company.com",password:"password"},moderator:{email:"moderator@company.com",password:"password"},user:{email:"user@company.com",password:"password"}}[_];R&&(s.email=R.email,s.password=R.password,e.info(`Заполнен аккаунт ${_}`))},handleLogin:async()=>{if(Object.keys(m).forEach(_=>delete m[_]),u.value="",!s.email){m.email="Email обязателен";return}if(!s.password){m.password="Пароль обязателен";return}try{o.value=!0;const _=await d.login({email:s.email,password:s.password});_.success?(e.success("Добро пожаловать!"),a.push("/")):u.value=_.error}catch(_){console.error("Ошибка входа:",_),u.value="Произошла ошибка при входе в систему"}finally{o.value=!1}}}}},Rn={class:"login-page"},En={class:"container"},Nn={class:"row justify-content-center"},Un={class:"col-md-6 col-lg-5 col-xl-4"},Ln={class:"demo-accounts mb-4"},Vn={class:"card border-info"},Bn={class:"card-body"},Fn={class:"card shadow-sm"},On={class:"card-body p-4"},qn={class:"mb-3"},jn={class:"input-group"},Hn={key:0,class:"invalid-feedback"},zn={class:"mb-3"},Zn={class:"input-group"},Wn=["type"],Yn={key:0,class:"invalid-feedback"},Gn={class:"mb-3 form-check"},Qn=["disabled"],Kn={key:0,class:"spinner-border spinner-border-sm me-2"},Xn={key:0,class:"alert alert-danger",role:"alert"},Jn={class:"text-center"};function ti(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Rn,[t("div",En,[t("div",Nn,[t("div",Un,[e[19]||(e[19]=rt('<div class="text-center mb-4" data-v-8ef85141><div class="logo mb-3" data-v-8ef85141><i class="fas fa-trophy fa-3x text-primary" data-v-8ef85141></i></div><h2 class="fw-bold" data-v-8ef85141>Добро пожаловать</h2><p class="text-muted" data-v-8ef85141>Войдите в систему для доступа к мероприятиям и наградам</p></div>',1)),t("div",Ln,[t("div",Vn,[e[11]||(e[11]=t("div",{class:"card-header bg-info text-white"},[t("h6",{class:"mb-0"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Демо-аккаунты для тестирования ")])],-1)),t("div",Bn,[t("div",{class:"demo-account-item mb-2",onClick:e[0]||(e[0]=l=>s.fillDemoAccount("admin"))},e[8]||(e[8]=[t("strong",null,"Администратор:",-1),c(" admin@company.com / password ",-1)])),t("div",{class:"demo-account-item mb-2",onClick:e[1]||(e[1]=l=>s.fillDemoAccount("moderator"))},e[9]||(e[9]=[t("strong",null,"Модератор:",-1),c(" moderator@company.com / password ",-1)])),t("div",{class:"demo-account-item",onClick:e[2]||(e[2]=l=>s.fillDemoAccount("user"))},e[10]||(e[10]=[t("strong",null,"Пользователь:",-1),c(" user@company.com / password ",-1)]))])])]),t("div",Fn,[t("div",On,[t("form",{onSubmit:e[7]||(e[7]=lt((...l)=>s.handleLogin&&s.handleLogin(...l),["prevent"]))},[t("div",qn,[e[13]||(e[13]=t("label",{for:"email",class:"form-label"},"Email",-1)),t("div",jn,[e[12]||(e[12]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-envelope"})],-1)),E(t("input",{id:"email","onUpdate:modelValue":e[3]||(e[3]=l=>s.form.email=l),type:"email",class:h(["form-control",{"is-invalid":s.errors.email}]),placeholder:"Введите ваш email",required:""},null,2),[[et,s.form.email]]),s.errors.email?(n(),i("div",Hn,r(s.errors.email),1)):g("",!0)])]),t("div",zn,[e[15]||(e[15]=t("label",{for:"password",class:"form-label"},"Пароль",-1)),t("div",Zn,[e[14]||(e[14]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-lock"})],-1)),E(t("input",{id:"password","onUpdate:modelValue":e[4]||(e[4]=l=>s.form.password=l),type:s.showPassword?"text":"password",class:h(["form-control",{"is-invalid":s.errors.password}]),placeholder:"Введите пароль",required:""},null,10,Wn),[[Kt,s.form.password]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[5]||(e[5]=l=>s.showPassword=!s.showPassword)},[t("i",{class:h(s.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)]),s.errors.password?(n(),i("div",Yn,r(s.errors.password),1)):g("",!0)])]),t("div",Gn,[E(t("input",{id:"remember","onUpdate:modelValue":e[6]||(e[6]=l=>s.form.remember=l),type:"checkbox",class:"form-check-input"},null,512),[[Tt,s.form.remember]]),e[16]||(e[16]=t("label",{class:"form-check-label",for:"remember"}," Запомнить меня ",-1))]),t("button",{type:"submit",class:"btn btn-primary w-100 mb-3",disabled:s.isLoading},[s.isLoading?(n(),i("span",Kn)):g("",!0),c(" "+r(s.isLoading?"Вход...":"Войти"),1)],8,Qn),s.error?(n(),i("div",Xn,[e[17]||(e[17]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),c(" "+r(s.error),1)])):g("",!0)],32),t("div",Jn,[A(o,{to:"/auth/register",class:"text-decoration-none"},{default:N(()=>e[18]||(e[18]=[c(" Нет аккаунта? Зарегистрируйтесь ",-1)])),_:1,__:[18]})])])]),e[20]||(e[20]=t("div",{class:"text-center mt-4"},[t("small",{class:"text-muted"}," Система управления корпоративными мероприятиями и наградами ")],-1))])])])])}const ei=J(An,[["render",ti],["__scopeId","data-v-8ef85141"]]),si={name:"RegisterPage",setup(){const a=bt(),e=mt(),d=pt(),s=ut(),m=w(1),u=w(!1),o=w(!1),l=w(!1),v=w({firstName:"",lastName:"",middleName:"",email:"",password:"",confirmPassword:"",employeeId:"",department:"",position:"",phone:"",agreeTerms:!1,agreeNotifications:!1}),f=w({}),_=w({}),M=w(["Администрация","Бухгалтерия","HR / Кадры","IT / Информационные технологии","Маркетинг","Продажи","Производство","Снабжение","Юридический отдел","Другое"]),R=j(()=>{const C=v.value.password;if(!C)return{width:"0%",class:"",text:""};let b=0;return C.length>=8&&b++,/[a-z]/.test(C)&&b++,/[A-Z]/.test(C)&&b++,/[0-9]/.test(C)&&b++,/[^A-Za-z0-9]/.test(C)&&b++,[{width:"20%",class:"text-danger",text:"Очень слабый"},{width:"40%",class:"text-warning",text:"Слабый"},{width:"60%",class:"text-info",text:"Средний"},{width:"80%",class:"text-primary",text:"Хороший"},{width:"100%",class:"text-success",text:"Отличный"}][Math.min(b,4)]}),k=j(()=>m.value===1?v.value.firstName&&v.value.lastName&&v.value.email&&v.value.password&&v.value.confirmPassword&&!f.value.firstName&&!f.value.lastName&&!f.value.email&&!f.value.password&&!f.value.confirmPassword:m.value===2?!f.value.phone&&!f.value.employeeId:!1),V=j(()=>v.value.agreeTerms&&!f.value.agreeTerms),I=()=>{const C={};return v.value.firstName.trim()||(C.firstName="Имя обязательно"),v.value.lastName.trim()||(C.lastName="Фамилия обязательна"),v.value.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.value.email)||(C.email="Некорректный формат email"):C.email="Email обязателен",v.value.password?v.value.password.length<6&&(C.password="Пароль должен содержать минимум 6 символов"):C.password="Пароль обязателен",v.value.confirmPassword?v.value.password!==v.value.confirmPassword&&(C.confirmPassword="Пароли не совпадают"):C.confirmPassword="Подтверждение пароля обязательно",Object.assign(f.value,C),Object.keys(C).length===0},F=()=>{const C={};return v.value.phone&&!/^[+]?[0-9\s\-\(\)]+$/.test(v.value.phone)&&(C.phone="Некорректный формат телефона"),Object.assign(f.value,C),Object.keys(C).length===0},$=()=>{const C={};return v.value.agreeTerms||(C.agreeTerms="Необходимо согласиться с условиями использования"),Object.assign(f.value,C),Object.keys(C).length===0},x=C=>{delete f.value[C],delete f.value.general},y=()=>{let C=!1;m.value===1?C=I():m.value===2&&(C=F()),C&&m.value<3&&m.value++},D=()=>{m.value>1&&m.value--},L=()=>{o.value=!o.value},W=async()=>{if($())try{u.value=!0,f.value.general="";const C={firstName:v.value.firstName.trim(),lastName:v.value.lastName.trim(),middleName:v.value.middleName.trim()||void 0,email:v.value.email.trim(),password:v.value.password,phone:v.value.phone.trim()||void 0,department:v.value.department||void 0,position:v.value.position.trim()||void 0,employeeId:v.value.employeeId.trim()||void 0},b=await d.register(C);b.success?(e.success(`Добро пожаловать, ${b.user.firstName}! Регистрация прошла успешно.`),a.push("/dashboard")):f.value.general=b.error}catch(C){console.error("Ошибка регистрации:",C),f.value.general="Произошла неожиданная ошибка. Попробуйте позже."}finally{u.value=!1}},q=()=>{e.info("Условия использования будут доступны в следующей версии")},O=()=>{e.info("Политика конфиденциальности будет доступна в следующей версии")};return dt(()=>{s.setPageTitle("Регистрация в системе")}),{currentStep:m,isLoading:u,showPassword:o,showConfirmPassword:l,form:v,errors:f,touched:_,departments:M,passwordStrength:R,canProceedToNextStep:k,canSubmit:V,clearError:x,nextStep:y,previousStep:D,togglePasswordVisibility:L,handleSubmit:W,showTerms:q,showPrivacy:O}}},ai={class:"register-page"},oi={class:"registration-progress mb-4"},ni={class:"progress-steps"},ii={class:"step-content"},li={class:"row"},ri={class:"col-md-6 mb-3"},di={key:0,class:"invalid-feedback"},ci={class:"col-md-6 mb-3"},ui={key:0,class:"invalid-feedback"},mi={class:"mb-3"},vi={class:"mb-3"},fi={key:0,class:"invalid-feedback"},gi={class:"row"},pi={class:"col-md-6 mb-3"},bi={class:"password-input-container"},hi=["type"],_i=["title"],yi={key:0,class:"invalid-feedback"},wi={key:1,class:"password-strength mt-2"},ki={class:"strength-bar"},Ci={class:"col-md-6 mb-3"},xi=["type"],Si={key:0,class:"invalid-feedback"},$i={class:"step-content"},Pi={class:"mb-3"},Di={key:0,class:"invalid-feedback"},Ti={class:"row"},Mi={class:"col-md-6 mb-3"},Ii=["value"],Ai={key:0,class:"invalid-feedback"},Ri={class:"col-md-6 mb-3"},Ei={class:"mb-3"},Ni={key:0,class:"invalid-feedback"},Ui={class:"step-content"},Li={class:"registration-summary"},Vi={class:"summary-card"},Bi={class:"summary-section"},Fi={key:0},Oi={key:0,class:"summary-section"},qi={key:0},ji={key:1},Hi={key:2},zi={class:"agreements mt-4"},Zi={class:"form-check mb-3"},Wi={class:"form-check-label",for:"agreeTerms"},Yi={key:0,class:"invalid-feedback"},Gi={class:"form-check mb-3"},Qi={key:0,class:"alert alert-danger mt-3",role:"alert"},Ki={class:"step-navigation mt-4"},Xi={class:"d-flex justify-content-between"},Ji=["disabled"],tl={key:1},el=["disabled"],sl=["disabled"],al={key:0,class:"spinner-border spinner-border-sm me-2"},ol={key:1,class:"fas fa-user-plus me-2"};function nl(a,e,d,s,m,u){return n(),i("div",ai,[e[65]||(e[65]=t("div",{class:"auth-form-header text-center mb-4"},[t("h3",{class:"auth-title mb-2"},"Создать аккаунт"),t("p",{class:"auth-subtitle text-muted"}," Зарегистрируйтесь для участия в корпоративных мероприятиях ")],-1)),t("div",oi,[t("div",ni,[t("div",{class:h(["progress-step",{active:s.currentStep===1,completed:s.currentStep>1}])},e[35]||(e[35]=[t("div",{class:"step-number"},"1",-1),t("div",{class:"step-label"},"Основная информация",-1)]),2),t("div",{class:h(["progress-step",{active:s.currentStep===2,completed:s.currentStep>2}])},e[36]||(e[36]=[t("div",{class:"step-number"},"2",-1),t("div",{class:"step-label"},"Рабочая информация",-1)]),2),t("div",{class:h(["progress-step",{active:s.currentStep===3}])},e[37]||(e[37]=[t("div",{class:"step-number"},"3",-1),t("div",{class:"step-label"},"Завершение",-1)]),2)])]),t("form",{onSubmit:e[34]||(e[34]=lt((...o)=>s.handleSubmit&&s.handleSubmit(...o),["prevent"])),novalidate:""},[E(t("div",ii,[t("div",li,[t("div",ri,[e[38]||(e[38]=t("label",{for:"lastName",class:"form-label required"},[t("i",{class:"fas fa-user me-2"}),c(" Фамилия ")],-1)),E(t("input",{id:"lastName","onUpdate:modelValue":e[0]||(e[0]=o=>s.form.lastName=o),type:"text",class:h(["form-control",{"is-invalid":s.errors.lastName,"is-valid":!s.errors.lastName&&s.form.lastName&&s.touched.lastName}]),placeholder:"Иванов",required:"",onBlur:e[1]||(e[1]=o=>s.touched.lastName=!0),onInput:e[2]||(e[2]=o=>s.clearError("lastName"))},null,34),[[et,s.form.lastName]]),s.errors.lastName?(n(),i("div",di,r(s.errors.lastName),1)):g("",!0)]),t("div",ci,[e[39]||(e[39]=t("label",{for:"firstName",class:"form-label required"},[t("i",{class:"fas fa-user me-2"}),c(" Имя ")],-1)),E(t("input",{id:"firstName","onUpdate:modelValue":e[3]||(e[3]=o=>s.form.firstName=o),type:"text",class:h(["form-control",{"is-invalid":s.errors.firstName,"is-valid":!s.errors.firstName&&s.form.firstName&&s.touched.firstName}]),placeholder:"Иван",required:"",onBlur:e[4]||(e[4]=o=>s.touched.firstName=!0),onInput:e[5]||(e[5]=o=>s.clearError("firstName"))},null,34),[[et,s.form.firstName]]),s.errors.firstName?(n(),i("div",ui,r(s.errors.firstName),1)):g("",!0)])]),t("div",mi,[e[40]||(e[40]=t("label",{for:"middleName",class:"form-label"},[t("i",{class:"fas fa-user me-2"}),c(" Отчество ")],-1)),E(t("input",{id:"middleName","onUpdate:modelValue":e[6]||(e[6]=o=>s.form.middleName=o),type:"text",class:"form-control",placeholder:"Иванович (необязательно)",onInput:e[7]||(e[7]=o=>s.clearError("middleName"))},null,544),[[et,s.form.middleName]])]),t("div",vi,[e[41]||(e[41]=t("label",{for:"email",class:"form-label required"},[t("i",{class:"fas fa-envelope me-2"}),c(" Email адрес ")],-1)),E(t("input",{id:"email","onUpdate:modelValue":e[8]||(e[8]=o=>s.form.email=o),type:"email",class:h(["form-control",{"is-invalid":s.errors.email,"is-valid":!s.errors.email&&s.form.email&&s.touched.email}]),placeholder:"ivan@company.com",required:"",autocomplete:"email",onBlur:e[9]||(e[9]=o=>s.touched.email=!0),onInput:e[10]||(e[10]=o=>s.clearError("email"))},null,34),[[et,s.form.email]]),s.errors.email?(n(),i("div",fi,r(s.errors.email),1)):g("",!0),e[42]||(e[42]=t("div",{class:"form-text"}," Используйте корпоративный email адрес ",-1))]),t("div",gi,[t("div",pi,[e[43]||(e[43]=t("label",{for:"password",class:"form-label required"},[t("i",{class:"fas fa-lock me-2"}),c(" Пароль ")],-1)),t("div",bi,[E(t("input",{id:"password","onUpdate:modelValue":e[11]||(e[11]=o=>s.form.password=o),type:s.showPassword?"text":"password",class:h(["form-control",{"is-invalid":s.errors.password,"is-valid":!s.errors.password&&s.form.password&&s.touched.password}]),placeholder:"Создайте пароль",required:"",autocomplete:"new-password",onBlur:e[12]||(e[12]=o=>s.touched.password=!0),onInput:e[13]||(e[13]=o=>s.clearError("password"))},null,42,hi),[[Kt,s.form.password]]),t("button",{type:"button",class:"password-toggle",onClick:e[14]||(e[14]=(...o)=>s.togglePasswordVisibility&&s.togglePasswordVisibility(...o)),title:s.showPassword?"Скрыть пароль":"Показать пароль"},[t("i",{class:h(s.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)],8,_i)]),s.errors.password?(n(),i("div",yi,r(s.errors.password),1)):g("",!0),s.form.password?(n(),i("div",wi,[t("div",ki,[t("div",{class:h(["strength-fill",s.passwordStrength.class]),style:st({width:s.passwordStrength.width})},null,6)]),t("small",{class:h(["strength-text",s.passwordStrength.class])},r(s.passwordStrength.text),3)])):g("",!0)]),t("div",Ci,[e[44]||(e[44]=t("label",{for:"confirmPassword",class:"form-label required"},[t("i",{class:"fas fa-lock me-2"}),c(" Подтвердите пароль ")],-1)),E(t("input",{id:"confirmPassword","onUpdate:modelValue":e[15]||(e[15]=o=>s.form.confirmPassword=o),type:s.showConfirmPassword?"text":"password",class:h(["form-control",{"is-invalid":s.errors.confirmPassword,"is-valid":!s.errors.confirmPassword&&s.form.confirmPassword&&s.touched.confirmPassword}]),placeholder:"Повторите пароль",required:"",autocomplete:"new-password",onBlur:e[16]||(e[16]=o=>s.touched.confirmPassword=!0),onInput:e[17]||(e[17]=o=>s.clearError("confirmPassword"))},null,42,xi),[[Kt,s.form.confirmPassword]]),s.errors.confirmPassword?(n(),i("div",Si,r(s.errors.confirmPassword),1)):g("",!0)])])],512),[[Yt,s.currentStep===1]]),E(t("div",$i,[t("div",Pi,[e[45]||(e[45]=t("label",{for:"employeeId",class:"form-label"},[t("i",{class:"fas fa-id-badge me-2"}),c(" Табельный номер ")],-1)),E(t("input",{id:"employeeId","onUpdate:modelValue":e[18]||(e[18]=o=>s.form.employeeId=o),type:"text",class:h(["form-control",{"is-invalid":s.errors.employeeId,"is-valid":!s.errors.employeeId&&s.form.employeeId&&s.touched.employeeId}]),placeholder:"12345 (необязательно)",onBlur:e[19]||(e[19]=o=>s.touched.employeeId=!0),onInput:e[20]||(e[20]=o=>s.clearError("employeeId"))},null,34),[[et,s.form.employeeId]]),s.errors.employeeId?(n(),i("div",Di,r(s.errors.employeeId),1)):g("",!0)]),t("div",Ti,[t("div",Mi,[e[47]||(e[47]=t("label",{for:"department",class:"form-label"},[t("i",{class:"fas fa-building me-2"}),c(" Отдел ")],-1)),E(t("select",{id:"department","onUpdate:modelValue":e[21]||(e[21]=o=>s.form.department=o),class:"form-select",onChange:e[22]||(e[22]=o=>s.clearError("department"))},[e[46]||(e[46]=t("option",{value:""},"Выберите отдел",-1)),(n(!0),i(H,null,G(s.departments,o=>(n(),i("option",{key:o,value:o},r(o),9,Ii))),128))],544),[[ot,s.form.department]]),s.errors.department?(n(),i("div",Ai,r(s.errors.department),1)):g("",!0)]),t("div",Ri,[e[48]||(e[48]=t("label",{for:"position",class:"form-label"},[t("i",{class:"fas fa-briefcase me-2"}),c(" Должность ")],-1)),E(t("input",{id:"position","onUpdate:modelValue":e[23]||(e[23]=o=>s.form.position=o),type:"text",class:"form-control",placeholder:"Ваша должность",onInput:e[24]||(e[24]=o=>s.clearError("position"))},null,544),[[et,s.form.position]])])]),t("div",Ei,[e[49]||(e[49]=t("label",{for:"phone",class:"form-label"},[t("i",{class:"fas fa-phone me-2"}),c(" Телефон ")],-1)),E(t("input",{id:"phone","onUpdate:modelValue":e[25]||(e[25]=o=>s.form.phone=o),type:"tel",class:h(["form-control",{"is-invalid":s.errors.phone,"is-valid":!s.errors.phone&&s.form.phone&&s.touched.phone}]),placeholder:"+7 (999) 123-45-67",onBlur:e[26]||(e[26]=o=>s.touched.phone=!0),onInput:e[27]||(e[27]=o=>s.clearError("phone"))},null,34),[[et,s.form.phone]]),s.errors.phone?(n(),i("div",Ni,r(s.errors.phone),1)):g("",!0)])],512),[[Yt,s.currentStep===2]]),E(t("div",Ui,[t("div",Li,[e[61]||(e[61]=t("h5",{class:"mb-3"},[t("i",{class:"fas fa-check-circle text-success me-2"}),c(" Проверьте введенные данные ")],-1)),t("div",Vi,[t("div",Bi,[e[53]||(e[53]=t("h6",null,"Личная информация",-1)),t("p",null,[e[50]||(e[50]=t("strong",null,"ФИО:",-1)),c(" "+r(s.form.lastName)+" "+r(s.form.firstName)+" "+r(s.form.middleName),1)]),t("p",null,[e[51]||(e[51]=t("strong",null,"Email:",-1)),c(" "+r(s.form.email),1)]),s.form.phone?(n(),i("p",Fi,[e[52]||(e[52]=t("strong",null,"Телефон:",-1)),c(" "+r(s.form.phone),1)])):g("",!0)]),s.form.department||s.form.position||s.form.employeeId?(n(),i("div",Oi,[e[57]||(e[57]=t("h6",null,"Рабочая информация",-1)),s.form.employeeId?(n(),i("p",qi,[e[54]||(e[54]=t("strong",null,"Табельный номер:",-1)),c(" "+r(s.form.employeeId),1)])):g("",!0),s.form.department?(n(),i("p",ji,[e[55]||(e[55]=t("strong",null,"Отдел:",-1)),c(" "+r(s.form.department),1)])):g("",!0),s.form.position?(n(),i("p",Hi,[e[56]||(e[56]=t("strong",null,"Должность:",-1)),c(" "+r(s.form.position),1)])):g("",!0)])):g("",!0)]),t("div",zi,[t("div",Zi,[E(t("input",{id:"agreeTerms","onUpdate:modelValue":e[28]||(e[28]=o=>s.form.agreeTerms=o),class:h(["form-check-input",{"is-invalid":s.errors.agreeTerms}]),type:"checkbox",required:""},null,2),[[Tt,s.form.agreeTerms]]),t("label",Wi,[e[58]||(e[58]=c(" Я соглашаюсь с ",-1)),t("a",{href:"#",onClick:e[29]||(e[29]=lt((...o)=>s.showTerms&&s.showTerms(...o),["prevent"]))},"условиями использования"),e[59]||(e[59]=c(" и ",-1)),t("a",{href:"#",onClick:e[30]||(e[30]=lt((...o)=>s.showPrivacy&&s.showPrivacy(...o),["prevent"]))},"политикой конфиденциальности")]),s.errors.agreeTerms?(n(),i("div",Yi,r(s.errors.agreeTerms),1)):g("",!0)]),t("div",Gi,[E(t("input",{id:"agreeNotifications","onUpdate:modelValue":e[31]||(e[31]=o=>s.form.agreeNotifications=o),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.agreeNotifications]]),e[60]||(e[60]=t("label",{class:"form-check-label",for:"agreeNotifications"}," Я согласен получать уведомления о мероприятиях и новостях ",-1))])])])],512),[[Yt,s.currentStep===3]]),s.errors.general?(n(),i("div",Qi,[e[62]||(e[62]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),c(" "+r(s.errors.general),1)])):g("",!0),t("div",Ki,[t("div",Xi,[s.currentStep>1?(n(),i("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:e[32]||(e[32]=(...o)=>s.previousStep&&s.previousStep(...o)),disabled:s.isLoading},e[63]||(e[63]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Назад ",-1)]),8,Ji)):(n(),i("div",tl)),s.currentStep<3?(n(),i("button",{key:2,type:"button",class:"btn btn-primary",onClick:e[33]||(e[33]=(...o)=>s.nextStep&&s.nextStep(...o)),disabled:!s.canProceedToNextStep},e[64]||(e[64]=[c(" Далее ",-1),t("i",{class:"fas fa-arrow-right ms-2"},null,-1)]),8,el)):g("",!0),s.currentStep===3?(n(),i("button",{key:3,type:"submit",class:"btn btn-success",disabled:s.isLoading||!s.canSubmit},[s.isLoading?(n(),i("span",al)):(n(),i("i",ol)),c(" "+r(s.isLoading?"Регистрация...":"Зарегистрироваться"),1)],8,sl)):g("",!0)])])],32)])}const il=J(si,[["render",nl],["__scopeId","data-v-a63ba42f"]]),ll={name:"CorporateHeader",props:{title:{type:String,required:!0},subtitle:{type:String,default:""},stats:{type:Array,default:()=>[]}}},rl={class:"corporate-header"},dl={class:"container-fluid"},cl={class:"row align-items-center"},ul={class:"col-lg-8"},ml={class:"corporate-title"},vl={key:0,class:"corporate-subtitle"},fl={class:"col-lg-4"},gl={class:"corporate-stats"},pl={key:0,class:"stats-grid"},bl={class:"stat-icon"},hl={class:"stat-content"},_l={class:"stat-number"},yl={class:"stat-label"};function wl(a,e,d,s,m,u){return n(),i("div",rl,[t("div",dl,[t("div",cl,[t("div",ul,[t("h1",ml,r(d.title),1),d.subtitle?(n(),i("p",vl,r(d.subtitle),1)):g("",!0)]),t("div",fl,[t("div",gl,[d.stats?(n(),i("div",pl,[(n(!0),i(H,null,G(d.stats,(o,l)=>(n(),i("div",{key:l,class:"stat-item"},[t("div",bl,[t("i",{class:h(o.icon)},null,2)]),t("div",hl,[t("div",_l,r(o.value),1),t("div",yl,r(o.label),1)])]))),128))])):g("",!0)])])])])])}const kl=J(ll,[["render",wl],["__scopeId","data-v-bb73acd7"]]),Cl={name:"DashboardPage",components:{CorporateHeader:kl},setup(){bt();const a=mt(),e=pt(),d=ut(),s=w([]),m=w([]),u=w([]),o=w({attendedEvents:0,upcomingEvents:0,totalPurchases:0,pointsSpent:0,pointsThisMonth:0,rank:null,department:null}),l=j(()=>{var $;return[{icon:"fas fa-coins",value:d.formatNumber((($=e.user)==null?void 0:$.points)||0),label:"Баллов"},{icon:"fas fa-calendar-check",value:o.value.attendedEvents,label:"Мероприятий"},{icon:"fas fa-trophy",value:o.value.rank||"-",label:"Место в рейтинге"}]}),v=()=>{const $=new Date().getHours();return $<12?"Доброе утро":$<18?"Добрый день":"Добрый вечер"},f=()=>{const $=["Отличный день для новых достижений!","Продолжайте в том же духе!","Ваша активность вдохновляет других!","Сегодня отличный день для участия в мероприятиях!"];return $[Math.floor(Math.random()*$.length)]},_=$=>d.formatNumber($),M=($,x)=>{const y=new Date($);return x==="day"?y.getDate():x==="month"?y.toLocaleDateString("ru-RU",{month:"short"}):y.toLocaleDateString("ru-RU")},R=$=>$,k=$=>d.formatRelativeDate(new Date($)),V=$=>({event:"fas fa-calendar text-primary",points:"fas fa-coins text-warning",purchase:"fas fa-shopping-bag text-info",achievement:"fas fa-medal text-success"})[$]||"fas fa-info-circle text-secondary",I=async $=>{try{a.success("Вы успешно записались на мероприятие!"),F()}catch{a.error("Ошибка при записи на мероприятие")}},F=async()=>{try{s.value=[{id:1,title:"Корпоративная встреча",description:"Еженедельная встреча команды",date:new Date(Date.now()+864e5),time:"10:00",location:"Конференц-зал",points:50,isRegistered:!1},{id:2,title:"Тренинг по продажам",description:"Повышение навыков продаж",date:new Date(Date.now()+1728e5),time:"14:00",location:"Учебный центр",points:100,isRegistered:!0}],m.value=[{id:1,type:"event",title:'Посетили мероприятие "Корпоративная встреча"',createdAt:new Date(Date.now()-36e5),points:50},{id:2,type:"points",title:"Получили баллы за активность",createdAt:new Date(Date.now()-72e5),points:25}],u.value=[{id:1,icon:"fas fa-calendar-check",title:"Первые шаги",description:"Посетите первое мероприятие",progress:100},{id:2,icon:"fas fa-coins",title:"Накопитель",description:"Накопите 1000 баллов",progress:75}],o.value={attendedEvents:12,upcomingEvents:3,totalPurchases:5,pointsSpent:750,pointsThisMonth:250,rank:5,department:"Продажи"}}catch($){console.error("Ошибка загрузки данных дашборда:",$),a.error("Ошибка загрузки данных")}};return dt(()=>{F()}),{authStore:e,appStore:d,upcomingEvents:s,recentActivities:m,achievements:u,userStats:o,headerStats:l,getGreeting:v,getWelcomeMessage:f,formatNumber:_,formatDate:M,formatTime:R,formatRelativeTime:k,getActivityIcon:V,registerForEvent:I}}},xl={class:"dashboard-page"},Sl={class:"metrics-section"},$l={class:"container-fluid"},Pl={class:"metrics-grid mb-4"},Dl={class:"row g-3"},Tl={class:"col-lg-3 col-md-6"},Ml={class:"metric-card points-card"},Il={class:"metric-content"},Al={class:"metric-value"},Rl={class:"metric-change positive"},El={class:"col-lg-3 col-md-6"},Nl={class:"metric-card events-card"},Ul={class:"metric-content"},Ll={class:"metric-value"},Vl={class:"metric-change"},Bl={class:"col-lg-3 col-md-6"},Fl={class:"metric-card purchases-card"},Ol={class:"metric-content"},ql={class:"metric-value"},jl={class:"metric-change"},Hl={class:"col-lg-3 col-md-6"},zl={class:"metric-card rank-card"},Zl={class:"metric-content"},Wl={class:"metric-value"},Yl={class:"metric-change"},Gl={class:"row"},Ql={class:"col-lg-8"},Kl={class:"dashboard-card upcoming-events-card mb-4"},Xl={class:"card-header d-flex justify-content-between align-items-center"},Jl={class:"card-body"},tr={key:0,class:"text-center py-4"},er={key:1,class:"events-list"},sr={class:"event-date"},ar={class:"date-day"},or={class:"date-month"},nr={class:"event-info"},ir={class:"event-title"},lr={class:"event-description"},rr={class:"event-meta"},dr={class:"event-time"},cr={class:"event-location"},ur={class:"event-points"},mr={class:"event-actions"},vr=["onClick"],fr={key:1,class:"badge bg-success"},gr={class:"dashboard-card activities-card"},pr={class:"card-header d-flex justify-content-between align-items-center"},br={class:"card-body"},hr={key:0,class:"text-center py-4"},_r={key:1,class:"activities-list"},yr={class:"activity-icon"},wr={class:"activity-content"},kr={class:"activity-title"},Cr={class:"activity-time"},xr={key:0,class:"activity-points"},Sr={class:"col-lg-4"},$r={class:"dashboard-card quick-actions-card mb-4"},Pr={class:"card-body"},Dr={class:"quick-actions"},Tr={class:"dashboard-card achievements-card"},Mr={class:"card-body"},Ir={key:0,class:"text-center py-4"},Ar={key:1,class:"achievements-list"},Rr={class:"achievement-icon"},Er={class:"achievement-content"},Nr={class:"achievement-title"},Ur={class:"achievement-description"},Lr={class:"achievement-progress"},Vr={class:"progress"},Br={class:"progress-text"};function Fr(a,e,d,s,m,u){var v;const o=Q("CorporateHeader"),l=Q("router-link");return n(),i("div",xl,[A(o,{title:"Панель управления",subtitle:"Добро пожаловать в систему учёта активности предприятия",stats:s.headerStats},null,8,["stats"]),t("div",Sl,[t("div",$l,[t("div",Pl,[t("div",Dl,[t("div",Tl,[t("div",Ml,[e[2]||(e[2]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-coins"})],-1)),t("div",Il,[t("h3",Al,r(s.formatNumber(((v=s.authStore.user)==null?void 0:v.points)||0)),1),e[1]||(e[1]=t("p",{class:"metric-label"},"Текущий баланс",-1)),t("div",Rl,[e[0]||(e[0]=t("i",{class:"fas fa-arrow-up"},null,-1)),c(" +"+r(s.formatNumber(s.userStats.pointsThisMonth))+" за месяц ",1)])])])]),t("div",El,[t("div",Nl,[e[4]||(e[4]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-calendar-check"})],-1)),t("div",Ul,[t("h3",Ll,r(s.userStats.attendedEvents),1),e[3]||(e[3]=t("p",{class:"metric-label"},"Посещено мероприятий",-1)),t("div",Vl,r(s.userStats.upcomingEvents)+" предстоящих ",1)])])]),t("div",Bl,[t("div",Fl,[e[6]||(e[6]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-shopping-bag"})],-1)),t("div",Ol,[t("h3",ql,r(s.userStats.totalPurchases),1),e[5]||(e[5]=t("p",{class:"metric-label"},"Покупок сделано",-1)),t("div",jl,r(s.formatNumber(s.userStats.pointsSpent))+" баллов потрачено ",1)])])]),t("div",Hl,[t("div",zl,[e[8]||(e[8]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-trophy"})],-1)),t("div",Zl,[t("h3",Wl,"#"+r(s.userStats.rank||"-"),1),e[7]||(e[7]=t("p",{class:"metric-label"},"Место в рейтинге",-1)),t("div",Yl,r(s.userStats.department||"Общий")+" отдел ",1)])])])])]),t("div",Gl,[t("div",Ql,[t("div",Kl,[t("div",Xl,[e[10]||(e[10]=t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-calendar-alt me-2"}),c(" Предстоящие мероприятия ")],-1)),A(l,{to:"/events",class:"btn btn-sm btn-outline-primary"},{default:N(()=>e[9]||(e[9]=[c(" Все мероприятия ",-1)])),_:1,__:[9]})]),t("div",Jl,[s.upcomingEvents.length===0?(n(),i("div",tr,e[11]||(e[11]=[t("i",{class:"fas fa-calendar-times text-muted mb-3",style:{"font-size":"3rem"}},null,-1),t("p",{class:"text-muted mb-0"},"Нет предстоящих мероприятий",-1)]))):(n(),i("div",er,[(n(!0),i(H,null,G(s.upcomingEvents.slice(0,3),f=>(n(),i("div",{key:f.id,class:"event-item"},[t("div",sr,[t("div",ar,r(s.formatDate(f.date,"day")),1),t("div",or,r(s.formatDate(f.date,"month")),1)]),t("div",nr,[t("h6",ir,r(f.title),1),t("p",lr,r(f.description),1),t("div",rr,[t("span",dr,[e[12]||(e[12]=t("i",{class:"fas fa-clock me-1"},null,-1)),c(" "+r(s.formatTime(f.time)),1)]),t("span",cr,[e[13]||(e[13]=t("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),c(" "+r(f.location),1)]),t("span",ur,[e[14]||(e[14]=t("i",{class:"fas fa-coins me-1"},null,-1)),c(" "+r(f.points)+" баллов ",1)])])]),t("div",mr,[f.isRegistered?(n(),i("span",fr,"Записан")):(n(),i("button",{key:0,class:"btn btn-sm btn-primary",onClick:_=>s.registerForEvent(f.id)}," Записаться ",8,vr))])]))),128))]))])]),t("div",gr,[t("div",pr,[e[16]||(e[16]=t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-history me-2"}),c(" Последние активности ")],-1)),A(l,{to:"/profile",class:"btn btn-sm btn-outline-primary"},{default:N(()=>e[15]||(e[15]=[c(" Подробнее ",-1)])),_:1,__:[15]})]),t("div",br,[s.recentActivities.length===0?(n(),i("div",hr,e[17]||(e[17]=[t("i",{class:"fas fa-inbox text-muted mb-3",style:{"font-size":"3rem"}},null,-1),t("p",{class:"text-muted mb-0"},"Нет активности",-1)]))):(n(),i("div",_r,[(n(!0),i(H,null,G(s.recentActivities,f=>(n(),i("div",{key:f.id,class:"activity-item"},[t("div",yr,[t("i",{class:h(s.getActivityIcon(f.type))},null,2)]),t("div",wr,[t("div",kr,r(f.title),1),t("div",Cr,r(s.formatRelativeTime(f.createdAt)),1)]),f.points?(n(),i("div",xr,[t("span",{class:h(["points-badge",f.points>0?"positive":"negative"])},r(f.points>0?"+":"")+r(f.points),3)])):g("",!0)]))),128))]))])])]),t("div",Sr,[t("div",$r,[e[22]||(e[22]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-bolt me-2"}),c(" Быстрые действия ")])],-1)),t("div",Pr,[t("div",Dr,[A(l,{to:"/events",class:"quick-action-item"},{default:N(()=>e[18]||(e[18]=[t("div",{class:"action-icon"},[t("i",{class:"fas fa-calendar-plus"})],-1),t("div",{class:"action-text"},[t("div",{class:"action-title"},"Найти мероприятия"),t("div",{class:"action-subtitle"},"Записаться на события")],-1)])),_:1,__:[18]}),A(l,{to:"/rewards",class:"quick-action-item"},{default:N(()=>e[19]||(e[19]=[t("div",{class:"action-icon"},[t("i",{class:"fas fa-gift"})],-1),t("div",{class:"action-text"},[t("div",{class:"action-title"},"Каталог наград"),t("div",{class:"action-subtitle"},"Обменять баллы")],-1)])),_:1,__:[19]}),A(l,{to:"/leaderboard",class:"quick-action-item"},{default:N(()=>e[20]||(e[20]=[t("div",{class:"action-icon"},[t("i",{class:"fas fa-trophy"})],-1),t("div",{class:"action-text"},[t("div",{class:"action-title"},"Рейтинг"),t("div",{class:"action-subtitle"},"Сравнить результаты")],-1)])),_:1,__:[20]}),A(l,{to:"/profile",class:"quick-action-item"},{default:N(()=>e[21]||(e[21]=[t("div",{class:"action-icon"},[t("i",{class:"fas fa-user-edit"})],-1),t("div",{class:"action-text"},[t("div",{class:"action-title"},"Профиль"),t("div",{class:"action-subtitle"},"Настройки аккаунта")],-1)])),_:1,__:[21]})])])]),t("div",Tr,[e[24]||(e[24]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-medal me-2"}),c(" Достижения ")])],-1)),t("div",Mr,[s.achievements.length===0?(n(),i("div",Ir,e[23]||(e[23]=[t("i",{class:"fas fa-trophy text-muted mb-3",style:{"font-size":"3rem"}},null,-1),t("p",{class:"text-muted mb-0"},"Нет достижений",-1)]))):(n(),i("div",Ar,[(n(!0),i(H,null,G(s.achievements.slice(0,5),f=>(n(),i("div",{key:f.id,class:"achievement-item"},[t("div",Rr,[t("i",{class:h(f.icon)},null,2)]),t("div",Er,[t("div",Nr,r(f.title),1),t("div",Ur,r(f.description),1),t("div",Lr,[t("div",Vr,[t("div",{class:"progress-bar",style:st({width:f.progress+"%"})},null,4)]),t("span",Br,r(f.progress)+"%",1)])])]))),128))]))])])])])])])])}const Or=J(Cl,[["render",Fr],["__scopeId","data-v-d211b285"]]),qr={name:"EventCard",props:{event:{type:Object,required:!0},showTooltip:{type:Boolean,default:!1}},emits:["register","unregister","view"],setup(a){const e=ut(),d=j(()=>Math.min(a.event.currentParticipants/a.event.maxParticipants*100,100)),s=j(()=>{const I=new Date;return a.event.isRegistrationOpen&&a.event.registrationDeadline>I&&a.event.currentParticipants<a.event.maxParticipants&&a.event.startDate>I}),m=j(()=>{const I=new Date,F=new Date(a.event.startDate.getTime()-60*60*1e3);return I<F}),u=j(()=>s.value),o=I=>({conference:"fas fa-microphone",training:"fas fa-graduation-cap",workshop:"fas fa-tools",meeting:"fas fa-handshake",sports:"fas fa-running",social:"fas fa-users",volunteer:"fas fa-heart",other:"fas fa-calendar"})[I]||"fas fa-calendar",l=I=>({conference:"Конференция",training:"Обучение",workshop:"Мастер-класс",meeting:"Собрание",sports:"Спорт",social:"Социальное",volunteer:"Волонтерство",other:"Другое"})[I]||"Мероприятие",v=I=>{const F=new Date,$=new Date(I.registrationDeadline.getTime()-24*60*60*1e3);return I.endDate<F?"past":I.startDate<=F&&I.endDate>=F?"happening_now":!I.isRegistrationOpen||I.registrationDeadline<=F?"registration_closed":I.currentParticipants>=I.maxParticipants?"full":F>$?"deadline_soon":"open"},f=I=>e.formatDate(I,"dd MMM yyyy"),_=I=>e.formatDate(I,"HH:mm");return{participantsPercentage:d,canRegister:s,canUnregister:m,isRegistrationOpen:u,getEventIcon:o,getCategoryLabel:l,getEventStatus:v,formatDate:f,formatTime:_,formatFullDate:I=>e.formatDate(I,"dd MMMM yyyy, EEEE"),formatTimeRange:(I,F)=>{const $=_(I),x=_(F);return`${$} - ${x}`},formatRelativeDate:I=>e.formatRelativeDate(I),truncateText:(I,F)=>I?I.length>F?I.substring(0,F)+"...":I:""}}},jr={class:"event-image"},Hr=["src","alt"],zr={key:1,class:"event-placeholder"},Zr={key:2,class:"registration-badge"},Wr={class:"event-category"},Yr={class:"event-content"},Gr={class:"event-datetime mb-2"},Qr={class:"event-date"},Kr={class:"event-time"},Xr={key:0,class:"event-description"},Jr={class:"event-meta mb-3"},td={key:0,class:"meta-item"},ed={key:1,class:"meta-item"},sd={class:"event-stats mb-3"},ad={class:"participants-info"},od={class:"participants-count"},nd={class:"participants-bar"},id={class:"points-reward"},ld={class:"points-value"},rd={class:"event-status mb-3"},dd={key:0,class:"status-badge status-closed"},cd={key:1,class:"status-badge status-full"},ud={key:2,class:"status-badge status-deadline"},md={key:3,class:"status-badge status-live"},vd={key:4,class:"status-badge status-past"},fd={class:"event-actions"},gd=["disabled"],pd={key:0,class:"event-tooltip"},bd={class:"tooltip-content"},hd={key:0};function _d(a,e,d,s,m,u){var o;return n(),i("div",{class:h(["event-card",{"event-registered":d.event.userRegistration}])},[t("div",jr,[d.event.image?(n(),i("img",{key:0,src:d.event.image,alt:d.event.title,class:"img-fluid"},null,8,Hr)):(n(),i("div",zr,[t("i",{class:h(s.getEventIcon(d.event.category))},null,2)])),d.event.userRegistration?(n(),i("div",Zr,e[4]||(e[4]=[t("i",{class:"fas fa-check-circle"},null,-1),c(" Зарегистрирован ",-1)]))):g("",!0),t("div",Wr,r(s.getCategoryLabel(d.event.category)),1)]),t("div",Yr,[t("div",Gr,[t("div",Qr,[e[5]||(e[5]=t("i",{class:"fas fa-calendar me-1"},null,-1)),c(" "+r(s.formatDate(d.event.startDate)),1)]),t("div",Kr,[e[6]||(e[6]=t("i",{class:"fas fa-clock me-1"},null,-1)),c(" "+r(s.formatTime(d.event.startDate)),1)])]),t("h5",{class:"event-title",onClick:e[0]||(e[0]=l=>a.$emit("view",d.event.id))},r(d.event.title),1),d.event.description?(n(),i("p",Xr,r(s.truncateText(d.event.description,100)),1)):g("",!0),t("div",Jr,[d.event.location?(n(),i("div",td,[e[7]||(e[7]=t("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),c(" "+r(d.event.location),1)])):g("",!0),d.event.organizer?(n(),i("div",ed,[e[8]||(e[8]=t("i",{class:"fas fa-user me-1"},null,-1)),c(" "+r(d.event.organizer.name),1)])):g("",!0)]),t("div",sd,[t("div",ad,[t("div",od,[e[9]||(e[9]=t("i",{class:"fas fa-users me-1"},null,-1)),c(" "+r(d.event.currentParticipants)+"/"+r(d.event.maxParticipants),1)]),t("div",nd,[t("div",{class:"participants-fill",style:st({width:s.participantsPercentage+"%"})},null,4)])]),t("div",id,[e[10]||(e[10]=t("i",{class:"fas fa-coins me-1"},null,-1)),t("span",ld,r(d.event.pointsReward),1),e[11]||(e[11]=t("span",{class:"points-label"},"баллов",-1))])]),t("div",rd,[s.getEventStatus(d.event)==="registration_closed"?(n(),i("span",dd,e[12]||(e[12]=[t("i",{class:"fas fa-lock me-1"},null,-1),c(" Регистрация закрыта ",-1)]))):s.getEventStatus(d.event)==="full"?(n(),i("span",cd,e[13]||(e[13]=[t("i",{class:"fas fa-users me-1"},null,-1),c(" Мест нет ",-1)]))):s.getEventStatus(d.event)==="deadline_soon"?(n(),i("span",ud,[e[14]||(e[14]=t("i",{class:"fas fa-hourglass-half me-1"},null,-1)),c(" До "+r(s.formatRelativeDate(d.event.registrationDeadline)),1)])):s.getEventStatus(d.event)==="happening_now"?(n(),i("span",md,e[15]||(e[15]=[t("i",{class:"fas fa-play-circle me-1"},null,-1),c(" Идет сейчас ",-1)]))):s.getEventStatus(d.event)==="past"?(n(),i("span",vd,e[16]||(e[16]=[t("i",{class:"fas fa-history me-1"},null,-1),c(" Завершено ",-1)]))):g("",!0)])]),t("div",fd,[!d.event.userRegistration&&s.canRegister?(n(),i("button",{key:0,class:"btn btn-primary btn-register",onClick:e[1]||(e[1]=l=>a.$emit("register",d.event.id)),disabled:!s.isRegistrationOpen},e[17]||(e[17]=[t("i",{class:"fas fa-plus me-1"},null,-1),c(" Зарегистрироваться ",-1)]),8,gd)):d.event.userRegistration&&s.canUnregister?(n(),i("button",{key:1,class:"btn btn-outline-danger btn-unregister",onClick:e[2]||(e[2]=l=>a.$emit("unregister",d.event.id))},e[18]||(e[18]=[t("i",{class:"fas fa-times me-1"},null,-1),c(" Отменить ",-1)]))):g("",!0),t("button",{class:"btn btn-outline-primary btn-view",onClick:e[3]||(e[3]=l=>a.$emit("view",d.event.id))},e[19]||(e[19]=[t("i",{class:"fas fa-eye me-1"},null,-1),c(" Подробнее ",-1)]))]),d.showTooltip?(n(),i("div",pd,[t("div",bd,[t("h6",null,r(d.event.title),1),t("p",null,[e[20]||(e[20]=t("strong",null,"Дата:",-1)),c(" "+r(s.formatFullDate(d.event.startDate)),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Время:",-1)),c(" "+r(s.formatTimeRange(d.event.startDate,d.event.endDate)),1)]),d.event.location?(n(),i("p",hd,[e[22]||(e[22]=t("strong",null,"Место:",-1)),c(" "+r(d.event.location),1)])):g("",!0),t("p",null,[e[23]||(e[23]=t("strong",null,"Организатор:",-1)),c(" "+r(((o=d.event.organizer)==null?void 0:o.name)||"Не указан"),1)]),t("p",null,[e[24]||(e[24]=t("strong",null,"Баллы:",-1)),c(" "+r(d.event.pointsReward),1)])])])):g("",!0)],2)}const yd=J(qr,[["render",_d],["__scopeId","data-v-70aa11c6"]]),wd={name:"EventListItem",props:{event:{type:Object,required:!0}},emits:["register","unregister","view"],setup(a){const e=ut(),d=j(()=>Math.min(a.event.currentParticipants/a.event.maxParticipants*100,100)),s=j(()=>{const $=new Date;return a.event.isRegistrationOpen&&a.event.registrationDeadline>$&&a.event.currentParticipants<a.event.maxParticipants&&a.event.startDate>$}),m=j(()=>{const $=new Date,x=new Date(a.event.startDate.getTime()-60*60*1e3);return $<x}),u=j(()=>s.value),o=j(()=>{const $=new Date;return a.event.registrationDeadline>$&&a.event.isRegistrationOpen&&!a.event.userRegistration}),l=j(()=>{const $=f(a.event);return{"indicator-open":$==="open","indicator-deadline":$==="deadline_soon","indicator-closed":$==="registration_closed","indicator-full":$==="full","indicator-live":$==="happening_now","indicator-past":$==="past"}}),v=$=>({conference:"Конференция",training:"Обучение",workshop:"Мастер-класс",meeting:"Собрание",sports:"Спорт",social:"Социальное",volunteer:"Волонтерство",other:"Другое"})[$]||"Мероприятие",f=$=>{const x=new Date,y=new Date($.registrationDeadline.getTime()-24*60*60*1e3);return $.endDate<x?"past":$.startDate<=x&&$.endDate>=x?"happening_now":!$.isRegistrationOpen||$.registrationDeadline<=x?"registration_closed":$.currentParticipants>=$.maxParticipants?"full":x>y?"deadline_soon":"open"};return{participantsPercentage:d,canRegister:s,canUnregister:m,isRegistrationOpen:u,showRegistrationDeadline:o,statusIndicatorClass:l,getCategoryLabel:v,getEventStatus:f,formatDay:$=>new Date($).getDate(),formatMonth:$=>["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"][new Date($).getMonth()],formatYear:$=>new Date($).getFullYear(),formatTime:$=>e.formatDate($,"HH:mm"),formatDate:$=>e.formatDate($,"dd MMM yyyy"),formatRelativeDate:$=>e.formatRelativeDate($),truncateText:($,x)=>$?$.length>x?$.substring(0,x)+"...":$:""}}},kd={class:"row g-0 align-items-center"},Cd={class:"col-auto"},xd={class:"event-date-section"},Sd={class:"date-display"},$d={class:"date-day"},Pd={class:"date-month"},Dd={class:"date-year"},Td={class:"time-display"},Md={class:"col"},Id={class:"event-main-info"},Ad={class:"d-flex align-items-start justify-content-between"},Rd={class:"event-details"},Ed={key:0,class:"registered-indicator"},Nd={class:"event-meta-row"},Ud={class:"meta-item"},Ld={key:0,class:"meta-item"},Vd={key:1,class:"meta-item"},Bd={key:0,class:"event-description"},Fd={class:"event-status-section"},Od={class:"points-display"},qd={class:"points-value"},jd={class:"status-indicators"},Hd={key:0,class:"status-badge status-closed"},zd={key:1,class:"status-badge status-full"},Zd={key:2,class:"status-badge status-deadline"},Wd={key:3,class:"status-badge status-live"},Yd={key:4,class:"status-badge status-past"},Gd={class:"event-bottom-section"},Qd={class:"d-flex align-items-center justify-content-between"},Kd={class:"participants-section"},Xd={class:"participants-info"},Jd={class:"participants-text"},tc={class:"participants-progress"},ec={class:"progress"},sc={key:0,class:"deadline-info"},ac={class:"deadline-text"},oc={class:"event-actions"},nc=["disabled"];function ic(a,e,d,s,m,u){return n(),i("div",{class:h(["event-list-item",{"event-registered":d.event.userRegistration}])},[t("div",kd,[t("div",Cd,[t("div",xd,[t("div",Sd,[t("div",$d,r(s.formatDay(d.event.startDate)),1),t("div",Pd,r(s.formatMonth(d.event.startDate)),1),t("div",Dd,r(s.formatYear(d.event.startDate)),1)]),t("div",Td,r(s.formatTime(d.event.startDate)),1)])]),t("div",Md,[t("div",Id,[t("div",Ad,[t("div",Rd,[t("h5",{class:"event-title",onClick:e[0]||(e[0]=o=>a.$emit("view",d.event.id))},[c(r(d.event.title)+" ",1),d.event.userRegistration?(n(),i("span",Ed,e[4]||(e[4]=[t("i",{class:"fas fa-check-circle"},null,-1)]))):g("",!0)]),t("div",Nd,[t("span",Ud,[e[5]||(e[5]=t("i",{class:"fas fa-tag me-1"},null,-1)),c(" "+r(s.getCategoryLabel(d.event.category)),1)]),d.event.location?(n(),i("span",Ld,[e[6]||(e[6]=t("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),c(" "+r(d.event.location),1)])):g("",!0),d.event.organizer?(n(),i("span",Vd,[e[7]||(e[7]=t("i",{class:"fas fa-user me-1"},null,-1)),c(" "+r(d.event.organizer.name),1)])):g("",!0)]),d.event.description?(n(),i("p",Bd,r(s.truncateText(d.event.description,150)),1)):g("",!0)]),t("div",Fd,[t("div",Od,[e[8]||(e[8]=t("i",{class:"fas fa-coins"},null,-1)),t("span",qd,r(d.event.pointsReward),1),e[9]||(e[9]=t("span",{class:"points-label"},"баллов",-1))]),t("div",jd,[s.getEventStatus(d.event)==="registration_closed"?(n(),i("span",Hd,e[10]||(e[10]=[t("i",{class:"fas fa-lock me-1"},null,-1),c(" Регистрация закрыта ",-1)]))):s.getEventStatus(d.event)==="full"?(n(),i("span",zd,e[11]||(e[11]=[t("i",{class:"fas fa-users me-1"},null,-1),c(" Мест нет ",-1)]))):s.getEventStatus(d.event)==="deadline_soon"?(n(),i("span",Zd,[e[12]||(e[12]=t("i",{class:"fas fa-hourglass-half me-1"},null,-1)),c(" До дедлайна "+r(s.formatRelativeDate(d.event.registrationDeadline)),1)])):s.getEventStatus(d.event)==="happening_now"?(n(),i("span",Wd,e[13]||(e[13]=[t("i",{class:"fas fa-play-circle me-1"},null,-1),c(" Идет сейчас ",-1)]))):s.getEventStatus(d.event)==="past"?(n(),i("span",Yd,e[14]||(e[14]=[t("i",{class:"fas fa-history me-1"},null,-1),c(" Завершено ",-1)]))):g("",!0)])])]),t("div",Gd,[t("div",Qd,[t("div",Kd,[t("div",Xd,[e[15]||(e[15]=t("i",{class:"fas fa-users me-1"},null,-1)),t("span",Jd,r(d.event.currentParticipants)+"/"+r(d.event.maxParticipants)+" участников ",1)]),t("div",tc,[t("div",ec,[t("div",{class:"progress-bar",style:st({width:s.participantsPercentage+"%"})},null,4)])])]),s.showRegistrationDeadline?(n(),i("div",sc,[e[16]||(e[16]=t("i",{class:"fas fa-clock me-1"},null,-1)),t("span",ac," Регистрация до "+r(s.formatDate(d.event.registrationDeadline)),1)])):g("",!0),t("div",oc,[!d.event.userRegistration&&s.canRegister?(n(),i("button",{key:0,class:"btn btn-primary btn-sm",onClick:e[1]||(e[1]=o=>a.$emit("register",d.event.id)),disabled:!s.isRegistrationOpen},e[17]||(e[17]=[t("i",{class:"fas fa-plus me-1"},null,-1),c(" Зарегистрироваться ",-1)]),8,nc)):d.event.userRegistration&&s.canUnregister?(n(),i("button",{key:1,class:"btn btn-outline-danger btn-sm",onClick:e[2]||(e[2]=o=>a.$emit("unregister",d.event.id))},e[18]||(e[18]=[t("i",{class:"fas fa-times me-1"},null,-1),c(" Отменить ",-1)]))):g("",!0),t("button",{class:"btn btn-outline-primary btn-sm",onClick:e[3]||(e[3]=o=>a.$emit("view",d.event.id))},e[19]||(e[19]=[t("i",{class:"fas fa-eye me-1"},null,-1),c(" Подробнее ",-1)]))])])])])])]),t("div",{class:h(["status-indicator",s.statusIndicatorClass])},null,2)],2)}const lc=J(wd,[["render",ic],["__scopeId","data-v-ffe367c7"]]),rc={name:"EventsPage",components:{EventCard:yd,EventListItem:lc},setup(){const a=bt(),e=mt(),d=pt(),s=ut(),m=w(!1),u=w("grid"),o=w({search:"",category:"",status:"",sortBy:"start_date"}),l=w([]),v=w({registered:0,upcoming:0,totalPoints:0}),f=w({currentPage:1,totalPages:1,total:0,perPage:12});let _=null;const M=j(()=>o.value.search||o.value.category||o.value.status),R=j(()=>{const O=f.value.currentPage,C=f.value.totalPages,b=2,B=[],at=[];for(let p=Math.max(2,O-b);p<=Math.min(C-1,O+b);p++)B.push(p);return O-b>2?at.push(1,"..."):at.push(1),at.push(...B),O+b<C-1?at.push("...",C):at.push(C),at.filter(p=>p!==1||C>1)}),k=async()=>{try{m.value=!0;const O={page:f.value.currentPage,limit:f.value.perPage,search:o.value.search||void 0,category:o.value.category||void 0,status:o.value.status||void 0,sort:o.value.sortBy};await new Promise(p=>setTimeout(p,500));const C=V(),b=I(C),B=(f.value.currentPage-1)*f.value.perPage,at=B+f.value.perPage;l.value=b.slice(B,at),f.value.total=b.length,f.value.totalPages=Math.ceil(b.length/f.value.perPage),v.value={registered:Math.floor(Math.random()*10)+5,upcoming:Math.floor(Math.random()*15)+10,totalPoints:Math.floor(Math.random()*1e3)+500}}catch(O){console.error("Ошибка загрузки мероприятий:",O),e.error("Ошибка загрузки мероприятий")}finally{m.value=!1}},V=()=>{const O=["conference","training","workshop","meeting","sports","social","volunteer"],C=["Тренинг по личной эффективности","Корпоративный хакатон","Презентация новых продуктов","Спортивная олимпиада","Мастер-класс по публичным выступлениям","Волонтерская акция","Конференция по инновациям","Обучение новым технологиям"];return Array.from({length:50},(b,B)=>({id:`event-${B+1}`,title:C[B%C.length]+` ${Math.floor(B/C.length)+1}`,description:"Описание мероприятия...",category:O[B%O.length],startDate:new Date(Date.now()+(Math.random()-.3)*30*24*60*60*1e3),endDate:new Date(Date.now()+(Math.random()-.3)*30*24*60*60*1e3+2*60*60*1e3),location:`Конференц-зал ${String.fromCharCode(65+B%5)}`,pointsReward:Math.floor(Math.random()*100)+20,maxParticipants:Math.floor(Math.random()*50)+20,currentParticipants:Math.floor(Math.random()*30)+5,registrationDeadline:new Date(Date.now()+(Math.random()-.3)*25*24*60*60*1e3),isRegistrationOpen:Math.random()>.3,userRegistration:Math.random()>.7?{id:"reg-1",status:"confirmed"}:null,organizer:{name:"Иван Петров",department:"HR"}}))},I=O=>O.filter(C=>{if(o.value.search&&!C.title.toLowerCase().includes(o.value.search.toLowerCase())||o.value.category&&C.category!==o.value.category)return!1;if(o.value.status){const b=new Date;switch(o.value.status){case"upcoming":return C.startDate>b;case"ongoing":return C.startDate<=b&&C.endDate>=b;case"past":return C.endDate<b;case"registration_open":return C.isRegistrationOpen&&C.registrationDeadline>b}}return!0}).sort((C,b)=>{switch(o.value.sortBy){case"title":return C.title.localeCompare(b.title);case"points":return b.pointsReward-C.pointsReward;case"popularity":return b.currentParticipants-C.currentParticipants;default:return new Date(C.startDate)-new Date(b.startDate)}}),F=()=>{clearTimeout(_),_=setTimeout(()=>{f.value.currentPage=1,$()},300)},$=()=>{f.value.currentPage=1,k()},x=()=>{o.value={search:"",category:"",status:"",sortBy:"start_date"},f.value.currentPage=1,k()},y=O=>{var C;O>=1&&O<=f.value.totalPages&&(f.value.currentPage=O,k(),(C=document.querySelector(".events-content"))==null||C.scrollIntoView({behavior:"smooth"}))},D=async O=>{try{e.success("Вы успешно зарегистрированы на мероприятие!");const C=l.value.find(b=>b.id===O);C&&(C.userRegistration={id:"new-reg",status:"confirmed"},C.currentParticipants++)}catch(C){console.error("Ошибка регистрации:",C),e.error("Ошибка регистрации на мероприятие")}},L=async O=>{try{e.success("Регистрация отменена");const C=l.value.find(b=>b.id===O);C&&(C.userRegistration=null,C.currentParticipants--)}catch(C){console.error("Ошибка отмены регистрации:",C),e.error("Ошибка отмены регистрации")}},W=O=>{a.push(`/events/${O}`)},q=()=>{a.push("/events/create")};return Mt(()=>o.value.sortBy,()=>{$()}),dt(()=>{s.setPageTitle("Мероприятия"),k()}),{authStore:d,loading:m,viewMode:u,filters:o,events:l,stats:v,pagination:f,hasActiveFilters:M,visiblePages:R,loadEvents:k,debounceSearch:F,applyFilters:$,clearFilters:x,goToPage:y,handleRegister:D,handleUnregister:L,viewEvent:W,createEvent:q}}},dc={class:"events-page"},cc={class:"page-header mb-4"},uc={class:"row align-items-center"},mc={class:"col-md-6 text-md-end"},vc={class:"filters-section mb-4"},fc={class:"row g-3"},gc={class:"col-lg-4 col-md-6"},pc={class:"search-box"},bc={class:"col-lg-2 col-md-6"},hc={class:"col-lg-2 col-md-6"},_c={class:"col-lg-2 col-md-6"},yc={class:"col-lg-2 col-md-6"},wc={class:"view-toggles"},kc={class:"stats-bar mb-4"},Cc={class:"row g-3"},xc={class:"col-auto"},Sc={class:"stat-badge"},$c={class:"col-auto"},Pc={class:"stat-badge"},Dc={class:"col-auto"},Tc={class:"stat-badge"},Mc={class:"events-content"},Ic={key:0,class:"loading-state text-center py-5"},Ac={key:1,class:"empty-state text-center py-5"},Rc={class:"text-muted mb-4"},Ec={key:2,class:"events-grid"},Nc={class:"row g-4"},Uc={key:3,class:"events-list"},Lc={key:0,class:"pagination-section mt-4"},Vc={"aria-label":"Навигация по страницам"},Bc={class:"pagination justify-content-center"},Fc=["onClick"],Oc={class:"pagination-info text-center text-muted mt-2"};function qc(a,e,d,s,m,u){const o=Q("EventCard"),l=Q("EventListItem");return n(),i("div",dc,[t("div",cc,[t("div",uc,[e[15]||(e[15]=t("div",{class:"col-md-6"},[t("h1",{class:"page-title mb-2"},[t("i",{class:"fas fa-calendar-alt me-2"}),c(" Мероприятия ")]),t("p",{class:"page-subtitle text-muted mb-0"}," Участвуйте в корпоративных событиях и зарабатывайте баллы ")],-1)),t("div",mc,[s.authStore.isModerator?(n(),i("button",{key:0,class:"btn btn-primary",onClick:e[0]||(e[0]=(...v)=>s.createEvent&&s.createEvent(...v))},e[14]||(e[14]=[t("i",{class:"fas fa-plus me-2"},null,-1),c(" Создать мероприятие ",-1)]))):g("",!0)])])]),t("div",vc,[t("div",fc,[t("div",gc,[t("div",pc,[E(t("input",{"onUpdate:modelValue":e[1]||(e[1]=v=>s.filters.search=v),type:"text",class:"form-control",placeholder:"Поиск мероприятий...",onInput:e[2]||(e[2]=(...v)=>s.debounceSearch&&s.debounceSearch(...v))},null,544),[[et,s.filters.search]]),e[16]||(e[16]=t("i",{class:"fas fa-search search-icon"},null,-1))])]),t("div",bc,[E(t("select",{"onUpdate:modelValue":e[3]||(e[3]=v=>s.filters.category=v),class:"form-select",onChange:e[4]||(e[4]=(...v)=>s.applyFilters&&s.applyFilters(...v))},e[17]||(e[17]=[rt('<option value="" data-v-7c418188>Все категории</option><option value="conference" data-v-7c418188>Конференции</option><option value="training" data-v-7c418188>Обучение</option><option value="workshop" data-v-7c418188>Мастер-классы</option><option value="meeting" data-v-7c418188>Собрания</option><option value="sports" data-v-7c418188>Спорт</option><option value="social" data-v-7c418188>Социальные</option><option value="volunteer" data-v-7c418188>Волонтерство</option>',8)]),544),[[ot,s.filters.category]])]),t("div",hc,[E(t("select",{"onUpdate:modelValue":e[5]||(e[5]=v=>s.filters.status=v),class:"form-select",onChange:e[6]||(e[6]=(...v)=>s.applyFilters&&s.applyFilters(...v))},e[18]||(e[18]=[rt('<option value="" data-v-7c418188>Все статусы</option><option value="upcoming" data-v-7c418188>Предстоящие</option><option value="ongoing" data-v-7c418188>Текущие</option><option value="past" data-v-7c418188>Прошедшие</option><option value="registration_open" data-v-7c418188>Открыта регистрация</option>',5)]),544),[[ot,s.filters.status]])]),t("div",_c,[E(t("select",{"onUpdate:modelValue":e[7]||(e[7]=v=>s.filters.sortBy=v),class:"form-select",onChange:e[8]||(e[8]=(...v)=>s.applyFilters&&s.applyFilters(...v))},e[19]||(e[19]=[t("option",{value:"start_date"},"По дате",-1),t("option",{value:"title"},"По названию",-1),t("option",{value:"points"},"По баллам",-1),t("option",{value:"popularity"},"По популярности",-1)]),544),[[ot,s.filters.sortBy]])]),t("div",yc,[t("div",wc,[t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="grid"}]),onClick:e[9]||(e[9]=v=>s.viewMode="grid")},e[20]||(e[20]=[t("i",{class:"fas fa-th"},null,-1)]),2),t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="list"}]),onClick:e[10]||(e[10]=v=>s.viewMode="list")},e[21]||(e[21]=[t("i",{class:"fas fa-list"},null,-1)]),2)])])])]),t("div",kc,[t("div",Cc,[t("div",xc,[t("div",Sc,[e[22]||(e[22]=t("i",{class:"fas fa-calendar-check text-success"},null,-1)),t("span",null,r(s.stats.registered)+" зарегистрирован",1)])]),t("div",$c,[t("div",Pc,[e[23]||(e[23]=t("i",{class:"fas fa-clock text-warning"},null,-1)),t("span",null,r(s.stats.upcoming)+" предстоящих",1)])]),t("div",Dc,[t("div",Tc,[e[24]||(e[24]=t("i",{class:"fas fa-coins text-primary"},null,-1)),t("span",null,r(s.stats.totalPoints)+" баллов доступно",1)])])])]),t("div",Mc,[s.loading?(n(),i("div",Ic,e[25]||(e[25]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка мероприятий...")],-1),t("p",{class:"mt-3 text-muted"},"Загрузка мероприятий...",-1)]))):s.events.length===0?(n(),i("div",Ac,[e[26]||(e[26]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fas fa-calendar-times"})],-1)),e[27]||(e[27]=t("h4",null,"Мероприятия не найдены",-1)),t("p",Rc,r(s.hasActiveFilters?"Попробуйте изменить фильтры поиска":"Пока нет доступных мероприятий"),1),s.hasActiveFilters?(n(),i("button",{key:0,class:"btn btn-outline-primary",onClick:e[11]||(e[11]=(...v)=>s.clearFilters&&s.clearFilters(...v))}," Сбросить фильтры ")):g("",!0)])):s.viewMode==="grid"?(n(),i("div",Ec,[t("div",Nc,[(n(!0),i(H,null,G(s.events,v=>(n(),i("div",{key:v.id,class:"col-lg-4 col-md-6"},[A(o,{event:v,onRegister:s.handleRegister,onUnregister:s.handleUnregister,onView:s.viewEvent},null,8,["event","onRegister","onUnregister","onView"])]))),128))])])):(n(),i("div",Uc,[(n(!0),i(H,null,G(s.events,v=>(n(),ft(l,{key:v.id,event:v,onRegister:s.handleRegister,onUnregister:s.handleUnregister,onView:s.viewEvent},null,8,["event","onRegister","onUnregister","onView"]))),128))]))]),s.pagination.totalPages>1?(n(),i("div",Lc,[t("nav",Vc,[t("ul",Bc,[t("li",{class:h(["page-item",{disabled:s.pagination.currentPage===1}])},[t("button",{class:"page-link",onClick:e[12]||(e[12]=v=>s.goToPage(s.pagination.currentPage-1))},e[28]||(e[28]=[t("i",{class:"fas fa-chevron-left"},null,-1)]))],2),(n(!0),i(H,null,G(s.visiblePages,v=>(n(),i("li",{key:v,class:h(["page-item",{active:v===s.pagination.currentPage}])},[t("button",{class:"page-link",onClick:f=>s.goToPage(v)},r(v),9,Fc)],2))),128)),t("li",{class:h(["page-item",{disabled:s.pagination.currentPage===s.pagination.totalPages}])},[t("button",{class:"page-link",onClick:e[13]||(e[13]=v=>s.goToPage(s.pagination.currentPage+1))},e[29]||(e[29]=[t("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])]),t("div",Oc," Показано "+r((s.pagination.currentPage-1)*s.pagination.perPage+1)+"-"+r(Math.min(s.pagination.currentPage*s.pagination.perPage,s.pagination.total))+" из "+r(s.pagination.total)+" мероприятий ",1)])):g("",!0)])}const jc=J(rc,[["render",qc],["__scopeId","data-v-7c418188"]]),Hc={name:"EventDetailPage",setup(){const a=jt();bt();const e=mt(),d=w(null),s=w(null),m=w(!0),u=w(!1),o=w(!1),l=k=>({conference:"Конференция",training:"Обучение",workshop:"Мастер-класс",meeting:"Собрание",sports:"Спорт",social:"Социальное",volunteer:"Волонтерство",other:"Другое"})[k]||"Мероприятие",v=k=>new Date(k).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),f=k=>new Date(k).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),_=async()=>{var k,V;try{m.value=!0;const I=await ht.events.get(a.params.id);d.value=((k=I.data)==null?void 0:k.event)||I.event;const F=await ht.registrations.my(),$=((V=F.data)==null?void 0:V.registrations)||F.registrations||[];s.value=$.find(x=>x.eventId===a.params.id)}catch(I){console.error("Ошибка загрузки мероприятия:",I),e.error("Ошибка загрузки мероприятия")}finally{m.value=!1}},M=async()=>{try{u.value=!0,await ht.registrations.create(a.params.id),e.success("Вы успешно зарегистрированы на мероприятие!"),await _()}catch(k){console.error("Ошибка регистрации:",k),e.error(k.message||"Ошибка регистрации на мероприятие")}finally{u.value=!1}},R=async()=>{if(s.value)try{o.value=!0,await ht.registrations.cancel(s.value.id),e.success("Регистрация отменена"),await _()}catch(k){console.error("Ошибка отмены регистрации:",k),e.error(k.message||"Ошибка отмены регистрации")}finally{o.value=!1}};return dt(()=>{_()}),{event:d,userRegistration:s,loading:m,registering:u,cancelling:o,getEventTypeLabel:l,formatDate:v,formatTime:f,registerForEvent:M,cancelRegistration:R}}},zc={class:"event-detail-page"},Zc={class:"container"},Wc={key:0,class:"text-center py-5"},Yc={key:1,class:"event-content"},Gc={class:"page-header mb-4"},Qc={class:"row align-items-center"},Kc={class:"col-md-8"},Xc={class:"page-title mb-2"},Jc={class:"event-meta"},tu={class:"badge bg-primary me-2"},eu={class:"text-muted"},su={class:"col-md-4 text-md-end"},au={class:"event-points"},ou={class:"row"},nu={class:"col-lg-8"},iu={class:"card mb-4"},lu={class:"card-body"},ru={class:"card-text"},du={class:"row mt-4"},cu={class:"col-md-6"},uu={class:"col-md-6"},mu={class:"progress mb-2"},vu={key:0,class:"mt-4"},fu={class:"tags"},gu={class:"col-lg-4"},pu={class:"card mb-4"},bu={class:"card-body"},hu={key:0,class:"registration-status"},_u=["disabled"],yu={key:0,class:"spinner-border spinner-border-sm me-2"},wu={key:1,class:"registration-form"},ku={class:"text-muted mb-3"},Cu=["disabled"],xu={key:0,class:"spinner-border spinner-border-sm me-2"},Su={key:2,class:"registration-closed"},$u={class:"card"},Pu={class:"card-body"},Du={class:"organizer-info"},Tu={class:"d-flex align-items-center"},Mu={class:"mb-0"},Iu={key:2,class:"text-center py-5"};function Au(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",zc,[t("div",Zc,[s.loading?(n(),i("div",Wc,e[2]||(e[2]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):s.event?(n(),i("div",Yc,[t("div",Gc,[t("div",Qc,[t("div",Kc,[t("h1",Xc,r(s.event.title),1),t("div",Jc,[t("span",tu,r(s.getEventTypeLabel(s.event.type)),1),t("span",eu,[e[3]||(e[3]=t("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),c(" "+r(s.event.location),1)])])]),t("div",su,[t("div",au,[e[4]||(e[4]=t("i",{class:"fas fa-coins text-warning me-1"},null,-1)),c(" "+r(s.event.pointsReward)+" баллов ",1)])])])]),t("div",ou,[t("div",nu,[t("div",iu,[t("div",lu,[e[11]||(e[11]=t("h5",{class:"card-title"},"Описание",-1)),t("p",ru,r(s.event.description),1),t("div",du,[t("div",cu,[e[7]||(e[7]=t("h6",null,"Дата и время",-1)),t("p",null,[e[5]||(e[5]=t("i",{class:"fas fa-calendar me-2"},null,-1)),c(" "+r(s.formatDate(s.event.startDate)),1)]),t("p",null,[e[6]||(e[6]=t("i",{class:"fas fa-clock me-2"},null,-1)),c(" "+r(s.formatTime(s.event.startDate))+" - "+r(s.formatTime(s.event.endDate)),1)])]),t("div",uu,[e[9]||(e[9]=t("h6",null,"Участники",-1)),t("p",null,[e[8]||(e[8]=t("i",{class:"fas fa-users me-2"},null,-1)),c(" "+r(s.event.currentParticipants)+" / "+r(s.event.maxParticipants),1)]),t("div",mu,[t("div",{class:"progress-bar",style:st({width:s.event.currentParticipants/s.event.maxParticipants*100+"%"})},null,4)])])]),s.event.tags&&s.event.tags.length>0?(n(),i("div",vu,[e[10]||(e[10]=t("h6",null,"Теги",-1)),t("div",fu,[(n(!0),i(H,null,G(s.event.tags,l=>(n(),i("span",{key:l,class:"badge bg-light text-dark me-1"},r(l),1))),128))])])):g("",!0)])])]),t("div",gu,[t("div",pu,[t("div",bu,[e[16]||(e[16]=t("h5",{class:"card-title"},"Регистрация",-1)),s.userRegistration?(n(),i("div",hu,[e[13]||(e[13]=t("div",{class:"alert alert-success"},[t("i",{class:"fas fa-check-circle me-2"}),c(" Вы зарегистрированы на это мероприятие ")],-1)),t("button",{class:"btn btn-outline-danger w-100",onClick:e[0]||(e[0]=(...l)=>s.cancelRegistration&&s.cancelRegistration(...l)),disabled:s.cancelling},[s.cancelling?(n(),i("span",yu)):g("",!0),e[12]||(e[12]=c(" Отменить регистрацию ",-1))],8,_u)])):s.event.isRegistrationOpen?(n(),i("div",wu,[t("p",ku," Осталось мест: "+r(s.event.maxParticipants-s.event.currentParticipants),1),t("button",{class:"btn btn-primary w-100",onClick:e[1]||(e[1]=(...l)=>s.registerForEvent&&s.registerForEvent(...l)),disabled:s.registering},[s.registering?(n(),i("span",xu)):g("",!0),e[14]||(e[14]=c(" Зарегистрироваться ",-1))],8,Cu)])):(n(),i("div",Su,e[15]||(e[15]=[t("div",{class:"alert alert-warning"},[t("i",{class:"fas fa-exclamation-triangle me-2"}),c(" Регистрация закрыта ")],-1)])))])]),t("div",$u,[t("div",Pu,[e[19]||(e[19]=t("h5",{class:"card-title"},"Организатор",-1)),t("div",Du,[t("div",Tu,[e[18]||(e[18]=t("div",{class:"avatar me-3"},[t("i",{class:"fas fa-user"})],-1)),t("div",null,[t("h6",Mu,r(s.event.organizer.name),1),e[17]||(e[17]=t("small",{class:"text-muted"},"Организатор",-1))])])])])])])])])):(n(),i("div",Iu,[e[21]||(e[21]=t("div",{class:"alert alert-warning"},[t("i",{class:"fas fa-exclamation-triangle me-2"}),c(" Мероприятие не найдено ")],-1)),A(o,{to:"/events",class:"btn btn-primary"},{default:N(()=>e[20]||(e[20]=[c(" Вернуться к списку мероприятий ",-1)])),_:1,__:[20]})]))])])}const Ru=J(Hc,[["render",Au],["__scopeId","data-v-15fc6bfa"]]),Eu={name:"EventCreatePage"},Nu={class:"event-create-page"},Uu={class:"container"},Lu={class:"card"},Vu={class:"card-body"};function Bu(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Nu,[t("div",Uu,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-plus me-2"}),c(" Создать мероприятие ")])],-1)),t("div",Lu,[t("div",Vu,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция создания мероприятий находится в разработке ")],-1)),A(o,{to:"/events",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться к списку мероприятий ",-1)])),_:1,__:[0]})])])])])}const Fu=J(Eu,[["render",Bu],["__scopeId","data-v-d3ea1706"]]),Ou={name:"RewardsPage",setup(){const a=bt(),e=mt(),d=pt(),s=w([]),m=w(!1),u=w("grid"),o=Xt({search:"",type:"",sortBy:"created_at"}),l=k=>({service:"Услуга",prize:"Приз",voucher:"Ваучер",privilege:"Привилегия"})[k]||"Награда",v=async()=>{var k;try{m.value=!0;const V=await ht.rewards.list(o);s.value=((k=V.data)==null?void 0:k.rewards)||V.rewards||[]}catch(V){console.error("Ошибка загрузки наград:",V),e.error("Ошибка загрузки наград")}finally{m.value=!1}},f=()=>{clearTimeout(R),R=setTimeout(()=>{_()},300)},_=()=>{v()},M=k=>{a.push(`/rewards/${k}`)};let R=null;return dt(()=>{v()}),{rewards:s,loading:m,viewMode:u,filters:o,authStore:d,getRewardTypeLabel:l,debounceSearch:f,applyFilters:_,goToReward:M}}},qu={class:"rewards-page"},ju={class:"container"},Hu={class:"page-header mb-4"},zu={class:"row align-items-center"},Zu={class:"col-md-6 text-md-end"},Wu={class:"user-points"},Yu={class:"points-display"},Gu={class:"points-value"},Qu={class:"filters-section mb-4"},Ku={class:"row g-3"},Xu={class:"col-lg-4 col-md-6"},Ju={class:"search-box"},tm={class:"col-lg-3 col-md-6"},em={class:"col-lg-3 col-md-6"},sm={class:"col-lg-2 col-md-6"},am={class:"view-toggles"},om={key:0,class:"text-center py-5"},nm={key:1,class:"text-center py-5"},im={key:2},lm={key:0,class:"rewards-grid"},rm={class:"row g-4"},dm=["onClick"],cm={class:"reward-image"},um=["src","alt"],mm={key:1,class:"reward-placeholder"},vm={class:"reward-content"},fm={class:"reward-title"},gm={class:"reward-description"},pm={class:"reward-meta"},bm={class:"reward-price"},hm={class:"reward-availability"},_m={class:"text-muted"},ym={class:"reward-type"},wm={class:"badge bg-light text-dark"},km={key:1,class:"rewards-list"},Cm=["onClick"],xm={class:"reward-image"},Sm=["src","alt"],$m={key:1,class:"reward-placeholder"},Pm={class:"reward-content"},Dm={class:"reward-title"},Tm={class:"reward-description"},Mm={class:"reward-meta"},Im={class:"reward-price"},Am={class:"reward-availability"},Rm={class:"text-muted"},Em={class:"reward-type"},Nm={class:"badge bg-light text-dark"};function Um(a,e,d,s,m,u){var o;return n(),i("div",qu,[t("div",ju,[t("div",Hu,[t("div",zu,[e[10]||(e[10]=t("div",{class:"col-md-6"},[t("h1",{class:"page-title mb-2"},[t("i",{class:"fas fa-gift me-2"}),c(" Награды ")]),t("p",{class:"page-subtitle text-muted mb-0"}," Обменивайте баллы на ценные призы и привилегии ")],-1)),t("div",Zu,[t("div",Wu,[t("div",Yu,[e[8]||(e[8]=t("i",{class:"fas fa-coins text-warning me-2"},null,-1)),t("span",Gu,r(((o=s.authStore.user)==null?void 0:o.points)||0),1),e[9]||(e[9]=t("span",{class:"points-label"},"баллов",-1))])])])])]),t("div",Qu,[t("div",Ku,[t("div",Xu,[t("div",Ju,[E(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.filters.search=l),type:"text",class:"form-control",placeholder:"Поиск наград...",onInput:e[1]||(e[1]=(...l)=>s.debounceSearch&&s.debounceSearch(...l))},null,544),[[et,s.filters.search]]),e[11]||(e[11]=t("i",{class:"fas fa-search search-icon"},null,-1))])]),t("div",tm,[E(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.filters.type=l),class:"form-select",onChange:e[3]||(e[3]=(...l)=>s.applyFilters&&s.applyFilters(...l))},e[12]||(e[12]=[rt('<option value="" data-v-3dafe967>Все типы</option><option value="service" data-v-3dafe967>Услуги</option><option value="prize" data-v-3dafe967>Призы</option><option value="voucher" data-v-3dafe967>Ваучеры</option><option value="privilege" data-v-3dafe967>Привилегии</option>',5)]),544),[[ot,s.filters.type]])]),t("div",em,[E(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.filters.sortBy=l),class:"form-select",onChange:e[5]||(e[5]=(...l)=>s.applyFilters&&s.applyFilters(...l))},e[13]||(e[13]=[t("option",{value:"created_at"},"По дате",-1),t("option",{value:"points"},"По стоимости",-1),t("option",{value:"title"},"По названию",-1)]),544),[[ot,s.filters.sortBy]])]),t("div",sm,[t("div",am,[t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="grid"}]),onClick:e[6]||(e[6]=l=>s.viewMode="grid")},e[14]||(e[14]=[t("i",{class:"fas fa-th"},null,-1)]),2),t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="list"}]),onClick:e[7]||(e[7]=l=>s.viewMode="list")},e[15]||(e[15]=[t("i",{class:"fas fa-list"},null,-1)]),2)])])])]),s.loading?(n(),i("div",om,e[16]||(e[16]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):s.rewards.length===0?(n(),i("div",nm,e[17]||(e[17]=[t("div",{class:"empty-state"},[t("div",{class:"empty-icon"},[t("i",{class:"fas fa-gift"})]),t("h5",null,"Награды не найдены"),t("p",{class:"text-muted"},"Попробуйте изменить фильтры поиска")],-1)]))):(n(),i("div",im,[s.viewMode==="grid"?(n(),i("div",lm,[t("div",rm,[(n(!0),i(H,null,G(s.rewards,l=>(n(),i("div",{key:l.id,class:"col-lg-4 col-md-6"},[t("div",{class:"reward-card",onClick:v=>s.goToReward(l.id)},[t("div",cm,[l.image?(n(),i("img",{key:0,src:l.image,alt:l.title,class:"img-fluid"},null,8,um)):(n(),i("div",mm,e[18]||(e[18]=[t("i",{class:"fas fa-gift"},null,-1)])))]),t("div",vm,[t("h5",fm,r(l.title),1),t("p",gm,r(l.description),1),t("div",pm,[t("div",bm,[e[19]||(e[19]=t("i",{class:"fas fa-coins text-warning me-1"},null,-1)),c(" "+r(l.pointsCost)+" баллов ",1)]),t("div",hm,[t("small",_m," Осталось: "+r(l.availableQuantity),1)])]),t("div",ym,[t("span",wm,r(s.getRewardTypeLabel(l.type)),1)])])],8,dm)]))),128))])])):(n(),i("div",km,[(n(!0),i(H,null,G(s.rewards,l=>(n(),i("div",{key:l.id,class:"reward-item",onClick:v=>s.goToReward(l.id)},[t("div",xm,[l.image?(n(),i("img",{key:0,src:l.image,alt:l.title,class:"img-fluid"},null,8,Sm)):(n(),i("div",$m,e[20]||(e[20]=[t("i",{class:"fas fa-gift"},null,-1)])))]),t("div",Pm,[t("h5",Dm,r(l.title),1),t("p",Tm,r(l.description),1),t("div",Mm,[t("div",Im,[e[21]||(e[21]=t("i",{class:"fas fa-coins text-warning me-1"},null,-1)),c(" "+r(l.pointsCost)+" баллов ",1)]),t("div",Am,[t("small",Rm," Осталось: "+r(l.availableQuantity),1)]),t("div",Em,[t("span",Nm,r(s.getRewardTypeLabel(l.type)),1)])])])],8,Cm))),128))]))]))])])}const Lm=J(Ou,[["render",Um],["__scopeId","data-v-3dafe967"]]),Vm={name:"RewardDetailPage",setup(){const a=jt(),e=bt(),d=mt(),s=pt(),m=w(null),u=w(!0),o=w(!1),l=j(()=>{var k,V;return(((k=s.user)==null?void 0:k.points)||0)>=(((V=m.value)==null?void 0:V.pointsCost)||0)}),v=k=>({service:"Услуга",prize:"Приз",voucher:"Ваучер",privilege:"Привилегия"})[k]||"Награда",f=k=>({food:"Питание",clothing:"Одежда",work:"Работа",entertainment:"Развлечения"})[k]||"Общее",_=k=>new Date(k).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),M=async()=>{var k;try{u.value=!0;const V=await ht.rewards.get(a.params.id);m.value=((k=V.data)==null?void 0:k.reward)||V.reward}catch(V){console.error("Ошибка загрузки награды:",V),d.error("Ошибка загрузки награды")}finally{u.value=!1}},R=async()=>{try{o.value=!0,await ht.rewards.purchase(a.params.id),d.success("Награда успешно приобретена!"),s.user&&(s.user.points-=m.value.pointsCost),e.push("/profile/purchases")}catch(k){console.error("Ошибка покупки:",k),d.error(k.message||"Ошибка покупки награды")}finally{o.value=!1}};return dt(()=>{M()}),{reward:m,loading:u,purchasing:o,authStore:s,canAfford:l,getRewardTypeLabel:v,getRewardCategoryLabel:f,formatDate:_,purchaseReward:R}}},Bm={class:"reward-detail-page"},Fm={class:"container"},Om={key:0,class:"text-center py-5"},qm={key:1,class:"reward-content"},jm={class:"page-header mb-4"},Hm={class:"row align-items-center"},zm={class:"col-md-8"},Zm={class:"page-title mb-2"},Wm={class:"reward-meta"},Ym={class:"badge bg-success me-2"},Gm={class:"text-muted"},Qm={class:"col-md-4 text-md-end"},Km={class:"reward-price"},Xm={class:"row"},Jm={class:"col-lg-8"},tv={class:"card mb-4"},ev={class:"card-body"},sv={class:"card-text"},av={class:"row mt-4"},ov={class:"col-md-6"},nv={class:"col-md-6"},iv={class:"progress mb-2"},lv={class:"col-lg-4"},rv={class:"card mb-4"},dv={class:"card-body"},cv={class:"user-balance mb-3"},uv={class:"balance-info"},mv={class:"balance-amount"},vv={key:0,class:"purchase-available"},fv=["disabled"],gv={key:0,class:"spinner-border spinner-border-sm me-2"},pv={key:1,class:"purchase-unavailable"},bv={class:"text-muted small"},hv={class:"card"},_v={class:"card-body"},yv={class:"reward-info"},wv={class:"info-item"},kv={class:"info-item"},Cv={key:2,class:"text-center py-5"};function xv(a,e,d,s,m,u){var l,v;const o=Q("router-link");return n(),i("div",Bm,[t("div",Fm,[s.loading?(n(),i("div",Om,e[1]||(e[1]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):s.reward?(n(),i("div",qm,[t("div",jm,[t("div",Hm,[t("div",zm,[t("h1",Zm,r(s.reward.title),1),t("div",Wm,[t("span",Ym,r(s.getRewardTypeLabel(s.reward.type)),1),t("span",Gm,[e[2]||(e[2]=t("i",{class:"fas fa-box me-1"},null,-1)),c(" Осталось: "+r(s.reward.availableQuantity),1)])])]),t("div",Qm,[t("div",Km,[e[3]||(e[3]=t("i",{class:"fas fa-coins text-warning me-1"},null,-1)),c(" "+r(s.reward.pointsCost)+" баллов ",1)])])])]),t("div",Xm,[t("div",Jm,[t("div",tv,[t("div",ev,[e[8]||(e[8]=t("h5",{class:"card-title"},"Описание",-1)),t("p",sv,r(s.reward.description),1),t("div",av,[t("div",ov,[e[5]||(e[5]=t("h6",null,"Тип награды",-1)),t("p",null,[e[4]||(e[4]=t("i",{class:"fas fa-tag me-2"},null,-1)),c(" "+r(s.getRewardTypeLabel(s.reward.type)),1)])]),t("div",nv,[e[7]||(e[7]=t("h6",null,"Доступность",-1)),t("p",null,[e[6]||(e[6]=t("i",{class:"fas fa-boxes me-2"},null,-1)),c(" "+r(s.reward.availableQuantity)+" из "+r(s.reward.quantity),1)]),t("div",iv,[t("div",{class:"progress-bar",style:st({width:s.reward.availableQuantity/s.reward.quantity*100+"%"})},null,4)])])])])])]),t("div",lv,[t("div",rv,[t("div",dv,[e[14]||(e[14]=t("h5",{class:"card-title"},"Покупка",-1)),t("div",cv,[t("div",uv,[t("div",mv,[e[9]||(e[9]=t("i",{class:"fas fa-coins text-warning me-2"},null,-1)),c(" "+r(((l=s.authStore.user)==null?void 0:l.points)||0)+" баллов ",1)]),e[10]||(e[10]=t("div",{class:"balance-label"},"Ваш баланс",-1))])]),s.canAfford?(n(),i("div",vv,[e[11]||(e[11]=t("div",{class:"alert alert-success"},[t("i",{class:"fas fa-check-circle me-2"}),c(" У вас достаточно баллов для покупки ")],-1)),t("button",{class:"btn btn-success w-100",onClick:e[0]||(e[0]=(...f)=>s.purchaseReward&&s.purchaseReward(...f)),disabled:s.purchasing},[s.purchasing?(n(),i("span",gv)):g("",!0),c(" Купить за "+r(s.reward.pointsCost)+" баллов ",1)],8,fv)])):(n(),i("div",pv,[e[13]||(e[13]=t("div",{class:"alert alert-warning"},[t("i",{class:"fas fa-exclamation-triangle me-2"}),c(" Недостаточно баллов ")],-1)),t("p",bv," Необходимо еще "+r(s.reward.pointsCost-(((v=s.authStore.user)==null?void 0:v.points)||0))+" баллов ",1),A(o,{to:"/events",class:"btn btn-primary w-100"},{default:N(()=>e[12]||(e[12]=[c(" Участвовать в мероприятиях ",-1)])),_:1,__:[12]})]))])]),t("div",hv,[t("div",_v,[e[17]||(e[17]=t("h5",{class:"card-title"},"Информация",-1)),t("div",yv,[t("div",wv,[e[15]||(e[15]=t("i",{class:"fas fa-calendar me-2"},null,-1)),t("span",null,"Добавлено: "+r(s.formatDate(s.reward.createdAt)),1)]),t("div",kv,[e[16]||(e[16]=t("i",{class:"fas fa-box me-2"},null,-1)),t("span",null,"Категория: "+r(s.getRewardCategoryLabel(s.reward.category)),1)])])])])])])])):(n(),i("div",Cv,[e[19]||(e[19]=t("div",{class:"alert alert-warning"},[t("i",{class:"fas fa-exclamation-triangle me-2"}),c(" Награда не найдена ")],-1)),A(o,{to:"/rewards",class:"btn btn-primary"},{default:N(()=>e[18]||(e[18]=[c(" Вернуться к списку наград ",-1)])),_:1,__:[18]})]))])])}const Sv=J(Vm,[["render",xv],["__scopeId","data-v-c39f51d5"]]),$v={name:"RewardCreatePage"},Pv={class:"reward-create-page"},Dv={class:"container"},Tv={class:"card"},Mv={class:"card-body"};function Iv(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Pv,[t("div",Dv,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-plus me-2"}),c(" Создать награду ")])],-1)),t("div",Tv,[t("div",Mv,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция создания наград находится в разработке ")],-1)),A(o,{to:"/rewards",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться к списку наград ",-1)])),_:1,__:[0]})])])])])}const Av=J($v,[["render",Iv],["__scopeId","data-v-0546a26a"]]),Rv={name:"ProfileEventsTab",setup(){const a=bt(),e=mt(),d=ut(),s=w(!1),m=w(!1),u=w(null),o=w({status:"",period:""}),l=w({rating:0,comment:""}),v=w([]),f=j(()=>o.value.status||o.value.period),_=j(()=>{let p=[...v.value];if(o.value.status&&(p=p.filter(T=>T.status===o.value.status)),o.value.period){const T=new Date,P=F(o.value.period,T);p=p.filter(z=>new Date(z.date)>=P)}return p.sort((T,P)=>new Date(P.date)-new Date(T.date))}),M=j(()=>{const p={};return _.value.forEach(T=>{const P=V(T.date);p[P]||(p[P]=[]),p[P].push(T)}),p}),R=j(()=>v.value.reduce((p,T)=>p+(T.pointsEarned||0),0)),k=p=>d.formatDate(p,"dd MMM yyyy"),V=p=>d.formatDate(p,"MMMM yyyy"),I=p=>d.formatRelativeDate(p),F=(p,T)=>{switch(p){case"month":return new Date(T.getFullYear(),T.getMonth(),1);case"quarter":const P=Math.floor(T.getMonth()/3);return new Date(T.getFullYear(),P*3,1);case"year":return new Date(T.getFullYear(),0,1);default:return new Date(0)}},$=p=>({conference:"Конференция",training:"Обучение",workshop:"Мастер-класс",meeting:"Собрание",sports:"Спорт",social:"Социальное",volunteer:"Волонтерство",other:"Другое"})[p]||"Мероприятие",x=p=>({attended:"status-success",registered:"status-info",cancelled:"status-warning",missed:"status-danger"})[p]||"status-default",y=p=>({attended:"fas fa-check-circle",registered:"fas fa-clock",cancelled:"fas fa-times-circle",missed:"fas fa-exclamation-triangle"})[p]||"fas fa-question-circle",D=p=>({attended:"Посещено",registered:"Зарегистрирован",cancelled:"Отменено",missed:"Пропущено"})[p]||"Неизвестно",L=p=>{const T=new Date(p.date),P=new Date,z=new Date(T.getTime()-60*60*1e3);return P<z},W=async()=>{try{s.value=!0,await new Promise(p=>setTimeout(p,500)),v.value=[{id:"1",title:"Тренинг по лидерству",description:"Развитие навыков руководства и командной работы",date:new Date(Date.now()-864e5*5),location:"Конференц-зал A",category:"training",status:"attended",pointsEarned:100,certificate:"cert-001.pdf",feedback:{rating:5,comment:"Отличный тренинг! Много полезной информации.",createdAt:new Date(Date.now()-864e5*3)}},{id:"2",title:"Корпоративный хакатон",description:"Командное решение бизнес-задач",date:new Date(Date.now()-864e5*15),location:"IT-центр",category:"workshop",status:"attended",pointsEarned:200,certificate:null,feedback:null},{id:"3",title:"Встреча с руководством",description:"Обсуждение стратегии развития компании",date:new Date(Date.now()+864e5*7),location:"Актовый зал",category:"meeting",status:"registered",pointsEarned:null,certificate:null,feedback:null}]}catch(p){console.error("Ошибка загрузки мероприятий:",p),e.error("Ошибка загрузки списка мероприятий")}finally{s.value=!1}},q=()=>{const p=document.getElementById("participationChart");if(p){const T=p.getContext("2d");T.fillStyle="#e9ecef",T.fillRect(0,0,p.width,p.height),T.fillStyle="#333",T.font="16px Arial",T.textAlign="center",T.fillText("График участия в мероприятиях",p.width/2,p.height/2)}},O=p=>{a.push(`/events/${p}`)},C=p=>{u.value=p,l.value={rating:0,comment:""},new bootstrap.Modal(document.getElementById("feedbackModal")).show()},b=async()=>{if(!(!u.value||!l.value.rating))try{m.value=!0,await new Promise(P=>setTimeout(P,1e3));const p=v.value.findIndex(P=>P.id===u.value.id);p!==-1&&(v.value[p].feedback={...l.value,createdAt:new Date}),e.success("Отзыв успешно отправлен!"),bootstrap.Modal.getInstance(document.getElementById("feedbackModal")).hide()}catch(p){console.error("Ошибка отправки отзыва:",p),e.error("Ошибка отправки отзыва")}finally{m.value=!1}},B=p=>{e.info("Скачивание сертификата...")},at=async p=>{try{const T=v.value.findIndex(P=>P.id===p);T!==-1&&(v.value[T].status="cancelled"),e.success("Регистрация отменена")}catch(T){console.error("Ошибка отмены регистрации:",T),e.error("Ошибка отмены регистрации")}};return Mt(()=>[o.value.status,o.value.period],()=>{}),dt(()=>{W(),setTimeout(q,100)}),{loading:s,feedbackLoading:m,selectedEvent:u,filters:o,feedbackForm:l,events:v,hasActiveFilters:f,filteredEvents:_,groupedEvents:M,totalPointsEarned:R,formatDate:k,formatRelativeTime:I,getCategoryLabel:$,getEventStatusClass:x,getStatusIcon:y,getStatusLabel:D,canCancel:L,viewEvent:O,leaveFeedback:C,submitFeedback:b,downloadCertificate:B,cancelRegistration:at}}},Ev={class:"profile-events-tab"},Nv={class:"events-filters mb-4"},Uv={class:"row g-3 align-items-center"},Lv={class:"col-md-6"},Vv={class:"events-stats"},Bv={class:"stat-item"},Fv={class:"stat-number"},Ov={class:"stat-item"},qv={class:"stat-number"},jv={class:"stat-item"},Hv={class:"stat-number"},zv={class:"col-md-6"},Zv={class:"d-flex gap-2"},Wv={class:"events-list"},Yv={key:0,class:"loading-state text-center py-4"},Gv={key:1,class:"empty-state text-center py-5"},Qv={class:"text-muted"},Kv={key:2,class:"events-timeline"},Xv={class:"timeline-month"},Jv={class:"month-title"},tf={class:"month-stats"},ef={class:"timeline-events"},sf={class:"event-card"},af={class:"event-header"},of={class:"event-info"},nf={class:"event-title"},lf={class:"event-meta"},rf={class:"event-date"},df={key:0,class:"event-location"},cf={class:"event-category"},uf={class:"event-status"},mf={key:0,class:"event-description"},vf={class:"event-details"},ff={class:"row g-3"},gf={key:0,class:"col-auto"},pf={class:"detail-item points-earned"},bf={key:1,class:"col-auto"},hf={key:2,class:"col-auto"},_f={class:"detail-item feedback"},yf={class:"event-actions"},wf=["onClick"],kf=["onClick"],Cf=["onClick"],xf=["onClick"],Sf={key:1,class:"event-feedback"},$f={class:"feedback-header"},Pf={class:"feedback-rating"},Df={class:"rating-stars"},Tf={class:"feedback-date"},Mf={key:0,class:"feedback-comment"},If={id:"feedbackModal",class:"modal fade",tabindex:"-1","aria-labelledby":"feedbackModalLabel","aria-hidden":"true"},Af={class:"modal-dialog"},Rf={class:"modal-content"},Ef={class:"modal-body"},Nf={key:0,class:"mb-3"},Uf={class:"text-muted small"},Lf={class:"mb-3"},Vf={class:"rating-input"},Bf=["onClick"],Ff={class:"mb-3"},Of={class:"modal-footer"},qf=["disabled"],jf={key:0,class:"spinner-border spinner-border-sm me-2"};function Hf(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Ev,[t("div",Nv,[t("div",Uv,[t("div",Lv,[t("div",Vv,[t("div",Bv,[t("span",Fv,r(s.events.filter(l=>l.status==="attended").length),1),e[4]||(e[4]=t("span",{class:"stat-label"},"Посещено",-1))]),t("div",Ov,[t("span",qv,r(s.events.filter(l=>l.status==="registered").length),1),e[5]||(e[5]=t("span",{class:"stat-label"},"Зарегистрировано",-1))]),t("div",jv,[t("span",Hv,r(s.totalPointsEarned),1),e[6]||(e[6]=t("span",{class:"stat-label"},"Баллов заработано",-1))])])]),t("div",zv,[t("div",Zv,[E(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.filters.status=l),class:"form-select"},e[7]||(e[7]=[rt('<option value="" data-v-4458d78c>Все статусы</option><option value="attended" data-v-4458d78c>Посещенные</option><option value="registered" data-v-4458d78c>Зарегистрированные</option><option value="cancelled" data-v-4458d78c>Отмененные</option><option value="missed" data-v-4458d78c>Пропущенные</option>',5)]),512),[[ot,s.filters.status]]),E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.filters.period=l),class:"form-select"},e[8]||(e[8]=[t("option",{value:""},"Все время",-1),t("option",{value:"month"},"Этот месяц",-1),t("option",{value:"quarter"},"Этот квартал",-1),t("option",{value:"year"},"Этот год",-1)]),512),[[ot,s.filters.period]])])])])]),e[31]||(e[31]=rt('<div class="participation-chart mb-4" data-v-4458d78c><div class="chart-card" data-v-4458d78c><div class="chart-header" data-v-4458d78c><h5 class="chart-title" data-v-4458d78c><i class="fas fa-chart-bar me-2" data-v-4458d78c></i> Участие в мероприятиях по месяцам </h5></div><div class="chart-body" data-v-4458d78c><canvas id="participationChart" width="400" height="200" data-v-4458d78c></canvas></div></div></div>',1)),t("div",Wv,[s.loading?(n(),i("div",Yv,e[9]||(e[9]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1),t("p",{class:"mt-2 text-muted"},"Загрузка мероприятий...",-1)]))):s.filteredEvents.length===0?(n(),i("div",Gv,[e[11]||(e[11]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fas fa-calendar-times"})],-1)),e[12]||(e[12]=t("h5",null,"Мероприятия не найдены",-1)),t("p",Qv,r(s.hasActiveFilters?"Попробуйте изменить фильтры":"Вы еще не участвовали в мероприятиях"),1),A(o,{to:"/events",class:"btn btn-primary"},{default:N(()=>e[10]||(e[10]=[c(" Найти мероприятия ",-1)])),_:1,__:[10]})])):(n(),i("div",Kv,[(n(!0),i(H,null,G(s.groupedEvents,(l,v)=>(n(),i("div",{key:v,class:"timeline-group"},[t("div",Xv,[t("h6",Jv,r(v),1),t("span",tf,r(l.length)+" мероприятий, "+r(l.reduce((f,_)=>f+(_.pointsEarned||0),0))+" баллов ",1)]),t("div",ef,[(n(!0),i(H,null,G(l,f=>(n(),i("div",{key:f.id,class:h(["timeline-event",s.getEventStatusClass(f.status)])},[e[24]||(e[24]=t("div",{class:"event-marker"},null,-1)),t("div",sf,[t("div",af,[t("div",of,[t("h6",nf,r(f.title),1),t("div",lf,[t("span",rf,[e[13]||(e[13]=t("i",{class:"fas fa-calendar me-1"},null,-1)),c(" "+r(s.formatDate(f.date)),1)]),f.location?(n(),i("span",df,[e[14]||(e[14]=t("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),c(" "+r(f.location),1)])):g("",!0),t("span",cf,[e[15]||(e[15]=t("i",{class:"fas fa-tag me-1"},null,-1)),c(" "+r(s.getCategoryLabel(f.category)),1)])])]),t("div",uf,[t("span",{class:h(["status-badge",s.getEventStatusClass(f.status)])},[t("i",{class:h(s.getStatusIcon(f.status))},null,2),c(" "+r(s.getStatusLabel(f.status)),1)],2)])]),f.description?(n(),i("div",mf,r(f.description),1)):g("",!0),t("div",vf,[t("div",ff,[f.pointsEarned?(n(),i("div",gf,[t("div",pf,[e[16]||(e[16]=t("i",{class:"fas fa-coins"},null,-1)),t("span",null,"+"+r(f.pointsEarned)+" баллов",1)])])):g("",!0),f.certificate?(n(),i("div",bf,e[17]||(e[17]=[t("div",{class:"detail-item certificate"},[t("i",{class:"fas fa-certificate"}),t("span",null,"Сертификат получен")],-1)]))):g("",!0),f.feedback?(n(),i("div",hf,[t("div",_f,[e[18]||(e[18]=t("i",{class:"fas fa-star"},null,-1)),t("span",null,"Оценка: "+r(f.feedback.rating)+"/5",1)])])):g("",!0)])]),t("div",yf,[t("button",{class:"btn btn-sm btn-outline-primary",onClick:_=>s.viewEvent(f.id)},e[19]||(e[19]=[t("i",{class:"fas fa-eye me-1"},null,-1),c(" Подробнее ",-1)]),8,wf),f.status==="attended"&&!f.feedback?(n(),i("button",{key:0,class:"btn btn-sm btn-outline-success",onClick:_=>s.leaveFeedback(f)},e[20]||(e[20]=[t("i",{class:"fas fa-comment me-1"},null,-1),c(" Оставить отзыв ",-1)]),8,kf)):g("",!0),f.certificate?(n(),i("button",{key:1,class:"btn btn-sm btn-outline-info",onClick:_=>s.downloadCertificate(f.certificate)},e[21]||(e[21]=[t("i",{class:"fas fa-download me-1"},null,-1),c(" Скачать сертификат ",-1)]),8,Cf)):g("",!0),f.status==="registered"&&s.canCancel(f)?(n(),i("button",{key:2,class:"btn btn-sm btn-outline-danger",onClick:_=>s.cancelRegistration(f.id)},e[22]||(e[22]=[t("i",{class:"fas fa-times me-1"},null,-1),c(" Отменить ",-1)]),8,xf)):g("",!0)]),f.feedback?(n(),i("div",Sf,[t("div",$f,[t("div",Pf,[e[23]||(e[23]=t("span",{class:"rating-label"},"Ваша оценка:",-1)),t("div",Df,[(n(),i(H,null,G(5,_=>t("i",{key:_,class:h(["fas fa-star",{active:_<=f.feedback.rating}])},null,2)),64))])]),t("span",Tf,r(s.formatRelativeTime(f.feedback.createdAt)),1)]),f.feedback.comment?(n(),i("div",Mf,' "'+r(f.feedback.comment)+'" ',1)):g("",!0)])):g("",!0)])],2))),128))])]))),128))]))]),t("div",If,[t("div",Af,[t("div",Rf,[e[30]||(e[30]=t("div",{class:"modal-header"},[t("h5",{id:"feedbackModalLabel",class:"modal-title"}," Оценить мероприятие "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("form",{onSubmit:e[3]||(e[3]=lt((...l)=>s.submitFeedback&&s.submitFeedback(...l),["prevent"]))},[t("div",Ef,[s.selectedEvent?(n(),i("div",Nf,[t("h6",null,r(s.selectedEvent.title),1),t("p",Uf,r(s.formatDate(s.selectedEvent.date)),1)])):g("",!0),t("div",Lf,[e[26]||(e[26]=t("label",{class:"form-label"},"Оценка",-1)),t("div",Vf,[(n(),i(H,null,G(5,l=>t("button",{key:l,type:"button",class:h(["star-btn",{active:l<=s.feedbackForm.rating}]),onClick:v=>s.feedbackForm.rating=l},e[25]||(e[25]=[t("i",{class:"fas fa-star"},null,-1)]),10,Bf)),64))])]),t("div",Ff,[e[27]||(e[27]=t("label",{for:"feedbackComment",class:"form-label"},"Комментарий (необязательно)",-1)),E(t("textarea",{id:"feedbackComment","onUpdate:modelValue":e[2]||(e[2]=l=>s.feedbackForm.comment=l),class:"form-control",rows:"4",placeholder:"Поделитесь впечатлениями о мероприятии..."},null,512),[[et,s.feedbackForm.comment]])])]),t("div",Of,[e[29]||(e[29]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Отмена ",-1)),t("button",{type:"submit",class:"btn btn-primary",disabled:!s.feedbackForm.rating||s.feedbackLoading},[s.feedbackLoading?(n(),i("span",jf)):g("",!0),e[28]||(e[28]=c(" Отправить отзыв ",-1))],8,qf)])],32)])])])])}const zf=J(Rv,[["render",Hf],["__scopeId","data-v-4458d78c"]]),Zf={name:"ProfilePurchasesTab",setup(){bt();const a=mt(),e=ut(),d=w(!1),s=w(!1),m=w(null),u=w({category:"",status:"",period:"",sortBy:"date_desc"}),o=w({rating:0,comment:""}),l=w([]),v=w({totalPurchases:0,totalSpent:0,totalSaved:0,averageRating:0}),f=j(()=>u.value.category||u.value.status||u.value.period),_=j(()=>{let P=[...l.value];if(u.value.category&&(P=P.filter(z=>z.reward.category===u.value.category)),u.value.status&&(P=P.filter(z=>z.status===u.value.status)),u.value.period){const z=new Date,it=I(u.value.period,z);P=P.filter(kt=>new Date(kt.createdAt)>=it)}return P.sort((z,it)=>{switch(u.value.sortBy){case"date_asc":return new Date(z.createdAt)-new Date(it.createdAt);case"cost_desc":return it.pointsUsed-z.pointsUsed;case"cost_asc":return z.pointsUsed-it.pointsUsed;default:return new Date(it.createdAt)-new Date(z.createdAt)}}),P}),M=P=>e.formatNumber(P),R=P=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(P),k=P=>e.formatDate(P,"dd MMM yyyy"),V=P=>e.formatRelativeDate(P),I=(P,z)=>{switch(P){case"month":return new Date(z.getFullYear(),z.getMonth(),1);case"quarter":const it=Math.floor(z.getMonth()/3);return new Date(z.getFullYear(),it*3,1);case"year":return new Date(z.getFullYear(),0,1);default:return new Date(0)}},F=P=>({service:"fas fa-concierge-bell",prize:"fas fa-trophy",voucher:"fas fa-ticket-alt",privilege:"fas fa-crown"})[P]||"fas fa-gift",$=P=>({service:"Услуга",prize:"Приз",voucher:"Ваучер",privilege:"Привилегия"})[P]||"Награда",x=P=>({completed:"status-success",pending:"status-warning",used:"status-info",expired:"status-danger"})[P]||"status-default",y=P=>({completed:"fas fa-check-circle",pending:"fas fa-clock",used:"fas fa-check-double",expired:"fas fa-times-circle"})[P]||"fas fa-question-circle",D=P=>({completed:"Завершено",pending:"В обработке",used:"Использовано",expired:"Просрочено"})[P]||"Неизвестно",L=P=>P.status==="completed"&&(!P.validUntil||new Date(P.validUntil)>new Date),W=P=>{if(!P)return!1;const z=new Date,it=new Date(P),kt=Math.ceil((it-z)/(1e3*60*60*24));return kt<=7&&kt>0},q=async()=>{try{d.value=!0,await new Promise(P=>setTimeout(P,500)),l.value=[{id:"1",reward:{name:"Бесплатный обед в кафетерии",category:"service",image:null},pointsUsed:50,originalPrice:500,savings:500,status:"used",code:"LUNCH2024",validUntil:null,createdAt:new Date(Date.now()-864e5*5),downloadUrl:null,feedback:{rating:5,comment:"Отличный обед!",createdAt:new Date(Date.now()-864e5*3)}},{id:"2",reward:{name:"Корпоративная футболка",category:"prize",image:null},pointsUsed:200,originalPrice:2e3,savings:2e3,status:"completed",code:null,validUntil:null,createdAt:new Date(Date.now()-864e5*15),downloadUrl:null,feedback:null},{id:"3",reward:{name:"День удаленной работы",category:"privilege",image:null},pointsUsed:300,originalPrice:null,savings:0,status:"completed",code:"REMOTE001",validUntil:new Date(Date.now()+864e5*30),createdAt:new Date(Date.now()-864e5*2),downloadUrl:null,feedback:null}],v.value={totalPurchases:l.value.length,totalSpent:l.value.reduce((P,z)=>P+z.pointsUsed,0),totalSaved:l.value.reduce((P,z)=>P+z.savings,0),averageRating:4.5}}catch(P){console.error("Ошибка загрузки покупок:",P),a.error("Ошибка загрузки истории покупок")}finally{d.value=!1}},O=()=>{const P=document.getElementById("purchasesChart");if(P){const z=P.getContext("2d");z.fillStyle="#e9ecef",z.fillRect(0,0,P.width,P.height),z.fillStyle="#333",z.font="16px Arial",z.textAlign="center",z.fillText("График покупок по месяцам",P.width/2,P.height/2)}},C=async P=>{try{await navigator.clipboard.writeText(P),a.success("Код скопирован в буфер обмена")}catch{a.error("Ошибка копирования кода")}},b=async P=>{try{const z=l.value.findIndex(it=>it.id===P.id);z!==-1&&(l.value[z].status="used"),a.success("Покупка успешно использована")}catch(z){console.error("Ошибка использования покупки:",z),a.error("Ошибка использования покупки")}},B=P=>{a.info("Скачивание начато...")},at=P=>{m.value=P,o.value={rating:0,comment:""},new bootstrap.Modal(document.getElementById("feedbackModal")).show()},p=async()=>{if(!(!m.value||!o.value.rating))try{s.value=!0,await new Promise(it=>setTimeout(it,1e3));const P=l.value.findIndex(it=>it.id===m.value.id);P!==-1&&(l.value[P].feedback={...o.value,createdAt:new Date}),a.success("Отзыв успешно отправлен!"),bootstrap.Modal.getInstance(document.getElementById("feedbackModal")).hide()}catch(P){console.error("Ошибка отправки отзыва:",P),a.error("Ошибка отправки отзыва")}finally{s.value=!1}},T=P=>{m.value=P,new bootstrap.Modal(document.getElementById("purchaseDetailsModal")).show()};return Mt(()=>[u.value.category,u.value.status,u.value.period,u.value.sortBy],()=>{}),dt(()=>{q(),setTimeout(O,100)}),{loading:d,feedbackLoading:s,selectedPurchase:m,filters:u,feedbackForm:o,purchases:l,purchaseStats:v,hasActiveFilters:f,filteredPurchases:_,formatNumber:M,formatCurrency:R,formatDate:k,formatRelativeTime:V,getCategoryIcon:F,getCategoryLabel:$,getPurchaseStatusClass:x,getStatusIcon:y,getStatusLabel:D,canUse:L,isExpiringSoon:W,copyCode:C,usePurchase:b,downloadItem:B,leaveFeedback:at,submitFeedback:p,viewPurchaseDetails:T}}},Wf={class:"profile-purchases-tab"},Yf={class:"purchases-stats mb-4"},Gf={class:"row g-3"},Qf={class:"col-lg-3 col-md-6"},Kf={class:"stat-card"},Xf={class:"stat-content"},Jf={class:"stat-value"},t1={class:"col-lg-3 col-md-6"},e1={class:"stat-card"},s1={class:"stat-content"},a1={class:"stat-value"},o1={class:"col-lg-3 col-md-6"},n1={class:"stat-card"},i1={class:"stat-content"},l1={class:"stat-value"},r1={class:"col-lg-3 col-md-6"},d1={class:"stat-card"},c1={class:"stat-content"},u1={class:"stat-value"},m1={class:"purchases-filters mb-4"},v1={class:"row g-3 align-items-center"},f1={class:"col-md-3"},g1={class:"col-md-3"},p1={class:"col-md-3"},b1={class:"col-md-3"},h1={class:"purchases-list"},_1={key:0,class:"loading-state text-center py-4"},y1={key:1,class:"empty-state text-center py-5"},w1={class:"text-muted"},k1={key:2,class:"purchases-grid"},C1={class:"purchase-image"},x1=["src","alt"],S1={key:1,class:"purchase-placeholder"},$1={class:"purchase-status"},P1={class:"purchase-info"},D1={class:"purchase-header"},T1={class:"purchase-title"},M1={class:"purchase-category"},I1={class:"purchase-details"},A1={class:"purchase-date"},R1={class:"purchase-cost"},E1={key:0,class:"purchase-savings"},N1={key:0,class:"purchase-extra"},U1={key:0,class:"purchase-code"},L1={class:"code-display"},V1=["onClick"],B1={key:1,class:"purchase-validity"},F1={key:0,class:"badge bg-warning ms-2"},O1={class:"purchase-actions"},q1=["onClick"],j1=["onClick"],H1=["onClick"],z1=["onClick"],Z1={key:1,class:"purchase-feedback"},W1={class:"feedback-header"},Y1={class:"feedback-rating"},G1={class:"rating-stars"},Q1={class:"feedback-date"},K1={key:0,class:"feedback-comment"},X1={id:"purchaseDetailsModal",class:"modal fade",tabindex:"-1","aria-labelledby":"purchaseDetailsModalLabel","aria-hidden":"true"},J1={class:"modal-dialog modal-lg"},tg={class:"modal-content"},eg={class:"modal-body"},sg={key:0,class:"purchase-details-content"},ag={id:"feedbackModal",class:"modal fade",tabindex:"-1","aria-labelledby":"feedbackModalLabel","aria-hidden":"true"},og={class:"modal-dialog"},ng={class:"modal-content"},ig={class:"modal-body"},lg={key:0,class:"mb-3"},rg={class:"text-muted small"},dg={class:"mb-3"},cg={class:"rating-input"},ug=["onClick"],mg={class:"mb-3"},vg={class:"modal-footer"},fg=["disabled"],gg={key:0,class:"spinner-border spinner-border-sm me-2"};function pg(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Wf,[t("div",Yf,[t("div",Gf,[t("div",Qf,[t("div",Kf,[e[7]||(e[7]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-shopping-bag"})],-1)),t("div",Xf,[t("h3",Jf,r(s.purchaseStats.totalPurchases),1),e[6]||(e[6]=t("p",{class:"stat-label"},"Всего покупок",-1))])])]),t("div",t1,[t("div",e1,[e[9]||(e[9]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-coins"})],-1)),t("div",s1,[t("h3",a1,r(s.formatNumber(s.purchaseStats.totalSpent)),1),e[8]||(e[8]=t("p",{class:"stat-label"},"Баллов потрачено",-1))])])]),t("div",o1,[t("div",n1,[e[11]||(e[11]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-ruble-sign"})],-1)),t("div",i1,[t("h3",l1,r(s.formatCurrency(s.purchaseStats.totalSaved)),1),e[10]||(e[10]=t("p",{class:"stat-label"},"Сэкономлено",-1))])])]),t("div",r1,[t("div",d1,[e[13]||(e[13]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-star"})],-1)),t("div",c1,[t("h3",u1,r(s.purchaseStats.averageRating),1),e[12]||(e[12]=t("p",{class:"stat-label"},"Средняя оценка",-1))])])])])]),t("div",m1,[t("div",v1,[t("div",f1,[E(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.filters.category=l),class:"form-select"},e[14]||(e[14]=[rt('<option value="" data-v-c04f17ef>Все категории</option><option value="service" data-v-c04f17ef>Услуги</option><option value="prize" data-v-c04f17ef>Призы</option><option value="voucher" data-v-c04f17ef>Ваучеры</option><option value="privilege" data-v-c04f17ef>Привилегии</option>',5)]),512),[[ot,s.filters.category]])]),t("div",g1,[E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.filters.status=l),class:"form-select"},e[15]||(e[15]=[rt('<option value="" data-v-c04f17ef>Все статусы</option><option value="completed" data-v-c04f17ef>Завершено</option><option value="pending" data-v-c04f17ef>В обработке</option><option value="used" data-v-c04f17ef>Использовано</option><option value="expired" data-v-c04f17ef>Просрочено</option>',5)]),512),[[ot,s.filters.status]])]),t("div",p1,[E(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.filters.period=l),class:"form-select"},e[16]||(e[16]=[t("option",{value:""},"Все время",-1),t("option",{value:"month"},"Этот месяц",-1),t("option",{value:"quarter"},"Этот квартал",-1),t("option",{value:"year"},"Этот год",-1)]),512),[[ot,s.filters.period]])]),t("div",b1,[E(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.filters.sortBy=l),class:"form-select"},e[17]||(e[17]=[t("option",{value:"date_desc"},"По дате (новые)",-1),t("option",{value:"date_asc"},"По дате (старые)",-1),t("option",{value:"cost_desc"},"По стоимости (дорогие)",-1),t("option",{value:"cost_asc"},"По стоимости (дешевые)",-1)]),512),[[ot,s.filters.sortBy]])])])]),e[40]||(e[40]=rt('<div class="purchases-chart mb-4" data-v-c04f17ef><div class="chart-card" data-v-c04f17ef><div class="chart-header" data-v-c04f17ef><h5 class="chart-title" data-v-c04f17ef><i class="fas fa-chart-area me-2" data-v-c04f17ef></i> Покупки по месяцам </h5></div><div class="chart-body" data-v-c04f17ef><canvas id="purchasesChart" width="400" height="200" data-v-c04f17ef></canvas></div></div></div>',1)),t("div",h1,[s.loading?(n(),i("div",_1,e[18]||(e[18]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1),t("p",{class:"mt-2 text-muted"},"Загрузка покупок...",-1)]))):s.filteredPurchases.length===0?(n(),i("div",y1,[e[20]||(e[20]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fas fa-shopping-cart"})],-1)),e[21]||(e[21]=t("h5",null,"Покупки не найдены",-1)),t("p",w1,r(s.hasActiveFilters?"Попробуйте изменить фильтры":"Вы еще не совершали покупок"),1),A(o,{to:"/rewards",class:"btn btn-primary"},{default:N(()=>e[19]||(e[19]=[c(" Посмотреть каталог ",-1)])),_:1,__:[19]})])):(n(),i("div",k1,[(n(!0),i(H,null,G(s.filteredPurchases,l=>(n(),i("div",{key:l.id,class:h(["purchase-card",s.getPurchaseStatusClass(l.status)])},[t("div",C1,[l.reward.image?(n(),i("img",{key:0,src:l.reward.image,alt:l.reward.name,class:"img-fluid"},null,8,x1)):(n(),i("div",S1,[t("i",{class:h(s.getCategoryIcon(l.reward.category))},null,2)])),t("div",$1,[t("span",{class:h(["status-badge",s.getPurchaseStatusClass(l.status)])},[t("i",{class:h(s.getStatusIcon(l.status))},null,2),c(" "+r(s.getStatusLabel(l.status)),1)],2)])]),t("div",P1,[t("div",D1,[t("h6",T1,r(l.reward.name),1),t("div",M1,r(s.getCategoryLabel(l.reward.category)),1)]),t("div",I1,[t("div",A1,[e[22]||(e[22]=t("i",{class:"fas fa-calendar me-1"},null,-1)),c(" "+r(s.formatDate(l.createdAt)),1)]),t("div",R1,[e[23]||(e[23]=t("i",{class:"fas fa-coins me-1"},null,-1)),c(" "+r(s.formatNumber(l.pointsUsed))+" баллов ",1)]),l.originalPrice?(n(),i("div",E1,[e[24]||(e[24]=t("i",{class:"fas fa-piggy-bank me-1"},null,-1)),c(" Сэкономлено: "+r(s.formatCurrency(l.savings)),1)])):g("",!0)]),l.code||l.validUntil?(n(),i("div",N1,[l.code?(n(),i("div",U1,[e[26]||(e[26]=t("label",null,"Код активации:",-1)),t("div",L1,[t("code",null,r(l.code),1),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v=>s.copyCode(l.code)},e[25]||(e[25]=[t("i",{class:"fas fa-copy"},null,-1)]),8,V1)])])):g("",!0),l.validUntil?(n(),i("div",B1,[e[27]||(e[27]=t("i",{class:"fas fa-clock me-1"},null,-1)),c(" Действительно до: "+r(s.formatDate(l.validUntil))+" ",1),s.isExpiringSoon(l.validUntil)?(n(),i("span",F1," Скоро истекает ")):g("",!0)])):g("",!0)])):g("",!0),t("div",O1,[l.status==="completed"&&s.canUse(l)?(n(),i("button",{key:0,class:"btn btn-sm btn-success",onClick:v=>s.usePurchase(l)},e[28]||(e[28]=[t("i",{class:"fas fa-check me-1"},null,-1),c(" Использовать ",-1)]),8,q1)):g("",!0),l.downloadUrl?(n(),i("button",{key:1,class:"btn btn-sm btn-outline-primary",onClick:v=>s.downloadItem(l.downloadUrl)},e[29]||(e[29]=[t("i",{class:"fas fa-download me-1"},null,-1),c(" Скачать ",-1)]),8,j1)):g("",!0),l.status==="completed"&&!l.feedback?(n(),i("button",{key:2,class:"btn btn-sm btn-outline-info",onClick:v=>s.leaveFeedback(l)},e[30]||(e[30]=[t("i",{class:"fas fa-star me-1"},null,-1),c(" Оценить ",-1)]),8,H1)):g("",!0),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v=>s.viewPurchaseDetails(l)},e[31]||(e[31]=[t("i",{class:"fas fa-eye me-1"},null,-1),c(" Подробнее ",-1)]),8,z1)]),l.feedback?(n(),i("div",Z1,[t("div",W1,[t("div",Y1,[e[32]||(e[32]=t("span",{class:"rating-label"},"Ваша оценка:",-1)),t("div",G1,[(n(),i(H,null,G(5,v=>t("i",{key:v,class:h(["fas fa-star",{active:v<=l.feedback.rating}])},null,2)),64))])]),t("span",Q1,r(s.formatRelativeTime(l.feedback.createdAt)),1)]),l.feedback.comment?(n(),i("div",K1,' "'+r(l.feedback.comment)+'" ',1)):g("",!0)])):g("",!0)])],2))),128))]))]),t("div",X1,[t("div",J1,[t("div",tg,[e[33]||(e[33]=t("div",{class:"modal-header"},[t("h5",{id:"purchaseDetailsModalLabel",class:"modal-title"}," Детали покупки "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("div",eg,[s.selectedPurchase?(n(),i("div",sg)):g("",!0)])])])]),t("div",ag,[t("div",og,[t("div",ng,[e[39]||(e[39]=t("div",{class:"modal-header"},[t("h5",{id:"feedbackModalLabel",class:"modal-title"}," Оценить покупку "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("form",{onSubmit:e[5]||(e[5]=lt((...l)=>s.submitFeedback&&s.submitFeedback(...l),["prevent"]))},[t("div",ig,[s.selectedPurchase?(n(),i("div",lg,[t("h6",null,r(s.selectedPurchase.reward.name),1),t("p",rg,r(s.formatDate(s.selectedPurchase.createdAt)),1)])):g("",!0),t("div",dg,[e[35]||(e[35]=t("label",{class:"form-label"},"Оценка",-1)),t("div",cg,[(n(),i(H,null,G(5,l=>t("button",{key:l,type:"button",class:h(["star-btn",{active:l<=s.feedbackForm.rating}]),onClick:v=>s.feedbackForm.rating=l},e[34]||(e[34]=[t("i",{class:"fas fa-star"},null,-1)]),10,ug)),64))])]),t("div",mg,[e[36]||(e[36]=t("label",{for:"feedbackComment",class:"form-label"},"Комментарий (необязательно)",-1)),E(t("textarea",{id:"feedbackComment","onUpdate:modelValue":e[4]||(e[4]=l=>s.feedbackForm.comment=l),class:"form-control",rows:"4",placeholder:"Поделитесь впечатлениями о покупке..."},null,512),[[et,s.feedbackForm.comment]])])]),t("div",vg,[e[38]||(e[38]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Отмена ",-1)),t("button",{type:"submit",class:"btn btn-primary",disabled:!s.feedbackForm.rating||s.feedbackLoading},[s.feedbackLoading?(n(),i("span",gg)):g("",!0),e[37]||(e[37]=c(" Отправить отзыв ",-1))],8,fg)])],32)])])])])}const bg=J(Zf,[["render",pg],["__scopeId","data-v-c04f17ef"]]),hg={name:"ProfilePointsTab",setup(){const a=mt(),e=ut(),d=pt(),s=w(!1),m=w("month"),u=w({type:"",source:"",period:""}),o=w({currentPage:1,totalPages:1,perPage:20}),l=w([]),v=w({totalEarned:0,totalSpent:0,thisMonth:0,avgPerEvent:0}),f=w([{value:"week",label:"Неделя"},{value:"month",label:"Месяц"},{value:"quarter",label:"Квартал"},{value:"year",label:"Год"}]),_=j(()=>{var U;return((U=d.user)==null?void 0:U.points)||0}),M=j(()=>{const U=v.value.thisMonth;return U>0?"fas fa-arrow-up text-success":U<0?"fas fa-arrow-down text-danger":"fas fa-minus text-muted"}),R=j(()=>{const U=v.value.thisMonth;return U>0?`+${x(U)} за месяц`:U<0?`${x(U)} за месяц`:"Нет изменений за месяц"}),k=j(()=>u.value.type||u.value.source||u.value.period),V=j(()=>{let U=[...l.value];if(u.value.type&&(U=U.filter(S=>S.type===u.value.type)),u.value.source&&(U=U.filter(S=>S.source===u.value.source)),u.value.period){const S=new Date,Z=W(u.value.period,S);U=U.filter(X=>new Date(X.createdAt)>=Z)}return U.sort((S,Z)=>new Date(Z.createdAt)-new Date(S.createdAt))}),I=j(()=>{const U={};return V.value.forEach(S=>{const Z=D(S.createdAt);U[Z]||(U[Z]=[]),U[Z].push(S)}),U}),F=j(()=>V.value.reduce((U,S)=>U+(S.type==="earned"?S.points:-S.points),0)),$=j(()=>{const U=o.value.currentPage,S=o.value.totalPages,Z=2,X=[],_t=[];for(let gt=Math.max(2,U-Z);gt<=Math.min(S-1,U+Z);gt++)X.push(gt);return U-Z>2?_t.push(1,"..."):_t.push(1),_t.push(...X),U+Z<S-1?_t.push("...",S):_t.push(S),_t.filter(gt=>gt!==1||S>1)}),x=U=>e.formatNumber(U),y=U=>e.formatDate(U,"dd MMM yyyy"),D=U=>e.formatDate(U,"dd MMMM yyyy"),L=U=>e.formatDate(U,"HH:mm"),W=(U,S)=>{switch(U){case"today":return new Date(S.getFullYear(),S.getMonth(),S.getDate());case"week":const Z=new Date(S);return Z.setDate(S.getDate()-S.getDay()),Z;case"month":return new Date(S.getFullYear(),S.getMonth(),1);case"quarter":const X=Math.floor(S.getMonth()/3);return new Date(S.getFullYear(),X*3,1);case"year":return new Date(S.getFullYear(),0,1);default:return new Date(0)}},q=U=>({event_attendance:"Посещение мероприятия",event_registration:"Регистрация на мероприятие",purchase:"Покупка",bonus:"Бонус",refund:"Возврат"})[U]||"Неизвестно",O=U=>U==="earned"?"transaction-earned":"transaction-spent",C=U=>U==="earned"?"fas fa-plus":"fas fa-minus",b=U=>U==="earned"?"amount-positive":"amount-negative",B=U=>{const S=U.reduce((Z,X)=>Z+(X.type==="earned"?X.points:-X.points),0);return S>0?"text-success":S<0?"text-danger":"text-muted"},at=U=>{const S=U.reduce((Z,X)=>Z+(X.type==="earned"?X.points:-X.points),0);return S>0?`+${x(S)} баллов`:S<0?`${x(S)} баллов`:"0 баллов"},p=async()=>{try{s.value=!0,await new Promise(U=>setTimeout(U,500)),l.value=[{id:"1",type:"earned",points:100,description:"Участие в тренинге по лидерству",source:"event_attendance",balanceBefore:450,balanceAfter:550,multiplier:1,createdAt:new Date(Date.now()-864e5),relatedEvent:{title:"Тренинг по лидерству"},canRefund:!1},{id:"2",type:"spent",points:50,description:"Покупка обеда в кафетерии",source:"purchase",balanceBefore:550,balanceAfter:500,createdAt:new Date(Date.now()-864e5*2),canRefund:!0},{id:"3",type:"earned",points:200,description:"Участие в корпоративном хакатоне",source:"event_attendance",balanceBefore:350,balanceAfter:550,multiplier:2,createdAt:new Date(Date.now()-864e5*7),relatedEvent:{title:"Корпоративный хакатон"},canRefund:!1},{id:"4",type:"earned",points:50,description:"Бонус за активность",source:"bonus",balanceBefore:300,balanceAfter:350,createdAt:new Date(Date.now()-864e5*10),canRefund:!1}],v.value={totalEarned:2500,totalSpent:800,thisMonth:350,avgPerEvent:125}}catch(U){console.error("Ошибка загрузки истории баллов:",U),a.error("Ошибка загрузки истории баллов")}finally{s.value=!1}},T=()=>{const U=document.getElementById("pointsChart");if(U){const S=U.getContext("2d");S.fillStyle="#e9ecef",S.fillRect(0,0,U.width,U.height),S.fillStyle="#333",S.font="16px Arial",S.textAlign="center",S.fillText("График изменения баланса баллов",U.width/2,U.height/2)}},P=()=>{u.value={type:"",source:"",period:""}},z=()=>{a.info("Экспорт истории будет доступен в следующей версии")},it=async U=>{try{const S=l.value.findIndex(Z=>Z.id===U.id);S!==-1&&(l.value[S].canRefund=!1),a.success("Запрос на возврат отправлен")}catch(S){console.error("Ошибка запроса возврата:",S),a.error("Ошибка запроса возврата")}},kt=U=>{U>=1&&U<=o.value.totalPages&&(o.value.currentPage=U)};return Mt(()=>[u.value.type,u.value.source,u.value.period],()=>{o.value.currentPage=1}),Mt(()=>m.value,()=>{T()}),dt(()=>{p(),setTimeout(T,100)}),{loading:s,selectedChartPeriod:m,filters:u,pagination:o,pointsHistory:l,pointsStats:v,chartPeriods:f,currentBalance:_,balanceChangeIcon:M,balanceChangeText:R,hasActiveFilters:k,filteredHistory:V,groupedHistory:I,totalFilteredAmount:F,visiblePages:$,formatNumber:x,formatDate:y,formatTime:L,getSourceLabel:q,getTransactionClass:O,getTransactionIcon:C,getAmountClass:b,getDaySummaryClass:B,getDaySummaryText:at,clearFilters:P,exportHistory:z,requestRefund:it,goToPage:kt}}},_g={class:"profile-points-tab"},yg={class:"points-overview mb-4"},wg={class:"row g-3"},kg={class:"col-lg-4"},Cg={class:"balance-card"},xg={class:"balance-content"},Sg={class:"balance-amount"},$g={class:"balance-change"},Pg={class:"col-lg-8"},Dg={class:"stats-grid"},Tg={class:"stat-item"},Mg={class:"stat-value"},Ig={class:"stat-item"},Ag={class:"stat-value"},Rg={class:"stat-item"},Eg={class:"stat-value"},Ng={class:"stat-item"},Ug={class:"stat-value"},Lg={class:"points-filters mb-4"},Vg={class:"row g-3 align-items-center"},Bg={class:"col-md-3"},Fg={class:"col-md-3"},Og={class:"col-md-3"},qg={class:"col-md-3"},jg={class:"d-flex gap-2"},Hg={class:"points-chart mb-4"},zg={class:"chart-card"},Zg={class:"chart-header"},Wg={class:"chart-controls"},Yg=["onClick"],Gg={class:"points-history"},Qg={class:"history-header mb-3"},Kg={class:"history-summary"},Xg={class:"summary-amount"},Jg={key:0,class:"loading-state text-center py-4"},tp={key:1,class:"empty-state text-center py-5"},ep={class:"text-muted"},sp={key:2,class:"history-timeline"},ap={class:"timeline-date"},op={class:"date-title"},np={class:"date-summary"},ip={class:"timeline-transactions"},lp={class:"transaction-marker"},rp={class:"transaction-card"},dp={class:"transaction-header"},cp={class:"transaction-info"},up={class:"transaction-title"},mp={class:"transaction-meta"},vp={class:"transaction-time"},fp={class:"transaction-source"},gp={key:0,class:"transaction-event"},pp={class:"amount-value"},bp={key:0,class:"transaction-details"},hp={key:0,class:"balance-info"},_p={class:"balance-before"},yp={class:"balance-after"},wp={key:1,class:"multiplier-info"},kp={key:2,class:"expiration-info"},Cp={key:1,class:"transaction-actions"},xp=["onClick"],Sp={key:3,class:"pagination-section mt-4"},$p={"aria-label":"Навигация по страницам"},Pp={class:"pagination justify-content-center"},Dp=["onClick"];function Tp(a,e,d,s,m,u){return n(),i("div",_g,[t("div",yg,[t("div",wg,[t("div",kg,[t("div",Cg,[e[8]||(e[8]=t("div",{class:"balance-icon"},[t("i",{class:"fas fa-coins"})],-1)),t("div",xg,[t("h2",Sg,r(s.formatNumber(s.currentBalance)),1),e[7]||(e[7]=t("p",{class:"balance-label"},"Текущий баланс",-1)),t("div",$g,[t("i",{class:h([s.balanceChangeIcon,"me-1"])},null,2),c(" "+r(s.balanceChangeText),1)])])])]),t("div",Pg,[t("div",Dg,[t("div",Tg,[t("div",Mg,r(s.formatNumber(s.pointsStats.totalEarned)),1),e[9]||(e[9]=t("div",{class:"stat-label"},"Всего заработано",-1))]),t("div",Ig,[t("div",Ag,r(s.formatNumber(s.pointsStats.totalSpent)),1),e[10]||(e[10]=t("div",{class:"stat-label"},"Всего потрачено",-1))]),t("div",Rg,[t("div",Eg,r(s.formatNumber(s.pointsStats.thisMonth)),1),e[11]||(e[11]=t("div",{class:"stat-label"},"За этот месяц",-1))]),t("div",Ng,[t("div",Ug,r(s.pointsStats.avgPerEvent),1),e[12]||(e[12]=t("div",{class:"stat-label"},"В среднем за мероприятие",-1))])])])])]),t("div",Lg,[t("div",Vg,[t("div",Bg,[E(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.filters.type=o),class:"form-select"},e[13]||(e[13]=[t("option",{value:""},"Все операции",-1),t("option",{value:"earned"},"Начисления",-1),t("option",{value:"spent"},"Списания",-1)]),512),[[ot,s.filters.type]])]),t("div",Fg,[E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.filters.source=o),class:"form-select"},e[14]||(e[14]=[rt('<option value="" data-v-fe064950>Все источники</option><option value="event_attendance" data-v-fe064950>Посещение мероприятий</option><option value="event_registration" data-v-fe064950>Регистрация</option><option value="purchase" data-v-fe064950>Покупки</option><option value="bonus" data-v-fe064950>Бонусы</option><option value="refund" data-v-fe064950>Возвраты</option>',6)]),512),[[ot,s.filters.source]])]),t("div",Og,[E(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.filters.period=o),class:"form-select"},e[15]||(e[15]=[rt('<option value="" data-v-fe064950>Все время</option><option value="today" data-v-fe064950>Сегодня</option><option value="week" data-v-fe064950>Эта неделя</option><option value="month" data-v-fe064950>Этот месяц</option><option value="quarter" data-v-fe064950>Этот квартал</option><option value="year" data-v-fe064950>Этот год</option>',6)]),512),[[ot,s.filters.period]])]),t("div",qg,[t("div",jg,[t("button",{class:"btn btn-outline-primary",onClick:e[3]||(e[3]=(...o)=>s.exportHistory&&s.exportHistory(...o))},e[16]||(e[16]=[t("i",{class:"fas fa-download me-1"},null,-1),c(" Экспорт ",-1)])),t("button",{class:"btn btn-outline-secondary",onClick:e[4]||(e[4]=(...o)=>s.clearFilters&&s.clearFilters(...o))},e[17]||(e[17]=[t("i",{class:"fas fa-times me-1"},null,-1),c(" Сбросить ",-1)]))])])])]),t("div",Hg,[t("div",zg,[t("div",Zg,[e[18]||(e[18]=t("h5",{class:"chart-title"},[t("i",{class:"fas fa-chart-line me-2"}),c(" Изменение баланса баллов ")],-1)),t("div",Wg,[(n(!0),i(H,null,G(s.chartPeriods,o=>(n(),i("button",{key:o.value,class:h(["btn btn-sm",s.selectedChartPeriod===o.value?"btn-primary":"btn-outline-primary"]),onClick:l=>s.selectedChartPeriod=o.value},r(o.label),11,Yg))),128))])]),e[19]||(e[19]=t("div",{class:"chart-body"},[t("canvas",{id:"pointsChart",width:"400",height:"200"})],-1))])]),t("div",Gg,[t("div",Qg,[e[20]||(e[20]=t("h5",{class:"history-title"},[t("i",{class:"fas fa-history me-2"}),c(" История операций ")],-1)),t("div",Kg,[c(" Найдено "+r(s.filteredHistory.length)+" операций на сумму ",1),t("span",Xg,r(s.formatNumber(s.totalFilteredAmount))+" баллов",1)])]),s.loading?(n(),i("div",Jg,e[21]||(e[21]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1),t("p",{class:"mt-2 text-muted"},"Загрузка истории...",-1)]))):s.filteredHistory.length===0?(n(),i("div",tp,[e[22]||(e[22]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fas fa-receipt"})],-1)),e[23]||(e[23]=t("h5",null,"Операции не найдены",-1)),t("p",ep,r(s.hasActiveFilters?"Попробуйте изменить фильтры":"История операций пуста"),1)])):(n(),i("div",sp,[(n(!0),i(H,null,G(s.groupedHistory,(o,l)=>(n(),i("div",{key:l,class:"timeline-group"},[t("div",ap,[t("h6",op,r(l),1),t("div",np,[c(r(o.length)+" операций, ",1),t("span",{class:h(s.getDaySummaryClass(o))},r(s.getDaySummaryText(o)),3)])]),t("div",ip,[(n(!0),i(H,null,G(o,v=>(n(),i("div",{key:v.id,class:h(["transaction-item",s.getTransactionClass(v.type)])},[t("div",lp,[t("i",{class:h(s.getTransactionIcon(v.type))},null,2)]),t("div",rp,[t("div",dp,[t("div",cp,[t("h6",up,r(v.description),1),t("div",mp,[t("span",vp,[e[24]||(e[24]=t("i",{class:"fas fa-clock me-1"},null,-1)),c(" "+r(s.formatTime(v.createdAt)),1)]),t("span",fp,[e[25]||(e[25]=t("i",{class:"fas fa-tag me-1"},null,-1)),c(" "+r(s.getSourceLabel(v.source)),1)]),v.relatedEvent?(n(),i("span",gp,[e[26]||(e[26]=t("i",{class:"fas fa-calendar me-1"},null,-1)),c(" "+r(v.relatedEvent.title),1)])):g("",!0)])]),t("div",{class:h(["transaction-amount",s.getAmountClass(v.type)])},[t("span",pp,r(v.type==="earned"?"+":"-")+r(s.formatNumber(v.points)),1),e[27]||(e[27]=t("span",{class:"amount-label"},"баллов",-1))],2)]),v.details?(n(),i("div",bp,[v.balanceBefore!==void 0?(n(),i("div",hp,[t("span",_p,"Было: "+r(s.formatNumber(v.balanceBefore)),1),e[28]||(e[28]=t("i",{class:"fas fa-arrow-right mx-2"},null,-1)),t("span",yp,"Стало: "+r(s.formatNumber(v.balanceAfter)),1)])):g("",!0),v.multiplier>1?(n(),i("div",wp,[e[29]||(e[29]=t("i",{class:"fas fa-times me-1"},null,-1)),c(" Множитель: "+r(v.multiplier)+"x ",1)])):g("",!0),v.expiration?(n(),i("div",kp,[e[30]||(e[30]=t("i",{class:"fas fa-hourglass-end me-1"},null,-1)),c(" Действительно до: "+r(s.formatDate(v.expiration)),1)])):g("",!0)])):g("",!0),v.canRefund?(n(),i("div",Cp,[t("button",{class:"btn btn-sm btn-outline-warning",onClick:f=>s.requestRefund(v)},e[31]||(e[31]=[t("i",{class:"fas fa-undo me-1"},null,-1),c(" Вернуть ",-1)]),8,xp)])):g("",!0)])],2))),128))])]))),128))])),s.pagination.totalPages>1?(n(),i("div",Sp,[t("nav",$p,[t("ul",Pp,[t("li",{class:h(["page-item",{disabled:s.pagination.currentPage===1}])},[t("button",{class:"page-link",onClick:e[5]||(e[5]=o=>s.goToPage(s.pagination.currentPage-1))},e[32]||(e[32]=[t("i",{class:"fas fa-chevron-left"},null,-1)]))],2),(n(!0),i(H,null,G(s.visiblePages,o=>(n(),i("li",{key:o,class:h(["page-item",{active:o===s.pagination.currentPage}])},[t("button",{class:"page-link",onClick:l=>s.goToPage(o)},r(o),9,Dp)],2))),128)),t("li",{class:h(["page-item",{disabled:s.pagination.currentPage===s.pagination.totalPages}])},[t("button",{class:"page-link",onClick:e[6]||(e[6]=o=>s.goToPage(s.pagination.currentPage+1))},e[33]||(e[33]=[t("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])])])):g("",!0)])])}const Mp=J(hg,[["render",Tp],["__scopeId","data-v-fe064950"]]),Ip={name:"ProfileAchievementsTab",setup(){const a=mt(),e=ut(),d=w(!1),s=w("grid"),m=w(null),u=w({category:"",status:"",difficulty:""}),o=w([]),l=w([{id:"participation",name:"Участие",icon:"fas fa-users"},{id:"leadership",name:"Лидерство",icon:"fas fa-crown"},{id:"learning",name:"Обучение",icon:"fas fa-graduation-cap"},{id:"social",name:"Социальная активность",icon:"fas fa-heart"},{id:"special",name:"Особые",icon:"fas fa-star"}]),v=j(()=>u.value.category||u.value.status||u.value.difficulty),f=j(()=>{let b=[...o.value];if(u.value.category&&(b=b.filter(B=>B.category===u.value.category)),u.value.status)switch(u.value.status){case"earned":b=b.filter(B=>B.isEarned);break;case"in_progress":b=b.filter(B=>!B.isEarned&&!B.isLocked);break;case"locked":b=b.filter(B=>B.isLocked);break}return u.value.difficulty&&(b=b.filter(B=>B.difficulty===u.value.difficulty)),b}),_=j(()=>o.value.filter(b=>b.isEarned)),M=j(()=>o.value.length),R=j(()=>M.value===0?0:Math.round(_.value.length/M.value*100)),k=j(()=>_.value.reduce((b,B)=>b+B.experience,0)),V=j(()=>Math.floor(k.value/100)+1),I=j(()=>_.value.filter(b=>b.earnedAt).sort((b,B)=>new Date(B.earnedAt)-new Date(b.earnedAt)).slice(0,3)),F=b=>e.formatDate(b,"dd MMM yyyy"),$=b=>e.formatRelativeDate(b),x=b=>{const B=o.value.filter(p=>p.category===b);return`${B.filter(p=>p.isEarned).length}/${B.length}`},y=b=>{const B=l.value.find(at=>at.id===b);return B?B.name:"Неизвестно"},D=b=>({"achievement-earned":b.isEarned,"achievement-locked":b.isLocked,"achievement-progress":!b.isEarned&&!b.isLocked,[`achievement-${b.difficulty}`]:!0}),L=b=>({easy:"difficulty-easy",medium:"difficulty-medium",hard:"difficulty-hard",legendary:"difficulty-legendary"})[b]||"difficulty-easy",W=b=>({easy:"Легкое",medium:"Среднее",hard:"Сложное",legendary:"Легендарное"})[b]||"Неизвестно",q=b=>b.progress?Math.round(b.progress.current/b.progress.total*100):0,O=async()=>{try{d.value=!0,await new Promise(b=>setTimeout(b,500)),o.value=[{id:"1",name:"Первые шаги",description:"Участие в первом мероприятии",category:"participation",difficulty:"easy",experience:50,pointsReward:25,icon:null,defaultIcon:"fas fa-baby",isEarned:!0,isLocked:!1,earnedAt:new Date(Date.now()-864e5*30),requirements:["Зарегистрироваться на мероприятие","Посетить мероприятие"],tips:"Начните с простых мероприятий, чтобы познакомиться с системой."},{id:"2",name:"Активный участник",description:"Посещение 10 мероприятий",category:"participation",difficulty:"medium",experience:200,pointsReward:100,icon:null,defaultIcon:"fas fa-fire",isEarned:!0,isLocked:!1,earnedAt:new Date(Date.now()-864e5*15),requirements:["Посетить 10 различных мероприятий"],tips:"Разнообразьте свое участие - посещайте мероприятия разных типов."},{id:"3",name:"Лидер мнений",description:"Получение высоких оценок от 5 организаторов",category:"leadership",difficulty:"hard",experience:500,pointsReward:250,icon:null,defaultIcon:"fas fa-crown",isEarned:!1,isLocked:!1,progress:{current:2,total:5},requirements:["Получить оценку 5/5 от организатора","Повторить 5 раз"],tips:"Активно участвуйте в дискуссиях и делитесь своим опытом."},{id:"4",name:"Мастер обучения",description:"Завершение всех доступных курсов",category:"learning",difficulty:"legendary",experience:1e3,pointsReward:500,badge:!0,icon:null,defaultIcon:"fas fa-graduation-cap",isEarned:!1,isLocked:!0,requirements:["Разблокировать участием в 20 мероприятиях"],tips:"Это достижение станет доступно после активного участия в мероприятиях."}]}catch(b){console.error("Ошибка загрузки достижений:",b),a.error("Ошибка загрузки списка достижений")}finally{d.value=!1}},C=b=>{m.value=b,new bootstrap.Modal(document.getElementById("achievementModal")).show()};return dt(()=>{O()}),{loading:d,viewMode:s,selectedAchievement:m,filters:u,achievements:o,achievementCategories:l,hasActiveFilters:v,filteredAchievements:f,earnedAchievements:_,totalAchievements:M,overallProgress:R,totalPoints:k,currentLevel:V,recentAchievements:I,formatDate:F,formatRelativeTime:$,getCategoryProgress:x,getCategoryName:y,getAchievementClass:D,getDifficultyClass:L,getDifficultyLabel:W,getProgressPercentage:q,showAchievementDetails:C}}},Ap={class:"profile-achievements-tab"},Rp={class:"achievements-overview mb-4"},Ep={class:"row g-3"},Np={class:"col-lg-8"},Up={class:"overview-card"},Lp={class:"overview-header"},Vp={class:"overview-stats"},Bp={class:"overview-progress"},Fp={class:"progress-bar-container"},Op={class:"progress"},qp={class:"progress-text"},jp={class:"progress-categories"},Hp={class:"category-info"},zp={class:"category-name"},Zp={class:"category-stats"},Wp={class:"col-lg-4"},Yp={class:"achievements-stats"},Gp={class:"stat-item"},Qp={class:"stat-content"},Kp={class:"stat-value"},Xp={class:"stat-item"},Jp={class:"stat-content"},t2={class:"stat-value"},e2={class:"stat-item"},s2={class:"stat-content"},a2={class:"stat-value"},o2={class:"achievements-filters mb-4"},n2={class:"row g-3 align-items-center"},i2={class:"col-md-3"},l2=["value"],r2={class:"col-md-3"},d2={class:"col-md-3"},c2={class:"col-md-3"},u2={class:"view-mode-toggle"},m2={key:0,class:"recent-achievements mb-4"},v2={class:"recent-list"},f2={class:"recent-icon"},g2=["src","alt"],p2={class:"recent-info"},b2={class:"recent-name"},h2={class:"recent-date"},_2={class:"recent-reward"},y2={class:"achievements-content"},w2={key:0,class:"loading-state text-center py-4"},k2={key:1,class:"empty-state text-center py-5"},C2={class:"text-muted"},x2={key:2,class:"achievements-grid"},S2=["onClick"],$2={class:"achievement-icon"},P2=["src","alt"],D2={key:2,class:"achievement-status earned"},T2={key:3,class:"achievement-status locked"},M2={class:"achievement-content"},I2={class:"achievement-name"},A2={class:"achievement-description"},R2={key:0,class:"achievement-progress"},E2={class:"progress-info"},N2={class:"progress-current"},U2={class:"progress-total"},L2={class:"progress"},V2={class:"achievement-reward"},B2={class:"reward-experience"},F2={key:0,class:"reward-points"},O2={class:"achievement-difficulty"},q2={key:1,class:"achievement-earned-date"},j2={key:3,class:"achievements-list"},H2=["onClick"],z2={class:"achievement-icon-small"},Z2=["src","alt"],W2={class:"achievement-info"},Y2={class:"achievement-header"},G2={class:"achievement-name"},Q2={class:"achievement-meta"},K2={class:"experience-badge"},X2={class:"achievement-description"},J2={key:0,class:"achievement-progress-list"},tb={class:"progress-info"},eb={class:"progress"},sb={class:"achievement-actions"},ab={key:0,class:"status-earned"},ob={key:1,class:"status-locked"},nb={key:2,class:"status-progress"},ib={id:"achievementModal",class:"modal fade",tabindex:"-1","aria-labelledby":"achievementModalLabel","aria-hidden":"true"},lb={class:"modal-dialog modal-lg"},rb={class:"modal-content"},db={class:"modal-body"},cb={key:0,class:"achievement-details"},ub={class:"details-header"},mb={class:"details-icon"},vb=["src","alt"],fb={class:"details-info"},gb={class:"details-description"},pb={class:"details-meta"},bb={class:"category-badge"},hb={class:"details-content"},_b={class:"row"},yb={class:"col-md-6"},wb={class:"rewards-list"},kb={key:0},Cb={key:1},xb={class:"col-md-6"},Sb={class:"requirements-list"},$b={key:0,class:"details-progress"},Pb={class:"progress-detailed"},Db={class:"progress-info"},Tb={class:"progress"},Mb={key:1,class:"details-tips"},Ib={class:"tips-content"};function Ab(a,e,d,s,m,u){return n(),i("div",Ap,[t("div",Rp,[t("div",Ep,[t("div",Np,[t("div",Up,[t("div",Lp,[e[5]||(e[5]=t("h5",{class:"overview-title"},[t("i",{class:"fas fa-trophy me-2"}),c(" Ваши достижения ")],-1)),t("div",Vp,r(s.earnedAchievements.length)+" из "+r(s.totalAchievements)+" получено ",1)]),t("div",Bp,[t("div",Fp,[t("div",Op,[t("div",{class:"progress-bar",style:st({width:s.overallProgress+"%"})},null,4)]),t("span",qp,r(s.overallProgress)+"%",1)]),t("div",jp,[(n(!0),i(H,null,G(s.achievementCategories,o=>(n(),i("div",{key:o.id,class:"category-progress"},[t("div",Hp,[t("i",{class:h(o.icon)},null,2),t("span",zp,r(o.name),1)]),t("div",Zp,r(s.getCategoryProgress(o.id)),1)]))),128))])])])]),t("div",Wp,[t("div",Yp,[t("div",Gp,[e[7]||(e[7]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-medal"})],-1)),t("div",Qp,[t("div",Kp,r(s.earnedAchievements.length),1),e[6]||(e[6]=t("div",{class:"stat-label"},"Получено",-1))])]),t("div",Xp,[e[9]||(e[9]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-star"})],-1)),t("div",Jp,[t("div",t2,r(s.totalPoints),1),e[8]||(e[8]=t("div",{class:"stat-label"},"Очков опыта",-1))])]),t("div",e2,[e[11]||(e[11]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-chart-line"})],-1)),t("div",s2,[t("div",a2,r(s.currentLevel),1),e[10]||(e[10]=t("div",{class:"stat-label"},"Уровень",-1))])])])])])]),t("div",o2,[t("div",n2,[t("div",i2,[E(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.filters.category=o),class:"form-select"},[e[12]||(e[12]=t("option",{value:""},"Все категории",-1)),(n(!0),i(H,null,G(s.achievementCategories,o=>(n(),i("option",{key:o.id,value:o.id},r(o.name),9,l2))),128))],512),[[ot,s.filters.category]])]),t("div",r2,[E(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.filters.status=o),class:"form-select"},e[13]||(e[13]=[t("option",{value:""},"Все достижения",-1),t("option",{value:"earned"},"Полученные",-1),t("option",{value:"in_progress"},"В процессе",-1),t("option",{value:"locked"},"Заблокированные",-1)]),512),[[ot,s.filters.status]])]),t("div",d2,[E(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.filters.difficulty=o),class:"form-select"},e[14]||(e[14]=[rt('<option value="" data-v-2d2a212e>Любая сложность</option><option value="easy" data-v-2d2a212e>Легкие</option><option value="medium" data-v-2d2a212e>Средние</option><option value="hard" data-v-2d2a212e>Сложные</option><option value="legendary" data-v-2d2a212e>Легендарные</option>',5)]),512),[[ot,s.filters.difficulty]])]),t("div",c2,[t("div",u2,[t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="grid"}]),onClick:e[3]||(e[3]=o=>s.viewMode="grid")},e[15]||(e[15]=[t("i",{class:"fas fa-th"},null,-1)]),2),t("button",{class:h(["btn btn-outline-secondary",{active:s.viewMode==="list"}]),onClick:e[4]||(e[4]=o=>s.viewMode="list")},e[16]||(e[16]=[t("i",{class:"fas fa-list"},null,-1)]),2)])])])]),s.recentAchievements.length>0?(n(),i("div",m2,[e[17]||(e[17]=t("div",{class:"recent-header"},[t("h6",{class:"recent-title"},[t("i",{class:"fas fa-clock me-2"}),c(" Недавно получено ")])],-1)),t("div",v2,[(n(!0),i(H,null,G(s.recentAchievements,o=>(n(),i("div",{key:o.id,class:"recent-item"},[t("div",f2,[o.icon?(n(),i("img",{key:0,src:o.icon,alt:o.name},null,8,g2)):(n(),i("i",{key:1,class:h(o.defaultIcon)},null,2))]),t("div",p2,[t("div",b2,r(o.name),1),t("div",h2,r(s.formatRelativeTime(o.earnedAt)),1)]),t("div",_2," +"+r(o.experience)+" XP ",1)]))),128))])])):g("",!0),t("div",y2,[s.loading?(n(),i("div",w2,e[18]||(e[18]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1),t("p",{class:"mt-2 text-muted"},"Загрузка достижений...",-1)]))):s.filteredAchievements.length===0?(n(),i("div",k2,[e[19]||(e[19]=t("div",{class:"empty-icon mb-3"},[t("i",{class:"fas fa-trophy"})],-1)),e[20]||(e[20]=t("h5",null,"Достижения не найдены",-1)),t("p",C2,r(s.hasActiveFilters?"Попробуйте изменить фильтры":"Начните участвовать в мероприятиях для получения достижений"),1)])):s.viewMode==="grid"?(n(),i("div",x2,[(n(!0),i(H,null,G(s.filteredAchievements,o=>(n(),i("div",{key:o.id,class:h(["achievement-card",s.getAchievementClass(o)]),onClick:l=>s.showAchievementDetails(o)},[t("div",$2,[o.icon?(n(),i("img",{key:0,src:o.icon,alt:o.name},null,8,P2)):(n(),i("i",{key:1,class:h(o.defaultIcon)},null,2)),o.isEarned?(n(),i("div",D2,e[21]||(e[21]=[t("i",{class:"fas fa-check"},null,-1)]))):o.isLocked?(n(),i("div",T2,e[22]||(e[22]=[t("i",{class:"fas fa-lock"},null,-1)]))):g("",!0)]),t("div",M2,[t("h6",I2,r(o.name),1),t("p",A2,r(o.description),1),o.progress?(n(),i("div",R2,[t("div",E2,[t("span",N2,r(o.progress.current),1),e[23]||(e[23]=t("span",{class:"progress-separator"},"/",-1)),t("span",U2,r(o.progress.total),1)]),t("div",L2,[t("div",{class:"progress-bar",style:st({width:s.getProgressPercentage(o)+"%"})},null,4)])])):g("",!0),t("div",V2,[t("div",B2,[e[24]||(e[24]=t("i",{class:"fas fa-star me-1"},null,-1)),c(" "+r(o.experience)+" XP ",1)]),o.pointsReward?(n(),i("div",F2,[e[25]||(e[25]=t("i",{class:"fas fa-coins me-1"},null,-1)),c(" "+r(o.pointsReward)+" баллов ",1)])):g("",!0)]),t("div",O2,[t("span",{class:h(["difficulty-badge",s.getDifficultyClass(o.difficulty)])},r(s.getDifficultyLabel(o.difficulty)),3)]),o.earnedAt?(n(),i("div",q2,[e[26]||(e[26]=t("i",{class:"fas fa-calendar me-1"},null,-1)),c(" "+r(s.formatDate(o.earnedAt)),1)])):g("",!0)])],10,S2))),128))])):(n(),i("div",j2,[(n(!0),i(H,null,G(s.filteredAchievements,o=>(n(),i("div",{key:o.id,class:h(["achievement-list-item",s.getAchievementClass(o)]),onClick:l=>s.showAchievementDetails(o)},[t("div",z2,[o.icon?(n(),i("img",{key:0,src:o.icon,alt:o.name},null,8,Z2)):(n(),i("i",{key:1,class:h(o.defaultIcon)},null,2))]),t("div",W2,[t("div",Y2,[t("h6",G2,r(o.name),1),t("div",Q2,[t("span",{class:h(["difficulty-badge",s.getDifficultyClass(o.difficulty)])},r(s.getDifficultyLabel(o.difficulty)),3),t("span",K2,r(o.experience)+" XP",1)])]),t("p",X2,r(o.description),1),o.progress?(n(),i("div",J2,[t("div",tb," Прогресс: "+r(o.progress.current)+"/"+r(o.progress.total),1),t("div",eb,[t("div",{class:"progress-bar",style:st({width:s.getProgressPercentage(o)+"%"})},null,4)])])):g("",!0)]),t("div",sb,[o.isEarned?(n(),i("div",ab,e[27]||(e[27]=[t("i",{class:"fas fa-check-circle"},null,-1),c(" Получено ",-1)]))):o.isLocked?(n(),i("div",ob,e[28]||(e[28]=[t("i",{class:"fas fa-lock"},null,-1),c(" Заблокировано ",-1)]))):(n(),i("div",nb,e[29]||(e[29]=[t("i",{class:"fas fa-hourglass-half"},null,-1),c(" В процессе ",-1)])))])],10,H2))),128))]))]),t("div",ib,[t("div",lb,[t("div",rb,[e[38]||(e[38]=t("div",{class:"modal-header"},[t("h5",{id:"achievementModalLabel",class:"modal-title"}," Детали достижения "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("div",db,[s.selectedAchievement?(n(),i("div",cb,[t("div",ub,[t("div",mb,[s.selectedAchievement.icon?(n(),i("img",{key:0,src:s.selectedAchievement.icon,alt:s.selectedAchievement.name},null,8,vb)):(n(),i("i",{key:1,class:h(s.selectedAchievement.defaultIcon)},null,2))]),t("div",fb,[t("h4",null,r(s.selectedAchievement.name),1),t("p",gb,r(s.selectedAchievement.description),1),t("div",pb,[t("span",{class:h(["difficulty-badge",s.getDifficultyClass(s.selectedAchievement.difficulty)])},r(s.getDifficultyLabel(s.selectedAchievement.difficulty)),3),t("span",bb,r(s.getCategoryName(s.selectedAchievement.category)),1)])])]),t("div",hb,[t("div",_b,[t("div",yb,[e[33]||(e[33]=t("h6",null,"Награды",-1)),t("ul",wb,[t("li",null,[e[30]||(e[30]=t("i",{class:"fas fa-star text-warning"},null,-1)),c(" "+r(s.selectedAchievement.experience)+" опыта",1)]),s.selectedAchievement.pointsReward?(n(),i("li",kb,[e[31]||(e[31]=t("i",{class:"fas fa-coins text-warning"},null,-1)),c(" "+r(s.selectedAchievement.pointsReward)+" баллов ",1)])):g("",!0),s.selectedAchievement.badge?(n(),i("li",Cb,e[32]||(e[32]=[t("i",{class:"fas fa-medal text-info"},null,-1),c(" Особый значок ",-1)]))):g("",!0)])]),t("div",xb,[e[35]||(e[35]=t("h6",null,"Требования",-1)),t("ul",Sb,[(n(!0),i(H,null,G(s.selectedAchievement.requirements,o=>(n(),i("li",{key:o},[e[34]||(e[34]=t("i",{class:"fas fa-check-circle text-success"},null,-1)),c(" "+r(o),1)]))),128))])])]),s.selectedAchievement.progress?(n(),i("div",$b,[e[36]||(e[36]=t("h6",null,"Текущий прогресс",-1)),t("div",Pb,[t("div",Db,r(s.selectedAchievement.progress.current)+" / "+r(s.selectedAchievement.progress.total)+" ("+r(s.getProgressPercentage(s.selectedAchievement))+"%) ",1),t("div",Tb,[t("div",{class:"progress-bar",style:st({width:s.getProgressPercentage(s.selectedAchievement)+"%"})},null,4)])])])):g("",!0),s.selectedAchievement.tips?(n(),i("div",Mb,[e[37]||(e[37]=t("h6",null,"Советы",-1)),t("div",Ib,r(s.selectedAchievement.tips),1)])):g("",!0)])])):g("",!0)])])])])])}const Rb=J(Ip,[["render",Ab],["__scopeId","data-v-2d2a212e"]]),Eb={name:"ProfileEditModal",props:{modelValue:{type:Boolean,default:!1},user:{type:Object,default:()=>({})}},emits:["update:modelValue","updated"],setup(a,{emit:e}){const d=mt(),s=w(!1),m=w(""),u=w({firstName:"",lastName:"",middleName:"",email:"",birthDate:"",gender:"",bio:"",employeeId:"",department:"",position:"",manager:"",hireDate:"",workLocation:"",skills:[],phone:"",personalPhone:"",address:"",socialLinkedIn:"",socialTelegram:"",preferences:{emailNotifications:!0,eventReminders:!0,achievementNotifications:!0,publicProfile:!0,showInLeaderboard:!0,timezone:"Europe/Moscow"}}),o=w({}),l=w({}),v=w(["Администрация","Бухгалтерия","HR / Кадры","IT / Информационные технологии","Маркетинг","Продажи","Производство","Снабжение","Юридический отдел","Другое"]),f=j(()=>u.value.firstName&&u.value.lastName&&u.value.email&&!o.value.firstName&&!o.value.lastName&&!o.value.email),_=(x,y)=>{switch(x){case"firstName":case"lastName":return y!=null&&y.trim()?"":"Поле обязательно для заполнения";case"email":return y!=null&&y.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y)?"":"Некорректный формат email":"Email обязателен";case"phone":case"personalPhone":return y&&!/^[+]?[0-9\s\-\(\)]+$/.test(y)?"Некорректный формат телефона":"";case"bio":return y&&y.length>500?"Максимум 500 символов":"";default:return""}},M=()=>{const x={};return Object.keys(u.value).forEach(y=>{if(typeof u.value[y]=="string"){const D=_(y,u.value[y]);D&&(x[y]=D)}}),o.value=x,Object.keys(x).length===0},R=x=>{o.value[x]&&delete o.value[x]},k=()=>{const x=m.value.trim();x&&!u.value.skills.includes(x)&&(u.value.skills.push(x),m.value="")},V=x=>{u.value.skills.splice(x,1)},I=()=>{e("update:modelValue",!1)},F=()=>{a.user&&Object.keys(u.value).forEach(x=>{x==="preferences"?u.value.preferences={...u.value.preferences,...a.user.preferences||{}}:x==="skills"?u.value.skills=a.user.skills?[...a.user.skills]:[]:a.user[x]!==void 0&&(u.value[x]=a.user[x])})},$=async()=>{if(!M()){d.error("Пожалуйста, исправьте ошибки в форме");return}try{s.value=!0,await new Promise(x=>setTimeout(x,1e3)),e("updated",u.value),I(),d.success("Профиль успешно обновлен!")}catch(x){console.error("Ошибка обновления профиля:",x),d.error("Ошибка при сохранении профиля")}finally{s.value=!1}};return Mt(()=>a.modelValue,x=>{x&&(F(),o.value={},l.value={})}),dt(()=>{a.modelValue&&F()}),{isSubmitting:s,newSkill:m,form:u,errors:o,touched:l,departments:v,isFormValid:f,clearError:R,addSkill:k,removeSkill:V,closeModal:I,handleSubmit:$}}},Nb={class:"modal-dialog modal-lg"},Ub={class:"modal-content"},Lb={class:"modal-header"},Vb={class:"modal-body"},Bb={class:"tab-content"},Fb={class:"tab-pane fade show active",id:"personal-info",role:"tabpanel"},Ob={class:"row g-3"},qb={class:"col-md-6"},jb={key:0,class:"invalid-feedback"},Hb={class:"col-md-6"},zb={key:0,class:"invalid-feedback"},Zb={class:"col-12"},Wb={class:"col-12"},Yb={key:0,class:"invalid-feedback"},Gb={class:"col-md-6"},Qb={class:"col-md-6"},Kb={class:"col-12"},Xb={class:"form-text"},Jb={class:"tab-pane fade",id:"work-info",role:"tabpanel"},th={class:"row g-3"},eh={class:"col-md-6"},sh={class:"col-md-6"},ah=["value"],oh={class:"col-md-6"},nh={class:"col-md-6"},ih={class:"col-md-6"},lh={class:"col-md-6"},rh={class:"col-12"},dh={class:"skills-input"},ch={class:"skills-list mt-2"},uh=["onClick"],mh={class:"tab-pane fade",id:"contacts",role:"tabpanel"},vh={class:"row g-3"},fh={class:"col-md-6"},gh={key:0,class:"invalid-feedback"},ph={class:"col-md-6"},bh={class:"col-12"},hh={class:"col-md-6"},_h={class:"input-group"},yh={class:"col-md-6"},wh={class:"input-group"},kh={class:"tab-pane fade",id:"preferences",role:"tabpanel"},Ch={class:"row g-3"},xh={class:"col-12"},Sh={class:"form-check form-switch"},$h={class:"col-12"},Ph={class:"form-check form-switch"},Dh={class:"col-12"},Th={class:"form-check form-switch"},Mh={class:"col-12"},Ih={class:"form-check form-switch"},Ah={class:"col-12"},Rh={class:"form-check form-switch"},Eh={class:"col-12"},Nh={class:"modal-footer"},Uh=["disabled"],Lh={key:0,class:"spinner-border spinner-border-sm me-2"},Vh={key:1,class:"fas fa-save me-2"};function Bh(a,e,d,s,m,u){var o;return n(),i(H,null,[t("div",{class:h(["modal fade",{show:d.modelValue}]),style:st({display:d.modelValue?"block":"none"}),tabindex:"-1","aria-labelledby":"profileEditModalLabel","aria-hidden":"true"},[t("div",Nb,[t("div",Ub,[t("div",Lb,[e[53]||(e[53]=t("h5",{id:"profileEditModalLabel",class:"modal-title"},[t("i",{class:"fas fa-edit me-2"}),c(" Редактировать профиль ")],-1)),t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...l)=>s.closeModal&&s.closeModal(...l)),"aria-label":"Закрыть"})]),t("form",{onSubmit:e[51]||(e[51]=lt((...l)=>s.handleSubmit&&s.handleSubmit(...l),["prevent"]))},[t("div",Vb,[e[94]||(e[94]=t("ul",{class:"nav nav-tabs mb-4",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#personal-info",type:"button",role:"tab"},[t("i",{class:"fas fa-user me-2"}),c(" Личные данные ")])]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#work-info",type:"button",role:"tab"},[t("i",{class:"fas fa-briefcase me-2"}),c(" Рабочая информация ")])]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#contacts",type:"button",role:"tab"},[t("i",{class:"fas fa-address-book me-2"}),c(" Контакты ")])]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#preferences",type:"button",role:"tab"},[t("i",{class:"fas fa-cog me-2"}),c(" Настройки ")])])],-1)),t("div",Bb,[t("div",Fb,[t("div",Ob,[t("div",qb,[e[54]||(e[54]=t("label",{for:"firstName",class:"form-label required"},"Имя",-1)),E(t("input",{id:"firstName","onUpdate:modelValue":e[1]||(e[1]=l=>s.form.firstName=l),type:"text",class:h(["form-control",{"is-invalid":s.errors.firstName,"is-valid":!s.errors.firstName&&s.form.firstName&&s.touched.firstName}]),required:"",onBlur:e[2]||(e[2]=l=>s.touched.firstName=!0),onInput:e[3]||(e[3]=l=>s.clearError("firstName"))},null,34),[[et,s.form.firstName]]),s.errors.firstName?(n(),i("div",jb,r(s.errors.firstName),1)):g("",!0)]),t("div",Hb,[e[55]||(e[55]=t("label",{for:"lastName",class:"form-label required"},"Фамилия",-1)),E(t("input",{id:"lastName","onUpdate:modelValue":e[4]||(e[4]=l=>s.form.lastName=l),type:"text",class:h(["form-control",{"is-invalid":s.errors.lastName,"is-valid":!s.errors.lastName&&s.form.lastName&&s.touched.lastName}]),required:"",onBlur:e[5]||(e[5]=l=>s.touched.lastName=!0),onInput:e[6]||(e[6]=l=>s.clearError("lastName"))},null,34),[[et,s.form.lastName]]),s.errors.lastName?(n(),i("div",zb,r(s.errors.lastName),1)):g("",!0)]),t("div",Zb,[e[56]||(e[56]=t("label",{for:"middleName",class:"form-label"},"Отчество",-1)),E(t("input",{id:"middleName","onUpdate:modelValue":e[7]||(e[7]=l=>s.form.middleName=l),type:"text",class:"form-control",onInput:e[8]||(e[8]=l=>s.clearError("middleName"))},null,544),[[et,s.form.middleName]])]),t("div",Wb,[e[57]||(e[57]=t("label",{for:"email",class:"form-label required"},"Email",-1)),E(t("input",{id:"email","onUpdate:modelValue":e[9]||(e[9]=l=>s.form.email=l),type:"email",class:h(["form-control",{"is-invalid":s.errors.email,"is-valid":!s.errors.email&&s.form.email&&s.touched.email}]),required:"",onBlur:e[10]||(e[10]=l=>s.touched.email=!0),onInput:e[11]||(e[11]=l=>s.clearError("email"))},null,34),[[et,s.form.email]]),s.errors.email?(n(),i("div",Yb,r(s.errors.email),1)):g("",!0)]),t("div",Gb,[e[58]||(e[58]=t("label",{for:"birthDate",class:"form-label"},"Дата рождения",-1)),E(t("input",{id:"birthDate","onUpdate:modelValue":e[12]||(e[12]=l=>s.form.birthDate=l),type:"date",class:"form-control",onInput:e[13]||(e[13]=l=>s.clearError("birthDate"))},null,544),[[et,s.form.birthDate]])]),t("div",Qb,[e[60]||(e[60]=t("label",{for:"gender",class:"form-label"},"Пол",-1)),E(t("select",{id:"gender","onUpdate:modelValue":e[14]||(e[14]=l=>s.form.gender=l),class:"form-select",onChange:e[15]||(e[15]=l=>s.clearError("gender"))},e[59]||(e[59]=[t("option",{value:""},"Не указан",-1),t("option",{value:"male"},"Мужской",-1),t("option",{value:"female"},"Женский",-1)]),544),[[ot,s.form.gender]])]),t("div",Kb,[e[61]||(e[61]=t("label",{for:"bio",class:"form-label"},"О себе",-1)),E(t("textarea",{id:"bio","onUpdate:modelValue":e[16]||(e[16]=l=>s.form.bio=l),class:"form-control",rows:"3",placeholder:"Расскажите немного о себе...",onInput:e[17]||(e[17]=l=>s.clearError("bio"))},null,544),[[et,s.form.bio]]),t("div",Xb," Максимум 500 символов. Осталось: "+r(500-(((o=s.form.bio)==null?void 0:o.length)||0)),1)])])]),t("div",Jb,[t("div",th,[t("div",eh,[e[62]||(e[62]=t("label",{for:"employeeId",class:"form-label"},"Табельный номер",-1)),E(t("input",{id:"employeeId","onUpdate:modelValue":e[18]||(e[18]=l=>s.form.employeeId=l),type:"text",class:"form-control",onInput:e[19]||(e[19]=l=>s.clearError("employeeId"))},null,544),[[et,s.form.employeeId]])]),t("div",sh,[e[64]||(e[64]=t("label",{for:"department",class:"form-label"},"Отдел",-1)),E(t("select",{id:"department","onUpdate:modelValue":e[20]||(e[20]=l=>s.form.department=l),class:"form-select",onChange:e[21]||(e[21]=l=>s.clearError("department"))},[e[63]||(e[63]=t("option",{value:""},"Выберите отдел",-1)),(n(!0),i(H,null,G(s.departments,l=>(n(),i("option",{key:l,value:l},r(l),9,ah))),128))],544),[[ot,s.form.department]])]),t("div",oh,[e[65]||(e[65]=t("label",{for:"position",class:"form-label"},"Должность",-1)),E(t("input",{id:"position","onUpdate:modelValue":e[22]||(e[22]=l=>s.form.position=l),type:"text",class:"form-control",onInput:e[23]||(e[23]=l=>s.clearError("position"))},null,544),[[et,s.form.position]])]),t("div",nh,[e[66]||(e[66]=t("label",{for:"manager",class:"form-label"},"Руководитель",-1)),E(t("input",{id:"manager","onUpdate:modelValue":e[24]||(e[24]=l=>s.form.manager=l),type:"text",class:"form-control",onInput:e[25]||(e[25]=l=>s.clearError("manager"))},null,544),[[et,s.form.manager]])]),t("div",ih,[e[67]||(e[67]=t("label",{for:"hireDate",class:"form-label"},"Дата приема на работу",-1)),E(t("input",{id:"hireDate","onUpdate:modelValue":e[26]||(e[26]=l=>s.form.hireDate=l),type:"date",class:"form-control",onInput:e[27]||(e[27]=l=>s.clearError("hireDate"))},null,544),[[et,s.form.hireDate]])]),t("div",lh,[e[69]||(e[69]=t("label",{for:"workLocation",class:"form-label"},"Место работы",-1)),E(t("select",{id:"workLocation","onUpdate:modelValue":e[28]||(e[28]=l=>s.form.workLocation=l),class:"form-select",onChange:e[29]||(e[29]=l=>s.clearError("workLocation"))},e[68]||(e[68]=[rt('<option value="" data-v-a3ecbd75>Выберите офис</option><option value="main" data-v-a3ecbd75>Главный офис</option><option value="branch1" data-v-a3ecbd75>Филиал 1</option><option value="branch2" data-v-a3ecbd75>Филиал 2</option><option value="remote" data-v-a3ecbd75>Удаленная работа</option>',5)]),544),[[ot,s.form.workLocation]])]),t("div",rh,[e[72]||(e[72]=t("label",{for:"skills",class:"form-label"},"Навыки и компетенции",-1)),t("div",dh,[E(t("input",{"onUpdate:modelValue":e[30]||(e[30]=l=>s.newSkill=l),type:"text",class:"form-control",placeholder:"Добавить навык...",onKeyup:e[31]||(e[31]=me((...l)=>s.addSkill&&s.addSkill(...l),["enter"]))},null,544),[[et,s.newSkill]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:e[32]||(e[32]=(...l)=>s.addSkill&&s.addSkill(...l))},e[70]||(e[70]=[t("i",{class:"fas fa-plus"},null,-1)]))]),t("div",ch,[(n(!0),i(H,null,G(s.form.skills,(l,v)=>(n(),i("span",{key:v,class:"skill-tag"},[c(r(l)+" ",1),t("button",{type:"button",class:"skill-remove",onClick:f=>s.removeSkill(v)},e[71]||(e[71]=[t("i",{class:"fas fa-times"},null,-1)]),8,uh)]))),128))])])])]),t("div",mh,[t("div",vh,[t("div",fh,[e[73]||(e[73]=t("label",{for:"phone",class:"form-label"},"Рабочий телефон",-1)),E(t("input",{id:"phone","onUpdate:modelValue":e[33]||(e[33]=l=>s.form.phone=l),type:"tel",class:h(["form-control",{"is-invalid":s.errors.phone,"is-valid":!s.errors.phone&&s.form.phone&&s.touched.phone}]),onBlur:e[34]||(e[34]=l=>s.touched.phone=!0),onInput:e[35]||(e[35]=l=>s.clearError("phone"))},null,34),[[et,s.form.phone]]),s.errors.phone?(n(),i("div",gh,r(s.errors.phone),1)):g("",!0)]),t("div",ph,[e[74]||(e[74]=t("label",{for:"personalPhone",class:"form-label"},"Личный телефон",-1)),E(t("input",{id:"personalPhone","onUpdate:modelValue":e[36]||(e[36]=l=>s.form.personalPhone=l),type:"tel",class:"form-control",onInput:e[37]||(e[37]=l=>s.clearError("personalPhone"))},null,544),[[et,s.form.personalPhone]])]),t("div",bh,[e[75]||(e[75]=t("label",{for:"address",class:"form-label"},"Адрес",-1)),E(t("textarea",{id:"address","onUpdate:modelValue":e[38]||(e[38]=l=>s.form.address=l),class:"form-control",rows:"2",placeholder:"Город, улица, дом...",onInput:e[39]||(e[39]=l=>s.clearError("address"))},null,544),[[et,s.form.address]])]),t("div",hh,[e[77]||(e[77]=t("label",{for:"socialLinkedIn",class:"form-label"},"LinkedIn",-1)),t("div",_h,[e[76]||(e[76]=t("span",{class:"input-group-text"},[t("i",{class:"fab fa-linkedin"})],-1)),E(t("input",{id:"socialLinkedIn","onUpdate:modelValue":e[40]||(e[40]=l=>s.form.socialLinkedIn=l),type:"url",class:"form-control",placeholder:"https://linkedin.com/in/username",onInput:e[41]||(e[41]=l=>s.clearError("socialLinkedIn"))},null,544),[[et,s.form.socialLinkedIn]])])]),t("div",yh,[e[79]||(e[79]=t("label",{for:"socialTelegram",class:"form-label"},"Telegram",-1)),t("div",wh,[e[78]||(e[78]=t("span",{class:"input-group-text"},[t("i",{class:"fab fa-telegram"})],-1)),E(t("input",{id:"socialTelegram","onUpdate:modelValue":e[42]||(e[42]=l=>s.form.socialTelegram=l),type:"text",class:"form-control",placeholder:"@username",onInput:e[43]||(e[43]=l=>s.clearError("socialTelegram"))},null,544),[[et,s.form.socialTelegram]])])])])]),t("div",kh,[t("div",Ch,[e[92]||(e[92]=t("div",{class:"col-12"},[t("h6",{class:"settings-section-title"},[t("i",{class:"fas fa-bell me-2"}),c(" Уведомления ")])],-1)),t("div",xh,[t("div",Sh,[E(t("input",{id:"notifyEmail","onUpdate:modelValue":e[44]||(e[44]=l=>s.form.preferences.emailNotifications=l),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.preferences.emailNotifications]]),e[80]||(e[80]=t("label",{class:"form-check-label",for:"notifyEmail"}," Email уведомления ",-1)),e[81]||(e[81]=t("small",{class:"form-text text-muted d-block"}," Получать уведомления о новых мероприятиях и изменениях на email ",-1))])]),t("div",$h,[t("div",Ph,[E(t("input",{id:"notifyEvents","onUpdate:modelValue":e[45]||(e[45]=l=>s.form.preferences.eventReminders=l),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.preferences.eventReminders]]),e[82]||(e[82]=t("label",{class:"form-check-label",for:"notifyEvents"}," Напоминания о мероприятиях ",-1)),e[83]||(e[83]=t("small",{class:"form-text text-muted d-block"}," Получать напоминания за день до мероприятия ",-1))])]),t("div",Dh,[t("div",Th,[E(t("input",{id:"notifyAchievements","onUpdate:modelValue":e[46]||(e[46]=l=>s.form.preferences.achievementNotifications=l),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.preferences.achievementNotifications]]),e[84]||(e[84]=t("label",{class:"form-check-label",for:"notifyAchievements"}," Уведомления о достижениях ",-1)),e[85]||(e[85]=t("small",{class:"form-text text-muted d-block"}," Получать уведомления о новых достижениях и прогрессе ",-1))])]),e[93]||(e[93]=t("div",{class:"col-12"},[t("h6",{class:"settings-section-title"},[t("i",{class:"fas fa-eye me-2"}),c(" Приватность ")])],-1)),t("div",Mh,[t("div",Ih,[E(t("input",{id:"profilePublic","onUpdate:modelValue":e[47]||(e[47]=l=>s.form.preferences.publicProfile=l),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.preferences.publicProfile]]),e[86]||(e[86]=t("label",{class:"form-check-label",for:"profilePublic"}," Публичный профиль ",-1)),e[87]||(e[87]=t("small",{class:"form-text text-muted d-block"}," Разрешить другим пользователям видеть ваш профиль ",-1))])]),t("div",Ah,[t("div",Rh,[E(t("input",{id:"showInRating","onUpdate:modelValue":e[48]||(e[48]=l=>s.form.preferences.showInLeaderboard=l),class:"form-check-input",type:"checkbox"},null,512),[[Tt,s.form.preferences.showInLeaderboard]]),e[88]||(e[88]=t("label",{class:"form-check-label",for:"showInRating"}," Участие в рейтинге ",-1)),e[89]||(e[89]=t("small",{class:"form-text text-muted d-block"}," Отображать ваши результаты в общем рейтинге ",-1))])]),t("div",Eh,[e[91]||(e[91]=t("label",{for:"timezone",class:"form-label"},"Часовой пояс",-1)),E(t("select",{id:"timezone","onUpdate:modelValue":e[49]||(e[49]=l=>s.form.preferences.timezone=l),class:"form-select"},e[90]||(e[90]=[rt('<option value="Europe/Moscow" data-v-a3ecbd75>Москва (UTC+3)</option><option value="Europe/Kaliningrad" data-v-a3ecbd75>Калининград (UTC+2)</option><option value="Asia/Yekaterinburg" data-v-a3ecbd75>Екатеринбург (UTC+5)</option><option value="Asia/Novosibirsk" data-v-a3ecbd75>Новосибирск (UTC+7)</option><option value="Asia/Vladivostok" data-v-a3ecbd75>Владивосток (UTC+10)</option>',5)]),512),[[ot,s.form.preferences.timezone]])])])])])]),t("div",Nh,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[50]||(e[50]=(...l)=>s.closeModal&&s.closeModal(...l))}," Отмена "),t("button",{type:"submit",class:"btn btn-primary",disabled:s.isSubmitting||!s.isFormValid},[s.isSubmitting?(n(),i("span",Lh)):(n(),i("i",Vh)),c(" "+r(s.isSubmitting?"Сохранение...":"Сохранить изменения"),1)],8,Uh)])],32)])])],6),d.modelValue?(n(),i("div",{key:0,class:"modal-backdrop fade show",onClick:e[52]||(e[52]=(...l)=>s.closeModal&&s.closeModal(...l))})):g("",!0)],64)}const Fh=J(Eb,[["render",Bh],["__scopeId","data-v-a3ecbd75"]]),Oh={name:"AvatarUploadModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","uploaded"],setup(a,{emit:e}){const d=mt(),s=pt(),m=w(!1),u=w("file"),o=w(null),l=w(""),v=w(!1),f=w(""),_=w(1),M=w(null),R=w(null),k=w(""),V=w(null),I=w(null),F=w(null),$=w(null),x=w(null);let y=null;const D=5,L=["image/jpeg","image/png","image/gif"],W=w([{id:1,name:"Аватар 1",url:"/avatars/preset-1.svg"},{id:2,name:"Аватар 2",url:"/avatars/preset-2.svg"},{id:3,name:"Аватар 3",url:"/avatars/preset-3.svg"},{id:4,name:"Аватар 4",url:"/avatars/preset-4.svg"},{id:5,name:"Аватар 5",url:"/avatars/preset-5.svg"},{id:6,name:"Аватар 6",url:"/avatars/preset-6.svg"}]),q=j(()=>{var Y;return((Y=s.user)==null?void 0:Y.avatar)||""}),O=j(()=>o.value||M.value||k.value),C=Y=>L.includes(Y.type)?Y.size>D*1024*1024?`Размер файла не должен превышать ${D}MB.`:"":"Неподдерживаемый формат файла. Используйте JPG, PNG или GIF.",b=Y=>{if(Y===0)return"0 Bytes";const vt=1024,Et=["Bytes","KB","MB"],Ft=Math.floor(Math.log(Y)/Math.log(vt));return parseFloat((Y/Math.pow(vt,Ft)).toFixed(2))+" "+Et[Ft]},B=()=>{var Y;(Y=V.value)==null||Y.click()},at=Y=>{const vt=Y.target.files[0];vt&&T(vt)},p=Y=>{v.value=!1;const vt=Y.dataTransfer.files[0];vt&&T(vt)},T=Y=>{f.value="";const vt=C(Y);if(vt){f.value=vt;return}o.value=Y,M.value=null;const Et=new FileReader;Et.onload=Ft=>{l.value=Ft.target.result,P()},Et.readAsDataURL(Y)},P=async()=>{await nextTick(),I.value&&window.Cropper&&(y&&y.destroy(),y=new window.Cropper(I.value,{aspectRatio:1,viewMode:1,dragMode:"move",autoCropArea:.8,restore:!1,guides:!1,center:!1,highlight:!1,cropBoxMovable:!1,cropBoxResizable:!1,toggleDragModeOnDblclick:!1,crop:U}))},z=()=>{y&&(y.scale(parseFloat(_.value)),U())},it=Y=>{y&&(y.rotate(Y),U())},kt=()=>{y&&(y.reset(),_.value=1,U())},U=()=>{if(y&&$.value){const Y=y.getCroppedCanvas({width:150,height:150}),vt=$.value.getContext("2d");vt.clearRect(0,0,150,150),vt.drawImage(Y,0,0,150,150)}},S=async()=>{try{f.value="";const Y=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480}});R.value=Y,x.value&&(x.value.srcObject=Y)}catch(Y){console.error("Ошибка доступа к камере:",Y),f.value="Не удалось получить доступ к камере. Проверьте разрешения."}},Z=()=>{R.value&&(R.value.getTracks().forEach(Y=>Y.stop()),R.value=null)},X=()=>{if(x.value){const Y=document.createElement("canvas");Y.width=640,Y.height=480,Y.getContext("2d").drawImage(x.value,0,0,640,480),k.value=Y.toDataURL("image/jpeg",.8),Z()}},_t=()=>{k.value="",S()},gt=()=>{o.value=null,M.value=null},$t=Y=>{M.value=Y.id,o.value=null,l.value="",k.value="",f.value="",y&&(y.destroy(),y=null)},Pt=async()=>{try{m.value=!0,f.value="";let Y="";if(M.value)Y=W.value.find(Et=>Et.id===M.value).url;else if(k.value)Y=k.value;else if(y)Y=y.getCroppedCanvas({width:300,height:300}).toDataURL("image/jpeg",.8);else{f.value="Выберите изображение для загрузки";return}await new Promise(vt=>setTimeout(vt,2e3)),e("uploaded",Y),Nt(),d.success("Фото профиля успешно обновлено!")}catch(Y){console.error("Ошибка загрузки аватара:",Y),Y.value="Ошибка при загрузке фото. Попробуйте еще раз."}finally{m.value=!1}},Zt=async()=>{try{m.value=!0,await new Promise(Y=>setTimeout(Y,1e3)),e("uploaded",null),Nt(),d.success("Фото профиля удалено")}catch(Y){console.error("Ошибка удаления аватара:",Y),Y.value="Ошибка при удалении фото"}finally{m.value=!1}},Nt=()=>{Wt(),e("update:modelValue",!1)},Wt=()=>{o.value=null,l.value="",M.value=null,k.value="",f.value="",_.value=1,v.value=!1,u.value="file",y&&(y.destroy(),y=null),Z()};return Mt(()=>a.modelValue,Y=>{Y||Wt()}),dt(()=>{}),Lt(()=>{Z(),y&&y.destroy()}),{isUploading:m,uploadMethod:u,selectedFile:o,previewUrl:l,isDragOver:v,error:f,cropScale:_,selectedPreset:M,cameraStream:R,capturedImage:k,fileInput:V,cropperImage:I,cropperContainer:F,resultCanvas:$,videoElement:x,maxFileSize:D,presetAvatars:W,currentAvatar:q,canUpload:O,formatFileSize:b,triggerFileInput:B,handleFileSelect:at,handleFileDrop:p,updateCropScale:z,rotateCrop:it,resetCrop:kt,startCamera:S,stopCamera:Z,capturePhoto:X,retakePhoto:_t,useCapturedPhoto:gt,selectPresetAvatar:$t,uploadAvatar:Pt,removeAvatar:Zt,closeModal:Nt}}},qh={class:"modal-dialog"},jh={class:"modal-content"},Hh={class:"modal-header"},zh={class:"modal-body"},Zh={class:"current-avatar-section mb-4"},Wh={class:"current-avatar"},Yh={key:0,class:"avatar-image"},Gh=["src"],Qh={key:1,class:"avatar-placeholder"},Kh={class:"upload-methods mb-4"},Xh={class:"row g-3"},Jh={class:"col-md-6"},t0={class:"col-md-6"},e0={key:0,class:"file-upload-section"},s0={key:0,class:"drop-zone-content"},a0={class:"text-muted"},o0={key:1,class:"file-info"},n0={class:"mb-1"},i0={class:"text-muted"},l0={key:0,class:"preview-section mt-4"},r0={class:"preview-container"},d0={class:"cropper-container",ref:"cropperContainer"},c0=["src"],u0={class:"crop-controls"},m0={class:"control-group"},v0={class:"control-buttons"},f0={class:"crop-result"},g0={class:"result-preview"},p0={ref:"resultCanvas",width:"150",height:"150"},b0={key:1,class:"camera-section"},h0={key:0,class:"camera-start"},_0={class:"camera-placeholder"},y0={key:1,class:"camera-active"},w0={ref:"videoElement",autoplay:"",muted:"",class:"camera-video"},k0={class:"camera-controls"},C0={key:2,class:"captured-photo"},x0=["src"],S0={class:"capture-controls"},$0={class:"preset-avatars-section mt-4"},P0={class:"preset-avatars"},D0=["onClick"],T0=["src","alt"],M0={key:2,class:"alert alert-danger mt-3"},I0={class:"modal-footer"},A0=["disabled"],R0=["disabled"],E0={key:0,class:"spinner-border spinner-border-sm me-2"},N0={key:1,class:"fas fa-save me-2"};function U0(a,e,d,s,m,u){return n(),i(H,null,[t("div",{class:h(["modal fade",{show:d.modelValue}]),style:st({display:d.modelValue?"block":"none"}),tabindex:"-1","aria-labelledby":"avatarUploadModalLabel","aria-hidden":"true"},[t("div",qh,[t("div",jh,[t("div",Hh,[e[22]||(e[22]=t("h5",{id:"avatarUploadModalLabel",class:"modal-title"},[t("i",{class:"fas fa-camera me-2"}),c(" Изменить фото профиля ")],-1)),t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...o)=>s.closeModal&&s.closeModal(...o)),"aria-label":"Закрыть"})]),t("div",zh,[t("div",Zh,[t("div",Wh,[s.currentAvatar?(n(),i("div",Yh,[t("img",{src:s.currentAvatar,alt:"Текущее фото"},null,8,Gh)])):(n(),i("div",Qh,e[23]||(e[23]=[t("i",{class:"fas fa-user"},null,-1)])))]),e[24]||(e[24]=t("p",{class:"text-center text-muted mt-2"},"Текущее фото",-1))]),t("div",Kh,[t("div",Xh,[t("div",Jh,[t("div",{class:h(["upload-option",{active:s.uploadMethod==="file"}]),onClick:e[1]||(e[1]=o=>s.uploadMethod="file")},e[25]||(e[25]=[t("i",{class:"fas fa-upload"},null,-1),t("span",null,"Загрузить файл",-1)]),2)]),t("div",t0,[t("div",{class:h(["upload-option",{active:s.uploadMethod==="camera"}]),onClick:e[2]||(e[2]=o=>s.uploadMethod="camera")},e[26]||(e[26]=[t("i",{class:"fas fa-camera"},null,-1),t("span",null,"Сделать фото",-1)]),2)])])]),s.uploadMethod==="file"?(n(),i("div",e0,[t("div",{class:h(["file-drop-zone",{"drag-over":s.isDragOver,"has-file":s.selectedFile&&!s.previewUrl}]),onDragover:e[4]||(e[4]=lt(o=>s.isDragOver=!0,["prevent"])),onDragleave:e[5]||(e[5]=lt(o=>s.isDragOver=!1,["prevent"])),onDrop:e[6]||(e[6]=lt((...o)=>s.handleFileDrop&&s.handleFileDrop(...o),["prevent"])),onClick:e[7]||(e[7]=(...o)=>s.triggerFileInput&&s.triggerFileInput(...o))},[t("input",{ref:"fileInput",type:"file",accept:"image/*",onChange:e[3]||(e[3]=(...o)=>s.handleFileSelect&&s.handleFileSelect(...o)),style:{display:"none"}},null,544),s.selectedFile?s.previewUrl?g("",!0):(n(),i("div",o0,[e[29]||(e[29]=t("i",{class:"fas fa-file-image"},null,-1)),t("p",n0,r(s.selectedFile.name),1),t("small",i0,r(s.formatFileSize(s.selectedFile.size)),1)])):(n(),i("div",s0,[e[27]||(e[27]=t("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e[28]||(e[28]=t("p",{class:"mb-2"},"Перетащите изображение сюда или нажмите для выбора",-1)),t("small",a0," Поддерживаются форматы: JPG, PNG, GIF (макс. "+r(s.maxFileSize)+"MB) ",1)]))],34),s.previewUrl?(n(),i("div",l0,[t("div",r0,[t("div",d0,[t("img",{ref:"cropperImage",src:s.previewUrl,alt:"Предварительный просмотр"},null,8,c0)],512),t("div",u0,[t("div",m0,[e[30]||(e[30]=t("label",null,"Масштаб:",-1)),E(t("input",{type:"range",min:"0.5",max:"3",step:"0.1","onUpdate:modelValue":e[8]||(e[8]=o=>s.cropScale=o),onInput:e[9]||(e[9]=(...o)=>s.updateCropScale&&s.updateCropScale(...o)),class:"form-range"},null,544),[[et,s.cropScale]])]),t("div",v0,[t("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[10]||(e[10]=o=>s.rotateCrop(-90))},e[31]||(e[31]=[t("i",{class:"fas fa-undo"},null,-1)])),t("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[11]||(e[11]=o=>s.rotateCrop(90))},e[32]||(e[32]=[t("i",{class:"fas fa-redo"},null,-1)])),t("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[12]||(e[12]=(...o)=>s.resetCrop&&s.resetCrop(...o))},e[33]||(e[33]=[t("i",{class:"fas fa-refresh"},null,-1)]))])])]),t("div",f0,[t("div",g0,[t("canvas",p0,null,512)]),e[34]||(e[34]=t("p",{class:"text-center text-muted mt-2"},"Результат",-1))])])):g("",!0)])):g("",!0),s.uploadMethod==="camera"?(n(),i("div",b0,[!s.cameraStream&&!s.capturedImage?(n(),i("div",h0,[t("div",_0,[e[36]||(e[36]=t("i",{class:"fas fa-video"},null,-1)),e[37]||(e[37]=t("p",null,"Нажмите для включения камеры",-1)),t("button",{class:"btn btn-primary",onClick:e[13]||(e[13]=(...o)=>s.startCamera&&s.startCamera(...o))},e[35]||(e[35]=[t("i",{class:"fas fa-play me-2"},null,-1),c(" Включить камеру ",-1)]))])])):g("",!0),s.cameraStream&&!s.capturedImage?(n(),i("div",y0,[t("video",w0,null,512),t("div",k0,[t("button",{class:"btn btn-primary btn-lg",onClick:e[14]||(e[14]=(...o)=>s.capturePhoto&&s.capturePhoto(...o))},e[38]||(e[38]=[t("i",{class:"fas fa-camera"},null,-1)])),t("button",{class:"btn btn-secondary",onClick:e[15]||(e[15]=(...o)=>s.stopCamera&&s.stopCamera(...o))},e[39]||(e[39]=[t("i",{class:"fas fa-stop"},null,-1)]))])])):g("",!0),s.capturedImage?(n(),i("div",C0,[t("img",{src:s.capturedImage,alt:"Снятое фото",class:"captured-image"},null,8,x0),t("div",S0,[t("button",{class:"btn btn-outline-secondary",onClick:e[16]||(e[16]=(...o)=>s.retakePhoto&&s.retakePhoto(...o))},e[40]||(e[40]=[t("i",{class:"fas fa-redo me-2"},null,-1),c(" Переснять ",-1)])),t("button",{class:"btn btn-primary",onClick:e[17]||(e[17]=(...o)=>s.useCapturedPhoto&&s.useCapturedPhoto(...o))},e[41]||(e[41]=[t("i",{class:"fas fa-check me-2"},null,-1),c(" Использовать это фото ",-1)]))])])):g("",!0)])):g("",!0),t("div",$0,[e[42]||(e[42]=t("h6",{class:"mb-3"},[t("i",{class:"fas fa-user-circle me-2"}),c(" Или выберите готовый аватар ")],-1)),t("div",P0,[(n(!0),i(H,null,G(s.presetAvatars,o=>(n(),i("div",{key:o.id,class:h(["preset-avatar",{selected:s.selectedPreset===o.id}]),onClick:l=>s.selectPresetAvatar(o)},[t("img",{src:o.url,alt:o.name},null,8,T0)],10,D0))),128))])]),s.error?(n(),i("div",M0,[e[43]||(e[43]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),c(" "+r(s.error),1)])):g("",!0)]),t("div",I0,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[18]||(e[18]=(...o)=>s.closeModal&&s.closeModal(...o))}," Отмена "),s.currentAvatar?(n(),i("button",{key:0,type:"button",class:"btn btn-danger",onClick:e[19]||(e[19]=(...o)=>s.removeAvatar&&s.removeAvatar(...o)),disabled:s.isUploading},e[44]||(e[44]=[t("i",{class:"fas fa-trash me-2"},null,-1),c(" Удалить фото ",-1)]),8,A0)):g("",!0),t("button",{type:"button",class:"btn btn-primary",onClick:e[20]||(e[20]=(...o)=>s.uploadAvatar&&s.uploadAvatar(...o)),disabled:!s.canUpload||s.isUploading},[s.isUploading?(n(),i("span",E0)):(n(),i("i",N0)),c(" "+r(s.isUploading?"Загрузка...":"Сохранить"),1)],8,R0)])])])],6),d.modelValue?(n(),i("div",{key:0,class:"modal-backdrop fade show",onClick:e[21]||(e[21]=(...o)=>s.closeModal&&s.closeModal(...o))})):g("",!0)],64)}const L0=J(Oh,[["render",U0],["__scopeId","data-v-f133b006"]]),V0={name:"ProfilePage",components:{ProfileEventsTab:zf,ProfilePurchasesTab:bg,ProfilePointsTab:Mp,ProfileAchievementsTab:Rb,ProfileEditModal:Fh,AvatarUploadModal:L0},setup(){const a=bt(),e=mt(),d=pt(),s=ut(),m=w(!1),u=w(!1),o=w({totalPoints:0,eventsAttended:0,eventsRegistered:0,purchasesMade:0,pointsSpent:0,currentRank:null,rankChange:0}),l=w([]),v=j(()=>{const b=d.user;return b?[b.lastName,b.firstName,b.middleName].filter(Boolean).join(" "):""}),f=j(()=>{var p,T;const b=d.user;if(!b)return"";const B=((p=b.firstName)==null?void 0:p[0])||"",at=((T=b.lastName)==null?void 0:T[0])||"";return(B+at).toUpperCase()}),_=j(()=>{if(!d.user)return 0;let B=0;const at=M.value.length;return M.value.forEach(p=>{p.completed&&B++}),Math.round(B/at*100)}),M=j(()=>{const b=d.user;return b?[{key:"basic_info",label:"Основная информация",completed:!!(b.firstName&&b.lastName&&b.email)},{key:"avatar",label:"Фото профиля",completed:!!b.avatar},{key:"contacts",label:"Контактные данные",completed:!!b.phone},{key:"work_info",label:"Рабочая информация",completed:!!(b.department&&b.position)},{key:"first_event",label:"Первое мероприятие",completed:o.value.eventsAttended>0},{key:"first_purchase",label:"Первая покупка",completed:o.value.purchasesMade>0}]:[]}),R=b=>s.formatNumber(b),k=b=>s.formatDate(b,"dd MMM yyyy"),V=b=>({user:"Сотрудник",moderator:"Модератор",admin:"Администратор"})[b]||"Пользователь",I=b=>({attended:"status-success",registered:"status-info",cancelled:"status-warning",missed:"status-danger"})[b]||"status-default",F=b=>({attended:"Посещено",registered:"Зарегистрирован",cancelled:"Отменено",missed:"Пропущено"})[b]||"Неизвестно",$=async()=>{try{o.value={totalPoints:Math.floor(Math.random()*5e3)+1e3,eventsAttended:Math.floor(Math.random()*30)+5,eventsRegistered:Math.floor(Math.random()*10)+2,purchasesMade:Math.floor(Math.random()*20)+3,pointsSpent:Math.floor(Math.random()*2e3)+500,currentRank:Math.floor(Math.random()*100)+1,rankChange:Math.floor(Math.random()*21)-10}}catch(b){console.error("Ошибка загрузки статистики пользователя:",b)}},x=async()=>{try{l.value=[{id:"1",title:"Тренинг по лидерству",date:new Date(Date.now()-864e5*2),status:"attended",pointsEarned:100},{id:"2",title:"Корпоративный хакатон",date:new Date(Date.now()-864e5*7),status:"attended",pointsEarned:200},{id:"3",title:"Обучение по безопасности",date:new Date(Date.now()+864e5*3),status:"registered",pointsEarned:null}]}catch(b){console.error("Ошибка загрузки недавних мероприятий:",b)}},y=()=>{const b=document.getElementById("activityChart");if(b){const B=b.getContext("2d");B.fillStyle="#e9ecef",B.fillRect(0,0,b.width,b.height),B.fillStyle="#333",B.font="16px Arial",B.textAlign="center",B.fillText("График активности",b.width/2,b.height/2)}},D=b=>{d.updateUser(b),e.success("Профиль успешно обновлен")},L=b=>{d.updateUser({...d.user,avatar:b}),e.success("Фото профиля обновлено")},W=()=>{e.info("Функция смены пароля будет доступна в следующей версии")},q=()=>{e.info("Настройки уведомлений будут доступны в следующей версии")},O=()=>{e.info("Скачивание отчета будет доступно в следующей версии")},C=async()=>{try{await d.logout(),a.push("/login"),e.success("Вы успешно вышли из системы")}catch{e.error("Ошибка при выходе из системы")}};return dt(async()=>{s.setPageTitle("Мой профиль"),await Promise.all([$(),x()]),setTimeout(y,100)}),{authStore:d,showEditModal:m,showAvatarModal:u,userStats:o,recentEvents:l,fullName:v,initials:f,profileCompletion:_,completionItems:M,formatNumber:R,formatDate:k,getRoleDisplayName:V,getEventStatusClass:I,getEventStatusLabel:F,handleProfileUpdate:D,handleAvatarUpdate:L,changePassword:W,toggleNotifications:q,downloadReport:O,logout:C}}},B0={class:"profile-page"},F0={class:"profile-header mb-4"},O0={class:"row align-items-center"},q0={class:"col-md-8"},j0={class:"profile-info d-flex align-items-center"},H0={class:"profile-avatar me-3"},z0={key:0,class:"avatar-image"},Z0=["src","alt"],W0={key:1,class:"avatar-initials"},Y0={class:"profile-details"},G0={class:"profile-name mb-2"},Q0={class:"profile-meta"},K0={class:"profile-role"},X0={key:0,class:"profile-department"},J0={key:1,class:"profile-position"},t_={class:"col-md-4 text-md-end"},e_={class:"profile-actions"},s_={class:"dropdown d-inline-block"},a_={class:"dropdown-menu"},o_={class:"profile-stats mb-4"},n_={class:"row g-3"},i_={class:"col-lg-3 col-md-6"},l_={class:"stat-card points-card"},r_={class:"stat-content"},d_={class:"stat-value"},c_={class:"stat-change"},u_={class:"col-lg-3 col-md-6"},m_={class:"stat-card events-card"},v_={class:"stat-content"},f_={class:"stat-value"},g_={class:"stat-change"},p_={class:"col-lg-3 col-md-6"},b_={class:"stat-card purchases-card"},h_={class:"stat-content"},__={class:"stat-value"},y_={class:"stat-change"},w_={class:"col-lg-3 col-md-6"},k_={class:"stat-card rank-card"},C_={class:"stat-content"},x_={class:"stat-value"},S_={class:"stat-change"},$_={class:"profile-navigation mb-4"},P_={class:"nav nav-pills",role:"tablist"},D_={class:"nav-item",role:"presentation"},T_={class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#events-tab",type:"button",role:"tab"},M_={key:0,class:"nav-badge"},I_={class:"tab-content"},A_={class:"tab-pane fade show active",id:"overview-tab",role:"tabpanel"},R_={class:"row"},E_={class:"col-lg-8"},N_={class:"profile-card recent-events-card"},U_={class:"card-header d-flex justify-content-between align-items-center"},L_={class:"card-body"},V_={key:0,class:"empty-state text-center py-4"},B_={key:1,class:"events-timeline"},F_={class:"timeline-content"},O_={class:"timeline-title"},q_={class:"timeline-date"},j_={key:0,class:"timeline-points"},H_={class:"col-lg-4"},z_={class:"profile-card completion-card mb-4"},Z_={class:"card-body text-center"},W_={class:"completion-circle mb-3"},Y_={class:"progress-text"},G_={class:"completion-items"},Q_={class:"profile-card quick-links-card"},K_={class:"card-body"},X_={class:"quick-links"},J_={class:"tab-pane fade",id:"events-tab",role:"tabpanel"},ty={class:"tab-pane fade",id:"purchases-tab",role:"tabpanel"},ey={class:"tab-pane fade",id:"points-tab",role:"tabpanel"},sy={class:"tab-pane fade",id:"achievements-tab",role:"tabpanel"};function ay(a,e,d,s,m,u){var k,V,I,F,$;const o=Q("router-link"),l=Q("ProfileEventsTab"),v=Q("ProfilePurchasesTab"),f=Q("ProfilePointsTab"),_=Q("ProfileAchievementsTab"),M=Q("ProfileEditModal"),R=Q("AvatarUploadModal");return n(),i("div",B0,[t("div",F0,[t("div",O0,[t("div",q0,[t("div",j0,[t("div",H0,[(k=s.authStore.user)!=null&&k.avatar?(n(),i("div",z0,[t("img",{src:s.authStore.user.avatar,alt:s.fullName},null,8,Z0)])):(n(),i("div",W0,r(s.initials),1)),t("button",{class:"avatar-edit-btn",onClick:e[0]||(e[0]=x=>s.showAvatarModal=!0)},e[8]||(e[8]=[t("i",{class:"fas fa-camera"},null,-1)]))]),t("div",Y0,[t("h1",G0,r(s.fullName),1),t("div",Q0,[t("span",K0,[e[9]||(e[9]=t("i",{class:"fas fa-user-tag me-1"},null,-1)),c(" "+r(s.getRoleDisplayName((V=s.authStore.user)==null?void 0:V.role)),1)]),(I=s.authStore.user)!=null&&I.department?(n(),i("span",X0,[e[10]||(e[10]=t("i",{class:"fas fa-building me-1"},null,-1)),c(" "+r(s.authStore.user.department),1)])):g("",!0),(F=s.authStore.user)!=null&&F.position?(n(),i("span",J0,[e[11]||(e[11]=t("i",{class:"fas fa-briefcase me-1"},null,-1)),c(" "+r(s.authStore.user.position),1)])):g("",!0)])])])]),t("div",t_,[t("div",e_,[t("button",{class:"btn btn-outline-primary me-2",onClick:e[1]||(e[1]=x=>s.showEditModal=!0)},e[12]||(e[12]=[t("i",{class:"fas fa-edit me-2"},null,-1),c(" Редактировать ",-1)])),t("div",s_,[e[17]||(e[17]=t("button",{class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[t("i",{class:"fas fa-cog"})],-1)),t("ul",a_,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=lt((...x)=>s.changePassword&&s.changePassword(...x),["prevent"]))},e[13]||(e[13]=[t("i",{class:"fas fa-key me-2"},null,-1),c(" Сменить пароль ",-1)]))]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=lt((...x)=>s.toggleNotifications&&s.toggleNotifications(...x),["prevent"]))},e[14]||(e[14]=[t("i",{class:"fas fa-bell me-2"},null,-1),c(" Настройки уведомлений ",-1)]))]),e[16]||(e[16]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[t("a",{class:"dropdown-item text-danger",href:"#",onClick:e[4]||(e[4]=lt((...x)=>s.logout&&s.logout(...x),["prevent"]))},e[15]||(e[15]=[t("i",{class:"fas fa-sign-out-alt me-2"},null,-1),c(" Выйти ",-1)]))])])])])])])]),t("div",o_,[t("div",n_,[t("div",i_,[t("div",l_,[e[20]||(e[20]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-coins"})],-1)),t("div",r_,[t("h3",d_,r(s.formatNumber(s.userStats.totalPoints)),1),e[19]||(e[19]=t("p",{class:"stat-label"},"Всего баллов заработано",-1)),t("div",c_,[e[18]||(e[18]=t("i",{class:"fas fa-coins text-warning me-1"},null,-1)),c(" "+r(s.formatNumber((($=s.authStore.user)==null?void 0:$.points)||0))+" доступно ",1)])])])]),t("div",u_,[t("div",m_,[e[23]||(e[23]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-calendar-check"})],-1)),t("div",v_,[t("h3",f_,r(s.userStats.eventsAttended),1),e[22]||(e[22]=t("p",{class:"stat-label"},"Мероприятий посещено",-1)),t("div",g_,[e[21]||(e[21]=t("i",{class:"fas fa-calendar text-info me-1"},null,-1)),c(" "+r(s.userStats.eventsRegistered)+" зарегистрировано ",1)])])])]),t("div",p_,[t("div",b_,[e[26]||(e[26]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-shopping-bag"})],-1)),t("div",h_,[t("h3",__,r(s.userStats.purchasesMade),1),e[25]||(e[25]=t("p",{class:"stat-label"},"Покупок совершено",-1)),t("div",y_,[e[24]||(e[24]=t("i",{class:"fas fa-coins text-success me-1"},null,-1)),c(" "+r(s.formatNumber(s.userStats.pointsSpent))+" потрачено ",1)])])])]),t("div",w_,[t("div",k_,[e[29]||(e[29]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-trophy"})],-1)),t("div",C_,[t("h3",x_,"#"+r(s.userStats.currentRank||"-"),1),e[28]||(e[28]=t("p",{class:"stat-label"},"Место в рейтинге",-1)),t("div",S_,[e[27]||(e[27]=t("i",{class:"fas fa-chart-line me-1"},null,-1)),c(" "+r(s.userStats.rankChange>0?"+":"")+r(s.userStats.rankChange||0),1)])])])])])]),t("div",$_,[t("ul",P_,[e[32]||(e[32]=t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active","data-bs-toggle":"pill","data-bs-target":"#overview-tab",type:"button",role:"tab"},[t("i",{class:"fas fa-chart-pie me-2"}),c(" Обзор ")])],-1)),t("li",D_,[t("button",T_,[e[30]||(e[30]=t("i",{class:"fas fa-calendar me-2"},null,-1)),e[31]||(e[31]=c(" Мероприятия ",-1)),s.userStats.eventsRegistered>0?(n(),i("span",M_,r(s.userStats.eventsRegistered),1)):g("",!0)])]),e[33]||(e[33]=t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#purchases-tab",type:"button",role:"tab"},[t("i",{class:"fas fa-shopping-cart me-2"}),c(" Покупки ")])],-1)),e[34]||(e[34]=t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#points-tab",type:"button",role:"tab"},[t("i",{class:"fas fa-coins me-2"}),c(" История баллов ")])],-1)),e[35]||(e[35]=t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#achievements-tab",type:"button",role:"tab"},[t("i",{class:"fas fa-medal me-2"}),c(" Достижения ")])],-1))])]),t("div",I_,[t("div",A_,[t("div",R_,[t("div",E_,[e[39]||(e[39]=rt('<div class="profile-card activity-chart-card mb-4" data-v-5b5840d3><div class="card-header" data-v-5b5840d3><h5 class="card-title mb-0" data-v-5b5840d3><i class="fas fa-chart-line me-2" data-v-5b5840d3></i> Активность по месяцам </h5></div><div class="card-body" data-v-5b5840d3><canvas id="activityChart" width="400" height="200" data-v-5b5840d3></canvas></div></div>',1)),t("div",N_,[t("div",U_,[e[37]||(e[37]=t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-calendar-alt me-2"}),c(" Последние мероприятия ")],-1)),A(o,{to:"/profile/events",class:"btn btn-sm btn-outline-primary"},{default:N(()=>e[36]||(e[36]=[c(" Все мероприятия ",-1)])),_:1,__:[36]})]),t("div",L_,[s.recentEvents.length===0?(n(),i("div",V_,e[38]||(e[38]=[t("i",{class:"fas fa-calendar-times text-muted mb-3",style:{"font-size":"2rem"}},null,-1),t("p",{class:"text-muted"},"Нет участий в мероприятиях",-1)]))):(n(),i("div",B_,[(n(!0),i(H,null,G(s.recentEvents.slice(0,5),x=>(n(),i("div",{key:x.id,class:"timeline-item"},[t("div",{class:h(["timeline-marker",s.getEventStatusClass(x.status)])},null,2),t("div",F_,[t("h6",O_,r(x.title),1),t("p",q_,r(s.formatDate(x.date)),1),t("span",{class:h(["timeline-status",s.getEventStatusClass(x.status)])},r(s.getEventStatusLabel(x.status)),3),x.pointsEarned?(n(),i("span",j_," +"+r(x.pointsEarned)+" баллов ",1)):g("",!0)])]))),128))]))])])]),t("div",H_,[t("div",z_,[e[40]||(e[40]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-user-check me-2"}),c(" Заполненность профиля ")])],-1)),t("div",Z_,[t("div",W_,[t("div",{class:"circle-progress",style:st({"--progress":s.profileCompletion})},[t("span",Y_,r(s.profileCompletion)+"%",1)],4)]),t("div",G_,[(n(!0),i(H,null,G(s.completionItems,x=>(n(),i("div",{key:x.key,class:h(["completion-item",{completed:x.completed}])},[t("i",{class:h(x.completed?"fas fa-check-circle":"far fa-circle")},null,2),t("span",null,r(x.label),1)],2))),128))])])]),t("div",Q_,[e[45]||(e[45]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"fas fa-external-link-alt me-2"}),c(" Быстрые действия ")])],-1)),t("div",K_,[t("div",X_,[A(o,{to:"/events",class:"quick-link"},{default:N(()=>e[41]||(e[41]=[t("i",{class:"fas fa-calendar-plus"},null,-1),t("span",null,"Найти мероприятие",-1)])),_:1,__:[41]}),A(o,{to:"/rewards",class:"quick-link"},{default:N(()=>e[42]||(e[42]=[t("i",{class:"fas fa-gift"},null,-1),t("span",null,"Обменять баллы",-1)])),_:1,__:[42]}),A(o,{to:"/leaderboard",class:"quick-link"},{default:N(()=>e[43]||(e[43]=[t("i",{class:"fas fa-trophy"},null,-1),t("span",null,"Посмотреть рейтинг",-1)])),_:1,__:[43]}),t("a",{href:"#",class:"quick-link",onClick:e[5]||(e[5]=lt((...x)=>s.downloadReport&&s.downloadReport(...x),["prevent"]))},e[44]||(e[44]=[t("i",{class:"fas fa-download"},null,-1),t("span",null,"Скачать отчет",-1)]))])])])])])]),t("div",J_,[A(l)]),t("div",ty,[A(v)]),t("div",ey,[A(f)]),t("div",sy,[A(_)])]),A(M,{modelValue:s.showEditModal,"onUpdate:modelValue":e[6]||(e[6]=x=>s.showEditModal=x),user:s.authStore.user,onUpdated:s.handleProfileUpdate},null,8,["modelValue","user","onUpdated"]),A(R,{modelValue:s.showAvatarModal,"onUpdate:modelValue":e[7]||(e[7]=x=>s.showAvatarModal=x),onUploaded:s.handleAvatarUpdate},null,8,["modelValue","onUploaded"])])}const oy=J(V0,[["render",ay],["__scopeId","data-v-5b5840d3"]]),ny={name:"CompareUsers",props:{user1:{type:Object,required:!0},user2:{type:Object,required:!0}},setup(a){const e=ut(),d=f=>e.formatNumber(f),s=(f,_)=>{const M=a.user1[f]||0,R=a.user2[f]||0,k=Math.max(M,R);return k===0?0:(_==="user1"?M:R)/k*100},m=f=>{const _=a.user1[f]||0,M=a.user2[f]||0,R=Math.abs(_-M);return R===0?"=":`${_>M?"←":"→"} ${d(R)}`},u=(f,_)=>{const M=(_.eventsCount||0)+(_.achievementsCount||0)+(_.purchasesCount||0);if(M===0)return 0;let R=0;switch(f){case"events":R=_.eventsCount||0;break;case"achievements":R=_.achievementsCount||0;break;case"purchases":R=_.purchasesCount||0;break}return Math.round(R/M*100)},o=f=>{const _=a.user1[f]||0,M=a.user2[f]||0;return _===M?"Равенство":_>M?a.user1.name:a.user2.name},l=f=>{const _=a.user1[f]||0,M=a.user2[f]||0;return d(Math.abs(_-M))},v=()=>{const f=document.getElementById("activityComparisonChart");if(f){const _=f.getContext("2d");_.fillStyle="#f8f9fa",_.fillRect(0,0,f.width,f.height),_.fillStyle="#333",_.font="14px Arial",_.textAlign="center",_.fillText("График сравнения активности",f.width/2,f.height/2)}};return dt(()=>{setTimeout(v,100)}),{formatNumber:d,getBarWidth:s,getDifference:m,getActivityPercentage:u,getLeader:o,getAdvantage:l}}},iy={class:"compare-users"},ly={class:"users-comparison"},ry={class:"row g-4"},dy={class:"col-md-5"},cy={class:"user-card user-left"},uy={class:"user-header"},my={class:"user-avatar"},vy=["src","alt"],fy={key:1,class:"avatar-placeholder"},gy={class:"user-info"},py={class:"user-name"},by={class:"user-department"},hy={class:"user-position"},_y={class:"user-stats"},yy={class:"stat-item"},wy={class:"stat-value"},ky={class:"stat-item"},Cy={class:"stat-value"},xy={class:"stat-item"},Sy={class:"stat-value"},$y={class:"stat-item"},Py={class:"stat-value"},Dy={class:"col-md-2"},Ty={class:"comparison-metrics"},My={class:"metric-row"},Iy={class:"metric-bar"},Ay={class:"bars-container"},Ry={class:"metric-difference"},Ey={class:"metric-row"},Ny={class:"metric-bar"},Uy={class:"bars-container"},Ly={class:"metric-difference"},Vy={class:"metric-row"},By={class:"metric-bar"},Fy={class:"bars-container"},Oy={class:"metric-difference"},qy={class:"metric-row"},jy={class:"metric-bar"},Hy={class:"bars-container"},zy={class:"metric-difference"},Zy={class:"col-md-5"},Wy={class:"user-card user-right"},Yy={class:"user-header"},Gy={class:"user-info"},Qy={class:"user-name"},Ky={class:"user-department"},Xy={class:"user-position"},Jy={class:"user-avatar"},t3=["src","alt"],e3={key:1,class:"avatar-placeholder"},s3={class:"user-stats"},a3={class:"stat-item"},o3={class:"stat-value"},n3={class:"stat-item"},i3={class:"stat-value"},l3={class:"stat-item"},r3={class:"stat-value"},d3={class:"stat-item"},c3={class:"stat-value"},u3={class:"detailed-comparison mt-4"},m3={class:"row g-4"},v3={class:"col-md-6"},f3={class:"comparison-section"},g3={class:"category-comparison"},p3={class:"category-item"},b3={class:"category-bars"},h3={class:"category-bar"},_3={class:"bar-label"},y3={class:"category-bar"},w3={class:"bar-label"},k3={class:"category-item"},C3={class:"category-bars"},x3={class:"category-bar"},S3={class:"bar-label"},$3={class:"category-bar"},P3={class:"bar-label"},D3={class:"category-item"},T3={class:"category-bars"},M3={class:"category-bar"},I3={class:"bar-label"},A3={class:"category-bar"},R3={class:"bar-label"},E3={class:"comparison-summary mt-4"},N3={class:"summary-card"},U3={class:"summary-content"},L3={class:"summary-item"},V3={class:"leader-name"},B3={class:"leader-advantage"},F3={class:"summary-item"},O3={class:"leader-name"},q3={class:"leader-advantage"},j3={class:"summary-item"},H3={class:"leader-name"},z3={class:"leader-advantage"};function Z3(a,e,d,s,m,u){return n(),i("div",iy,[e[23]||(e[23]=t("div",{class:"compare-header mb-4"},[t("h5",{class:"compare-title text-center"},[t("i",{class:"fas fa-balance-scale me-2"}),c(" Сравнение результатов ")])],-1)),t("div",ly,[t("div",ry,[t("div",dy,[t("div",cy,[t("div",uy,[t("div",my,[d.user1.avatar?(n(),i("img",{key:0,src:d.user1.avatar,alt:d.user1.name},null,8,vy)):(n(),i("div",fy,e[0]||(e[0]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",gy,[t("h6",py,r(d.user1.name),1),t("div",by,r(d.user1.department),1),t("div",hy,r(d.user1.position),1)])]),t("div",_y,[t("div",yy,[e[1]||(e[1]=t("div",{class:"stat-label"},"Баллы",-1)),t("div",wy,r(s.formatNumber(d.user1.points||0)),1)]),t("div",ky,[e[2]||(e[2]=t("div",{class:"stat-label"},"Мероприятия",-1)),t("div",Cy,r(d.user1.eventsCount||0),1)]),t("div",xy,[e[3]||(e[3]=t("div",{class:"stat-label"},"Достижения",-1)),t("div",Sy,r(d.user1.achievementsCount||0),1)]),t("div",$y,[e[4]||(e[4]=t("div",{class:"stat-label"},"Покупки",-1)),t("div",Py,r(d.user1.purchasesCount||0),1)])])])]),t("div",Dy,[t("div",Ty,[t("div",My,[t("div",Iy,[e[5]||(e[5]=t("div",{class:"metric-label"},"Баллы",-1)),t("div",Ay,[t("div",{class:"bar bar-left",style:st({width:s.getBarWidth("points","user1")+"%"})},null,4),t("div",{class:"bar bar-right",style:st({width:s.getBarWidth("points","user2")+"%"})},null,4)]),t("div",Ry,r(s.getDifference("points")),1)])]),t("div",Ey,[t("div",Ny,[e[6]||(e[6]=t("div",{class:"metric-label"},"Мероприятия",-1)),t("div",Uy,[t("div",{class:"bar bar-left",style:st({width:s.getBarWidth("eventsCount","user1")+"%"})},null,4),t("div",{class:"bar bar-right",style:st({width:s.getBarWidth("eventsCount","user2")+"%"})},null,4)]),t("div",Ly,r(s.getDifference("eventsCount")),1)])]),t("div",Vy,[t("div",By,[e[7]||(e[7]=t("div",{class:"metric-label"},"Достижения",-1)),t("div",Fy,[t("div",{class:"bar bar-left",style:st({width:s.getBarWidth("achievementsCount","user1")+"%"})},null,4),t("div",{class:"bar bar-right",style:st({width:s.getBarWidth("achievementsCount","user2")+"%"})},null,4)]),t("div",Oy,r(s.getDifference("achievementsCount")),1)])]),t("div",qy,[t("div",jy,[e[8]||(e[8]=t("div",{class:"metric-label"},"Покупки",-1)),t("div",Hy,[t("div",{class:"bar bar-left",style:st({width:s.getBarWidth("purchasesCount","user1")+"%"})},null,4),t("div",{class:"bar bar-right",style:st({width:s.getBarWidth("purchasesCount","user2")+"%"})},null,4)]),t("div",zy,r(s.getDifference("purchasesCount")),1)])])])]),t("div",Zy,[t("div",Wy,[t("div",Yy,[t("div",Gy,[t("h6",Qy,r(d.user2.name),1),t("div",Ky,r(d.user2.department),1),t("div",Xy,r(d.user2.position),1)]),t("div",Jy,[d.user2.avatar?(n(),i("img",{key:0,src:d.user2.avatar,alt:d.user2.name},null,8,t3)):(n(),i("div",e3,e[9]||(e[9]=[t("i",{class:"fas fa-user"},null,-1)])))])]),t("div",s3,[t("div",a3,[t("div",o3,r(s.formatNumber(d.user2.points||0)),1),e[10]||(e[10]=t("div",{class:"stat-label"},"Баллы",-1))]),t("div",n3,[t("div",i3,r(d.user2.eventsCount||0),1),e[11]||(e[11]=t("div",{class:"stat-label"},"Мероприятия",-1))]),t("div",l3,[t("div",r3,r(d.user2.achievementsCount||0),1),e[12]||(e[12]=t("div",{class:"stat-label"},"Достижения",-1))]),t("div",d3,[t("div",c3,r(d.user2.purchasesCount||0),1),e[13]||(e[13]=t("div",{class:"stat-label"},"Покупки",-1))])])])])])]),t("div",u3,[t("div",m3,[e[18]||(e[18]=rt('<div class="col-md-6" data-v-24c6027f><div class="comparison-section" data-v-24c6027f><h6 class="section-title" data-v-24c6027f><i class="fas fa-chart-line me-2" data-v-24c6027f></i> Активность по времени </h6><div class="activity-chart" data-v-24c6027f><canvas id="activityComparisonChart" width="300" height="150" data-v-24c6027f></canvas></div></div></div>',1)),t("div",v3,[t("div",f3,[e[17]||(e[17]=t("h6",{class:"section-title"},[t("i",{class:"fas fa-chart-pie me-2"}),c(" Распределение активности ")],-1)),t("div",g3,[t("div",p3,[e[14]||(e[14]=t("div",{class:"category-name"},"Участие в мероприятиях",-1)),t("div",b3,[t("div",h3,[t("div",{class:"bar-fill user1-bar",style:st({width:s.getActivityPercentage("events",d.user1)+"%"})},null,4),t("span",_3,r(s.getActivityPercentage("events",d.user1))+"%",1)]),t("div",y3,[t("div",{class:"bar-fill user2-bar",style:st({width:s.getActivityPercentage("events",d.user2)+"%"})},null,4),t("span",w3,r(s.getActivityPercentage("events",d.user2))+"%",1)])])]),t("div",k3,[e[15]||(e[15]=t("div",{class:"category-name"},"Получение достижений",-1)),t("div",C3,[t("div",x3,[t("div",{class:"bar-fill user1-bar",style:st({width:s.getActivityPercentage("achievements",d.user1)+"%"})},null,4),t("span",S3,r(s.getActivityPercentage("achievements",d.user1))+"%",1)]),t("div",$3,[t("div",{class:"bar-fill user2-bar",style:st({width:s.getActivityPercentage("achievements",d.user2)+"%"})},null,4),t("span",P3,r(s.getActivityPercentage("achievements",d.user2))+"%",1)])])]),t("div",D3,[e[16]||(e[16]=t("div",{class:"category-name"},"Использование наград",-1)),t("div",T3,[t("div",M3,[t("div",{class:"bar-fill user1-bar",style:st({width:s.getActivityPercentage("purchases",d.user1)+"%"})},null,4),t("span",I3,r(s.getActivityPercentage("purchases",d.user1))+"%",1)]),t("div",A3,[t("div",{class:"bar-fill user2-bar",style:st({width:s.getActivityPercentage("purchases",d.user2)+"%"})},null,4),t("span",R3,r(s.getActivityPercentage("purchases",d.user2))+"%",1)])])])])])])])]),t("div",E3,[t("div",N3,[e[22]||(e[22]=t("h6",{class:"summary-title"},[t("i",{class:"fas fa-lightbulb me-2"}),c(" Итоги сравнения ")],-1)),t("div",U3,[t("div",L3,[e[19]||(e[19]=t("strong",null,"Лидер по баллам:",-1)),t("span",V3,r(s.getLeader("points")),1),t("span",B3,"+"+r(s.getAdvantage("points"))+" баллов",1)]),t("div",F3,[e[20]||(e[20]=t("strong",null,"Более активен в мероприятиях:",-1)),t("span",O3,r(s.getLeader("eventsCount")),1),t("span",q3,"+"+r(s.getAdvantage("eventsCount"))+" мероприятий",1)]),t("div",j3,[e[21]||(e[21]=t("strong",null,"Больше достижений:",-1)),t("span",H3,r(s.getLeader("achievementsCount")),1),t("span",z3,"+"+r(s.getAdvantage("achievementsCount"))+" достижений",1)])])])])])}const W3=J(ny,[["render",Z3],["__scopeId","data-v-24c6027f"]]),Y3={name:"LeaderboardPage",components:{CompareUsers:W3},setup(){const a=bt(),e=mt(),d=ut(),s=pt(),m=w(!1),u=w("table"),o=w({period:"month",department:"",metric:"points",limit:"25"}),l=w([]),v=w([]),f=w({totalUsers:0,activeUsers:0,averageRating:0,eventsParticipation:0}),_=w([]),M=w({user1:null,user2:null}),R=w(["IT отдел","HR / Кадры","Маркетинг","Продажи","Бухгалтерия","Производство","Логистика","Администрация"]),k=j(()=>l.value.slice(0,3)),V=p=>{switch(o.value.metric){case"points":return`${d.formatNumber(p.points||0)} б.`;case"events":return`${p.eventsCount||0} мер.`;case"achievements":return`${p.achievementsCount||0} дост.`;case"purchases":return`${p.purchasesCount||0} пок.`;default:return"0"}},I=()=>({points:"Баллы",events:"Мероприятия",achievements:"Достижения",purchases:"Покупки"})[o.value.metric]||"Метрика",F=p=>d.formatRelativeDate(p),$=p=>p===1?"rank-first":p===2?"rank-second":p===3?"rank-third":p<=10?"rank-top-ten":"rank-default",x=p=>p>0?"rank-up":p<0?"rank-down":"rank-same",y=p=>p>0?"fas fa-arrow-up":p<0?"fas fa-arrow-down":"fas fa-minus",D=p=>{var T,P;return p.profilePublic||p.id===((T=s.user)==null?void 0:T.id)||["moderator","admin"].includes((P=s.user)==null?void 0:P.role)},L=async()=>{try{m.value=!0,await new Promise(P=>setTimeout(P,1e3));const p=[{id:"1",name:"Иван Петров",department:"IT отдел",position:"Senior Developer",avatar:null,points:2450,eventsCount:23,achievementsCount:15,purchasesCount:12,rankChange:2,lastActivityAt:new Date(Date.now()-36e5),profilePublic:!0},{id:"2",name:"Мария Сидорова",department:"HR",position:"HR Manager",avatar:null,points:2340,eventsCount:28,achievementsCount:18,purchasesCount:8,rankChange:-1,lastActivityAt:new Date(Date.now()-72e5),profilePublic:!0},{id:"3",name:"Алексей Козлов",department:"Маркетинг",position:"Marketing Lead",avatar:null,points:2180,eventsCount:19,achievementsCount:14,purchasesCount:15,rankChange:1,lastActivityAt:new Date(Date.now()-18e5),profilePublic:!0}];for(let P=4;P<=parseInt(o.value.limit);P++)p.push({id:P.toString(),name:`Пользователь ${P}`,department:R.value[Math.floor(Math.random()*R.value.length)],position:"Сотрудник",avatar:null,points:Math.floor(Math.random()*2e3)+500,eventsCount:Math.floor(Math.random()*25)+1,achievementsCount:Math.floor(Math.random()*20)+1,purchasesCount:Math.floor(Math.random()*15)+1,rankChange:Math.floor(Math.random()*21)-10,lastActivityAt:new Date(Date.now()-Math.random()*864e5*7),profilePublic:Math.random()>.3});const T=o.value.metric==="points"?"points":o.value.metric==="events"?"eventsCount":o.value.metric==="achievements"?"achievementsCount":"purchasesCount";l.value=p.sort((P,z)=>(z[T]||0)-(P[T]||0))}catch(p){console.error("Ошибка загрузки рейтинга:",p),e.error("Ошибка загрузки рейтинга")}finally{m.value=!1}},W=async()=>{try{v.value=[{name:"IT отдел",userCount:45,averageScore:1850,percentage:85},{name:"HR",userCount:12,averageScore:1650,percentage:75},{name:"Маркетинг",userCount:18,averageScore:1720,percentage:78},{name:"Продажи",userCount:32,averageScore:1580,percentage:72}],f.value={totalUsers:247,activeUsers:189,averageRating:4.6,eventsParticipation:74},_.value=[{id:"1",title:"Первые шаги",icon:"fas fa-baby",userCount:23},{id:"2",title:"Активный участник",icon:"fas fa-fire",userCount:15},{id:"3",title:"Лидер команды",icon:"fas fa-crown",userCount:8}]}catch(p){console.error("Ошибка загрузки статистики:",p)}},q=()=>{const p=document.getElementById("departmentsChart");if(p){const T=p.getContext("2d");T.fillStyle="#f8f9fa",T.fillRect(0,0,p.width,p.height),T.fillStyle="#333",T.font="14px Arial",T.textAlign="center",T.fillText("Активность по отделам",p.width/2,p.height/2)}},O=()=>{u.value=u.value==="table"?"cards":"table"},C=p=>{var T;p===((T=s.user)==null?void 0:T.id)?a.push("/profile"):a.push(`/users/${p}`)},b=p=>{M.value={user1:s.user,user2:p},new bootstrap.Modal(document.getElementById("compareModal")).show()},B=()=>{a.push("/profile")},at=p=>{e.info(`Экспорт в ${p.toUpperCase()} будет доступен в следующей версии`)};return Mt(()=>[o.value.period,o.value.department,o.value.metric],()=>{L()}),dt(async()=>{d.setPageTitle("Рейтинг участников"),await Promise.all([L(),W()]),setTimeout(q,100)}),{loading:m,viewMode:u,filters:o,leaderboard:l,departmentStats:v,activityStats:f,monthlyAchievements:_,compareUsers:M,departments:R,topThree:k,authStore:s,formatMetricValue:V,getMetricLabel:I,formatRelativeTime:F,getRankClass:$,getRankChangeClass:x,getRankChangeIcon:y,canViewProfile:D,loadLeaderboard:L,toggleView:O,viewUserProfile:C,compareWithUser:b,showPersonalStats:B,exportLeaderboard:at}}},G3={class:"leaderboard-page"},Q3={class:"page-header mb-4"},K3={class:"row align-items-center"},X3={class:"col-md-4 text-md-end"},J3={class:"header-actions"},t4={class:"dropdown"},e4={class:"dropdown-menu"},s4={class:"leaderboard-controls mb-4"},a4={class:"row g-3"},o4={class:"col-lg-3 col-md-6"},n4={class:"col-lg-3 col-md-6"},i4=["value"],l4={class:"col-lg-3 col-md-6"},r4={class:"col-lg-3 col-md-6"},d4={key:0,class:"winners-podium mb-4"},c4={class:"podium-container"},u4={class:"podium-place second-place"},m4={class:"place-avatar"},v4=["src","alt"],f4={key:1,class:"avatar-placeholder"},g4={class:"place-info"},p4={class:"place-name"},b4={class:"place-department"},h4={class:"place-score"},_4={class:"podium-place first-place"},y4={class:"place-avatar"},w4=["src","alt"],k4={key:1,class:"avatar-placeholder"},C4={class:"place-info"},x4={class:"place-name"},S4={class:"place-department"},$4={class:"place-score"},P4={class:"podium-place third-place"},D4={class:"place-avatar"},T4=["src","alt"],M4={key:1,class:"avatar-placeholder"},I4={class:"place-info"},A4={class:"place-name"},R4={class:"place-department"},E4={class:"place-score"},N4={class:"leaderboard-content"},U4={class:"row"},L4={class:"col-lg-8"},V4={class:"leaderboard-table-card"},B4={class:"card-header"},F4={class:"table-actions"},O4={class:"card-body"},q4={key:0,class:"loading-state"},j4={key:1,class:"empty-state"},H4={key:2,class:"table-responsive"},z4={class:"table table-hover leaderboard-table"},Z4={class:"text-center"},W4={class:"rank-cell"},Y4={key:0,class:"rank-icon"},G4={class:"user-cell"},Q4={class:"user-info"},K4={class:"user-avatar"},X4=["src","alt"],J4={key:1,class:"avatar-placeholder"},tw={class:"user-details"},ew={class:"user-name"},sw={class:"user-position"},aw={class:"department-cell"},ow={class:"department-badge"},nw={class:"metric-cell text-center"},iw={class:"metric-value"},lw={class:"change-cell text-center"},rw={class:"activity-cell text-center"},dw={class:"activity-time"},cw={class:"actions-cell"},uw={class:"btn-group btn-group-sm"},mw=["onClick","disabled"],vw=["onClick"],fw={key:3,class:"cards-view"},gw={class:"row g-3"},pw={class:"card-rank"},bw={class:"card-avatar"},hw=["src","alt"],_w={key:1,class:"avatar-placeholder"},yw={class:"card-info"},ww={class:"user-name"},kw={class:"user-department"},Cw={class:"user-metric"},xw={class:"card-actions"},Sw=["onClick","disabled"],$w={class:"col-lg-4"},Pw={class:"stats-card departments-stats mb-4"},Dw={class:"card-body"},Tw={class:"departments-list"},Mw={class:"department-info"},Iw={class:"department-name"},Aw={class:"department-count"},Rw={class:"department-progress"},Ew={class:"progress"},Nw={class:"progress-text"},Uw={class:"stats-card activity-stats mb-4"},Lw={class:"card-body"},Vw={class:"activity-metrics"},Bw={class:"metric-item"},Fw={class:"metric-content"},Ow={class:"metric-value"},qw={class:"metric-item"},jw={class:"metric-content"},Hw={class:"metric-value"},zw={class:"metric-item"},Zw={class:"metric-content"},Ww={class:"metric-value"},Yw={class:"metric-item"},Gw={class:"metric-content"},Qw={class:"metric-value"},Kw={class:"stats-card achievements-card"},Xw={class:"card-body"},Jw={class:"achievements-list"},tk={class:"achievement-icon"},ek={class:"achievement-info"},sk={class:"achievement-title"},ak={class:"achievement-users"},ok={id:"compareModal",class:"modal fade",tabindex:"-1","aria-labelledby":"compareModalLabel","aria-hidden":"true"},nk={class:"modal-dialog modal-lg"},ik={class:"modal-content"},lk={class:"modal-body"};function rk(a,e,d,s,m,u){var l,v,f,_,M,R,k,V,I,F,$,x;const o=Q("CompareUsers");return n(),i("div",G3,[t("div",Q3,[t("div",K3,[e[16]||(e[16]=t("div",{class:"col-md-8"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-trophy me-3"}),c(" Рейтинг участников ")]),t("p",{class:"page-subtitle"}," Топ активных сотрудников и их достижения ")],-1)),t("div",X3,[t("div",J3,[t("button",{class:"btn btn-outline-primary me-2",onClick:e[0]||(e[0]=(...y)=>s.showPersonalStats&&s.showPersonalStats(...y))},e[12]||(e[12]=[t("i",{class:"fas fa-user me-2"},null,-1),c(" Моя статистика ",-1)])),t("div",t4,[e[15]||(e[15]=t("button",{class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[t("i",{class:"fas fa-download me-2"}),c(" Экспорт ")],-1)),t("ul",e4,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=lt(y=>s.exportLeaderboard("pdf"),["prevent"]))},e[13]||(e[13]=[t("i",{class:"fas fa-file-pdf me-2"},null,-1),c(" PDF отчет ",-1)]))]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=lt(y=>s.exportLeaderboard("excel"),["prevent"]))},e[14]||(e[14]=[t("i",{class:"fas fa-file-excel me-2"},null,-1),c(" Excel таблица ",-1)]))])])])])])])]),t("div",s4,[t("div",a4,[t("div",o4,[e[18]||(e[18]=t("label",{class:"form-label"},"Период",-1)),E(t("select",{"onUpdate:modelValue":e[3]||(e[3]=y=>s.filters.period=y),class:"form-select",onChange:e[4]||(e[4]=(...y)=>s.loadLeaderboard&&s.loadLeaderboard(...y))},e[17]||(e[17]=[rt('<option value="all" data-v-001bd322>Все время</option><option value="year" data-v-001bd322>Этот год</option><option value="quarter" data-v-001bd322>Этот квартал</option><option value="month" data-v-001bd322>Этот месяц</option><option value="week" data-v-001bd322>Эта неделя</option>',5)]),544),[[ot,s.filters.period]])]),t("div",n4,[e[20]||(e[20]=t("label",{class:"form-label"},"Отдел",-1)),E(t("select",{"onUpdate:modelValue":e[5]||(e[5]=y=>s.filters.department=y),class:"form-select",onChange:e[6]||(e[6]=(...y)=>s.loadLeaderboard&&s.loadLeaderboard(...y))},[e[19]||(e[19]=t("option",{value:""},"Все отделы",-1)),(n(!0),i(H,null,G(s.departments,y=>(n(),i("option",{key:y,value:y},r(y),9,i4))),128))],544),[[ot,s.filters.department]])]),t("div",l4,[e[22]||(e[22]=t("label",{class:"form-label"},"Метрика",-1)),E(t("select",{"onUpdate:modelValue":e[7]||(e[7]=y=>s.filters.metric=y),class:"form-select",onChange:e[8]||(e[8]=(...y)=>s.loadLeaderboard&&s.loadLeaderboard(...y))},e[21]||(e[21]=[t("option",{value:"points"},"Баллы",-1),t("option",{value:"events"},"Мероприятия",-1),t("option",{value:"achievements"},"Достижения",-1),t("option",{value:"purchases"},"Покупки",-1)]),544),[[ot,s.filters.metric]])]),t("div",r4,[e[24]||(e[24]=t("label",{class:"form-label"},"Показать",-1)),E(t("select",{"onUpdate:modelValue":e[9]||(e[9]=y=>s.filters.limit=y),class:"form-select",onChange:e[10]||(e[10]=(...y)=>s.loadLeaderboard&&s.loadLeaderboard(...y))},e[23]||(e[23]=[t("option",{value:"10"},"Топ 10",-1),t("option",{value:"25"},"Топ 25",-1),t("option",{value:"50"},"Топ 50",-1),t("option",{value:"100"},"Топ 100",-1)]),544),[[ot,s.filters.limit]])])])]),s.topThree.length>=3?(n(),i("div",d4,[t("div",c4,[t("div",u4,[e[26]||(e[26]=t("div",{class:"place-medal"},[t("i",{class:"fas fa-medal"}),t("span",{class:"place-number"},"2")],-1)),t("div",m4,[(l=s.topThree[1])!=null&&l.avatar?(n(),i("img",{key:0,src:s.topThree[1].avatar,alt:(v=s.topThree[1])==null?void 0:v.name},null,8,v4)):(n(),i("div",f4,e[25]||(e[25]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",g4,[t("h5",p4,r((f=s.topThree[1])==null?void 0:f.name),1),t("div",b4,r((_=s.topThree[1])==null?void 0:_.department),1),t("div",h4,r(s.formatMetricValue(s.topThree[1])),1)])]),t("div",_4,[e[28]||(e[28]=rt('<div class="winner-crown" data-v-001bd322><i class="fas fa-crown" data-v-001bd322></i></div><div class="place-medal" data-v-001bd322><i class="fas fa-medal" data-v-001bd322></i><span class="place-number" data-v-001bd322>1</span></div>',2)),t("div",y4,[(M=s.topThree[0])!=null&&M.avatar?(n(),i("img",{key:0,src:s.topThree[0].avatar,alt:(R=s.topThree[0])==null?void 0:R.name},null,8,w4)):(n(),i("div",k4,e[27]||(e[27]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",C4,[t("h4",x4,r((k=s.topThree[0])==null?void 0:k.name),1),t("div",S4,r((V=s.topThree[0])==null?void 0:V.department),1),t("div",$4,r(s.formatMetricValue(s.topThree[0])),1)])]),t("div",P4,[e[30]||(e[30]=t("div",{class:"place-medal"},[t("i",{class:"fas fa-medal"}),t("span",{class:"place-number"},"3")],-1)),t("div",D4,[(I=s.topThree[2])!=null&&I.avatar?(n(),i("img",{key:0,src:s.topThree[2].avatar,alt:(F=s.topThree[2])==null?void 0:F.name},null,8,T4)):(n(),i("div",M4,e[29]||(e[29]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",I4,[t("h5",A4,r(($=s.topThree[2])==null?void 0:$.name),1),t("div",R4,r((x=s.topThree[2])==null?void 0:x.department),1),t("div",E4,r(s.formatMetricValue(s.topThree[2])),1)])])])])):g("",!0),t("div",N4,[t("div",U4,[t("div",L4,[t("div",V4,[t("div",B4,[e[31]||(e[31]=t("h5",{class:"card-title"},[t("i",{class:"fas fa-list-ol me-2"}),c(" Рейтинговая таблица ")],-1)),t("div",F4,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[11]||(e[11]=(...y)=>s.toggleView&&s.toggleView(...y))},[t("i",{class:h(s.viewMode==="table"?"fas fa-th-large":"fas fa-list")},null,2)])])]),t("div",O4,[s.loading?(n(),i("div",q4,e[32]||(e[32]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1),t("p",{class:"mt-2 text-muted"},"Загрузка рейтинга...",-1)]))):s.leaderboard.length===0?(n(),i("div",j4,e[33]||(e[33]=[t("i",{class:"fas fa-users-slash text-muted mb-3"},null,-1),t("h5",null,"Нет данных",-1),t("p",{class:"text-muted"},"Рейтинг пустой или не найдено участников с выбранными фильтрами",-1)]))):s.viewMode==="table"?(n(),i("div",H4,[t("table",z4,[t("thead",null,[t("tr",null,[e[34]||(e[34]=t("th",{width:"60"},"Место",-1)),e[35]||(e[35]=t("th",null,"Участник",-1)),e[36]||(e[36]=t("th",null,"Отдел",-1)),t("th",Z4,r(s.getMetricLabel()),1),e[37]||(e[37]=t("th",{class:"text-center"},"Изменение",-1)),e[38]||(e[38]=t("th",{class:"text-center"},"Последняя активность",-1)),e[39]||(e[39]=t("th",{width:"100"},"Действия",-1))])]),t("tbody",null,[(n(!0),i(H,null,G(s.leaderboard,(y,D)=>{var L;return n(),i("tr",{key:y.id,class:h(["leaderboard-row",{"current-user":y.id===((L=s.authStore.user)==null?void 0:L.id),"top-three":D<3}])},[t("td",W4,[t("div",{class:h(["rank-badge",s.getRankClass(D+1)])},[D<3?(n(),i("span",Y4,e[40]||(e[40]=[t("i",{class:"fas fa-medal"},null,-1)]))):g("",!0),c(" "+r(D+1),1)],2)]),t("td",G4,[t("div",Q4,[t("div",K4,[y.avatar?(n(),i("img",{key:0,src:y.avatar,alt:y.name},null,8,X4)):(n(),i("div",J4,e[41]||(e[41]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",tw,[t("div",ew,r(y.name),1),t("div",sw,r(y.position),1)])])]),t("td",aw,[t("span",ow,r(y.department),1)]),t("td",nw,[t("div",iw,r(s.formatMetricValue(y)),1)]),t("td",lw,[t("div",{class:h(["rank-change",s.getRankChangeClass(y.rankChange)])},[t("i",{class:h(s.getRankChangeIcon(y.rankChange))},null,2),c(" "+r(Math.abs(y.rankChange||0)),1)],2)]),t("td",rw,[t("span",dw,r(s.formatRelativeTime(y.lastActivityAt)),1)]),t("td",cw,[t("div",uw,[t("button",{class:"btn btn-outline-primary",onClick:W=>s.viewUserProfile(y.id),disabled:!s.canViewProfile(y)},e[42]||(e[42]=[t("i",{class:"fas fa-eye"},null,-1)]),8,mw),t("button",{class:"btn btn-outline-secondary",onClick:W=>s.compareWithUser(y)},e[43]||(e[43]=[t("i",{class:"fas fa-balance-scale"},null,-1)]),8,vw)])])],2)}),128))])])])):(n(),i("div",fw,[t("div",gw,[(n(!0),i(H,null,G(s.leaderboard,(y,D)=>{var L;return n(),i("div",{key:y.id,class:"col-md-6 col-lg-4"},[t("div",{class:h(["user-card",{"current-user":y.id===((L=s.authStore.user)==null?void 0:L.id),"top-performer":D<3}])},[t("div",pw,[t("span",{class:h(["rank-number",s.getRankClass(D+1)])}," #"+r(D+1),3),y.rankChange?(n(),i("div",{key:0,class:h(["rank-change",s.getRankChangeClass(y.rankChange)])},[t("i",{class:h(s.getRankChangeIcon(y.rankChange))},null,2),c(" "+r(Math.abs(y.rankChange)),1)],2)):g("",!0)]),t("div",bw,[y.avatar?(n(),i("img",{key:0,src:y.avatar,alt:y.name},null,8,hw)):(n(),i("div",_w,e[44]||(e[44]=[t("i",{class:"fas fa-user"},null,-1)])))]),t("div",yw,[t("h6",ww,r(y.name),1),t("div",kw,r(y.department),1),t("div",Cw,r(s.formatMetricValue(y)),1)]),t("div",xw,[t("button",{class:"btn btn-sm btn-outline-primary",onClick:W=>s.viewUserProfile(y.id),disabled:!s.canViewProfile(y)}," Профиль ",8,Sw)])],2)])}),128))])]))])])]),t("div",$w,[t("div",Pw,[e[46]||(e[46]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-building me-2"}),c(" По отделам ")])],-1)),t("div",Dw,[e[45]||(e[45]=t("div",{class:"departments-chart"},[t("canvas",{id:"departmentsChart",width:"300",height:"200"})],-1)),t("div",Tw,[(n(!0),i(H,null,G(s.departmentStats,y=>(n(),i("div",{key:y.name,class:"department-item"},[t("div",Mw,[t("span",Iw,r(y.name),1),t("span",Aw,r(y.userCount)+" чел.",1)]),t("div",Rw,[t("div",Ew,[t("div",{class:"progress-bar",style:st({width:y.percentage+"%"})},null,4)]),t("span",Nw,r(y.averageScore),1)])]))),128))])])]),t("div",Uw,[e[55]||(e[55]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-chart-line me-2"}),c(" Активность ")])],-1)),t("div",Lw,[t("div",Vw,[t("div",Bw,[e[48]||(e[48]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-users"})],-1)),t("div",Fw,[t("div",Ow,r(s.activityStats.totalUsers),1),e[47]||(e[47]=t("div",{class:"metric-label"},"Всего участников",-1))])]),t("div",qw,[e[50]||(e[50]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-fire"})],-1)),t("div",jw,[t("div",Hw,r(s.activityStats.activeUsers),1),e[49]||(e[49]=t("div",{class:"metric-label"},"Активных за месяц",-1))])]),t("div",zw,[e[52]||(e[52]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-star"})],-1)),t("div",Zw,[t("div",Ww,r(s.activityStats.averageRating),1),e[51]||(e[51]=t("div",{class:"metric-label"},"Средняя оценка",-1))])]),t("div",Yw,[e[54]||(e[54]=t("div",{class:"metric-icon"},[t("i",{class:"fas fa-calendar-check"})],-1)),t("div",Gw,[t("div",Qw,r(s.activityStats.eventsParticipation)+"%",1),e[53]||(e[53]=t("div",{class:"metric-label"},"Участие в мероприятиях",-1))])])])])]),t("div",Kw,[e[56]||(e[56]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-trophy me-2"}),c(" Достижения месяца ")])],-1)),t("div",Xw,[t("div",Jw,[(n(!0),i(H,null,G(s.monthlyAchievements,y=>(n(),i("div",{key:y.id,class:"achievement-item"},[t("div",tk,[t("i",{class:h(y.icon)},null,2)]),t("div",ek,[t("div",sk,r(y.title),1),t("div",ak,r(y.userCount)+" получили",1)])]))),128))])])])])])]),t("div",ok,[t("div",nk,[t("div",ik,[e[57]||(e[57]=t("div",{class:"modal-header"},[t("h5",{id:"compareModalLabel",class:"modal-title"}," Сравнение результатов "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("div",lk,[s.compareUsers.user1&&s.compareUsers.user2?(n(),ft(o,{key:0,user1:s.compareUsers.user1,user2:s.compareUsers.user2},null,8,["user1","user2"])):g("",!0)])])])])])}const dk=J(Y3,[["render",rk],["__scopeId","data-v-001bd322"]]),ck={name:"AdminDashboard"},uk={class:"admin-dashboard-page"},mk={class:"container"},vk={class:"row g-4"},fk={class:"col-lg-3 col-md-6"},gk={class:"card admin-card"},pk={class:"card-body text-center"},bk={class:"col-lg-3 col-md-6"},hk={class:"card admin-card"},_k={class:"card-body text-center"},yk={class:"col-lg-3 col-md-6"},wk={class:"card admin-card"},kk={class:"card-body text-center"},Ck={class:"col-lg-3 col-md-6"},xk={class:"card admin-card"},Sk={class:"card-body text-center"},$k={class:"row mt-4"},Pk={class:"col-12"},Dk={class:"card"},Tk={class:"card-body"},Mk={class:"row g-3"},Ik={class:"col-md-4"},Ak={class:"col-md-4"},Rk={class:"col-md-4"};function Ek(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",uk,[t("div",mk,[e[20]||(e[20]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-crown me-2"}),c(" Панель администратора ")])],-1)),t("div",vk,[t("div",fk,[t("div",gk,[t("div",pk,[e[1]||(e[1]=t("div",{class:"admin-icon"},[t("i",{class:"fas fa-users"})],-1)),e[2]||(e[2]=t("h5",{class:"card-title"},"Пользователи",-1)),e[3]||(e[3]=t("p",{class:"card-text"},"Управление сотрудниками",-1)),A(o,{to:"/admin/users",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[c(" Управлять ",-1)])),_:1,__:[0]})])])]),t("div",bk,[t("div",hk,[t("div",_k,[e[5]||(e[5]=t("div",{class:"admin-icon"},[t("i",{class:"fas fa-calendar-alt"})],-1)),e[6]||(e[6]=t("h5",{class:"card-title"},"Мероприятия",-1)),e[7]||(e[7]=t("p",{class:"card-text"},"Управление событиями",-1)),A(o,{to:"/admin/events",class:"btn btn-primary"},{default:N(()=>e[4]||(e[4]=[c(" Управлять ",-1)])),_:1,__:[4]})])])]),t("div",yk,[t("div",wk,[t("div",kk,[e[9]||(e[9]=t("div",{class:"admin-icon"},[t("i",{class:"fas fa-gift"})],-1)),e[10]||(e[10]=t("h5",{class:"card-title"},"Награды",-1)),e[11]||(e[11]=t("p",{class:"card-text"},"Управление призами",-1)),A(o,{to:"/admin/rewards",class:"btn btn-primary"},{default:N(()=>e[8]||(e[8]=[c(" Управлять ",-1)])),_:1,__:[8]})])])]),t("div",Ck,[t("div",xk,[t("div",Sk,[e[13]||(e[13]=t("div",{class:"admin-icon"},[t("i",{class:"fas fa-chart-bar"})],-1)),e[14]||(e[14]=t("h5",{class:"card-title"},"Статистика",-1)),e[15]||(e[15]=t("p",{class:"card-text"},"Аналитика системы",-1)),A(o,{to:"/admin/statistics",class:"btn btn-primary"},{default:N(()=>e[12]||(e[12]=[c(" Просмотреть ",-1)])),_:1,__:[12]})])])])]),t("div",$k,[t("div",Pk,[t("div",Dk,[t("div",Tk,[e[19]||(e[19]=t("h5",{class:"card-title"},"Быстрые действия",-1)),t("div",Mk,[t("div",Ik,[A(o,{to:"/admin/purchases",class:"btn btn-outline-primary w-100"},{default:N(()=>e[16]||(e[16]=[t("i",{class:"fas fa-shopping-cart me-2"},null,-1),c(" Управление покупками ",-1)])),_:1,__:[16]})]),t("div",Ak,[A(o,{to:"/admin/registrations",class:"btn btn-outline-primary w-100"},{default:N(()=>e[17]||(e[17]=[t("i",{class:"fas fa-clipboard-list me-2"},null,-1),c(" Управление регистрациями ",-1)])),_:1,__:[17]})]),t("div",Rk,[A(o,{to:"/events/create",class:"btn btn-outline-success w-100"},{default:N(()=>e[18]||(e[18]=[t("i",{class:"fas fa-plus me-2"},null,-1),c(" Создать мероприятие ",-1)])),_:1,__:[18]})])])])])])])])])}const Nk=J(ck,[["render",Ek],["__scopeId","data-v-139ad7d1"]]),Uk={name:"ModeratorDashboard"},Lk={class:"moderator-dashboard-page"},Vk={class:"container"},Bk={class:"row g-4"},Fk={class:"col-lg-6"},Ok={class:"card moderator-card"},qk={class:"card-body text-center"},jk={class:"col-lg-6"},Hk={class:"card moderator-card"},zk={class:"card-body text-center"};function Zk(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Lk,[t("div",Vk,[e[8]||(e[8]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-shield-alt me-2"}),c(" Панель модератора ")])],-1)),t("div",Bk,[t("div",Fk,[t("div",Ok,[t("div",qk,[e[1]||(e[1]=t("div",{class:"moderator-icon"},[t("i",{class:"fas fa-calendar-plus"})],-1)),e[2]||(e[2]=t("h5",{class:"card-title"},"Создать мероприятие",-1)),e[3]||(e[3]=t("p",{class:"card-text"},"Добавить новое событие в систему",-1)),A(o,{to:"/events/create",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[c(" Создать ",-1)])),_:1,__:[0]})])])]),t("div",jk,[t("div",Hk,[t("div",zk,[e[5]||(e[5]=t("div",{class:"moderator-icon"},[t("i",{class:"fas fa-clipboard-check"})],-1)),e[6]||(e[6]=t("h5",{class:"card-title"},"Управление регистрациями",-1)),e[7]||(e[7]=t("p",{class:"card-text"},"Просмотр и одобрение заявок",-1)),A(o,{to:"/admin/registrations",class:"btn btn-primary"},{default:N(()=>e[4]||(e[4]=[c(" Управлять ",-1)])),_:1,__:[4]})])])])]),e[9]||(e[9]=rt('<div class="row mt-4" data-v-2cabee22><div class="col-12" data-v-2cabee22><div class="card" data-v-2cabee22><div class="card-body" data-v-2cabee22><h5 class="card-title" data-v-2cabee22>Статистика модератора</h5><div class="row g-3" data-v-2cabee22><div class="col-md-3" data-v-2cabee22><div class="stat-item" data-v-2cabee22><div class="stat-number" data-v-2cabee22>4</div><div class="stat-label" data-v-2cabee22>Активных мероприятий</div></div></div><div class="col-md-3" data-v-2cabee22><div class="stat-item" data-v-2cabee22><div class="stat-number" data-v-2cabee22>15</div><div class="stat-label" data-v-2cabee22>Ожидающих регистраций</div></div></div><div class="col-md-3" data-v-2cabee22><div class="stat-item" data-v-2cabee22><div class="stat-number" data-v-2cabee22>180</div><div class="stat-label" data-v-2cabee22>Всего участников</div></div></div><div class="col-md-3" data-v-2cabee22><div class="stat-item" data-v-2cabee22><div class="stat-number" data-v-2cabee22>85%</div><div class="stat-label" data-v-2cabee22>Средняя заполненность</div></div></div></div></div></div></div></div>',1))])])}const Wk=J(Uk,[["render",Zk],["__scopeId","data-v-2cabee22"]]),Yk={name:"UsersManagement"},Gk={class:"users-management-page"},Qk={class:"container"},Kk={class:"card"},Xk={class:"card-body"};function Jk(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",Gk,[t("div",Qk,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-users me-2"}),c(" Управление пользователями ")])],-1)),t("div",Kk,[t("div",Xk,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция управления пользователями находится в разработке ")],-1)),A(o,{to:"/admin",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться в админ-панель ",-1)])),_:1,__:[0]})])])])])}const t5=J(Yk,[["render",Jk],["__scopeId","data-v-51418fc7"]]),e5={name:"EventsManagement"},s5={class:"events-management-page"},a5={class:"container"},o5={class:"card"},n5={class:"card-body"};function i5(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",s5,[t("div",a5,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-calendar-alt me-2"}),c(" Управление мероприятиями ")])],-1)),t("div",o5,[t("div",n5,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция управления мероприятиями находится в разработке ")],-1)),A(o,{to:"/admin",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться в админ-панель ",-1)])),_:1,__:[0]})])])])])}const l5=J(e5,[["render",i5],["__scopeId","data-v-6c22f5f4"]]),r5={name:"RewardsManagement"},d5={class:"rewards-management-page"},c5={class:"container"},u5={class:"card"},m5={class:"card-body"};function v5(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",d5,[t("div",c5,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-gift me-2"}),c(" Управление наградами ")])],-1)),t("div",u5,[t("div",m5,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция управления наградами находится в разработке ")],-1)),A(o,{to:"/admin",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться в админ-панель ",-1)])),_:1,__:[0]})])])])])}const f5=J(r5,[["render",v5],["__scopeId","data-v-36cd185d"]]),g5={name:"PurchasesManagement"},p5={class:"purchases-management-page"},b5={class:"container"},h5={class:"card"},_5={class:"card-body"};function y5(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",p5,[t("div",b5,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-shopping-cart me-2"}),c(" Управление покупками ")])],-1)),t("div",h5,[t("div",_5,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция управления покупками находится в разработке ")],-1)),A(o,{to:"/admin",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться в админ-панель ",-1)])),_:1,__:[0]})])])])])}const w5=J(g5,[["render",y5],["__scopeId","data-v-5360e36f"]]),k5={name:"RegistrationsManagement"},C5={class:"registrations-management-page"},x5={class:"container"},S5={class:"card"},$5={class:"card-body"};function P5(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",C5,[t("div",x5,[e[2]||(e[2]=t("div",{class:"page-header mb-4"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-clipboard-list me-2"}),c(" Управление регистрациями ")])],-1)),t("div",S5,[t("div",$5,[e[1]||(e[1]=t("div",{class:"alert alert-info"},[t("i",{class:"fas fa-info-circle me-2"}),c(" Функция управления регистрациями находится в разработке ")],-1)),A(o,{to:"/admin",class:"btn btn-primary"},{default:N(()=>e[0]||(e[0]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Вернуться в админ-панель ",-1)])),_:1,__:[0]})])])])])}const D5=J(k5,[["render",P5],["__scopeId","data-v-214f13ed"]]),T5={name:"StatisticsPage",setup(){const a=mt(),e=ut(),d=w(!1),s=w("participation"),m=w("chart"),u=w(null),o=w({period:"month",dateFrom:"",dateTo:"",department:""}),l=w({participationRate:0,participationTrend:0,engagementScore:0,engagementTrend:0,satisfactionScore:0,satisfactionTrend:0,retentionRate:0,retentionTrend:0}),v=w([]),f=w([]),_=w([]),M=w([]),R=w([]),k=w([{key:"participation",label:"Участие"},{key:"engagement",label:"Вовлеченность"},{key:"satisfaction",label:"Удовлетворенность"},{key:"points",label:"Баллы"}]),V=w(["IT отдел","HR / Кадры","Маркетинг","Продажи","Бухгалтерия","Производство","Логистика","Администрация"]),I=p=>e.formatNumber(p),F=p=>p>0?"trend-positive":p<0?"trend-negative":"trend-neutral",$=p=>p>0?"fas fa-arrow-up":p<0?"fas fa-arrow-down":"fas fa-minus",x=p=>p>=80?"participation-excellent":p>=60?"participation-good":p>=40?"participation-average":"participation-poor",y=p=>({high:"priority-high",medium:"priority-medium",low:"priority-low"})[p]||"priority-low",D=p=>({high:"Высокий",medium:"Средний",low:"Низкий"})[p]||"Низкий",L=async()=>{try{d.value=!0,await new Promise(p=>setTimeout(p,1e3)),l.value={participationRate:74,participationTrend:5.2,engagementScore:8.3,engagementTrend:2.1,satisfactionScore:4.6,satisfactionTrend:.3,retentionRate:87,retentionTrend:-1.2},v.value=[{name:"IT отдел",employeeCount:45,participationRate:89,averagePoints:1850,satisfaction:4.7,trend:8.2},{name:"HR",employeeCount:12,participationRate:92,averagePoints:1650,satisfaction:4.8,trend:12.5},{name:"Маркетинг",employeeCount:18,participationRate:78,averagePoints:1720,satisfaction:4.5,trend:3.1},{name:"Продажи",employeeCount:32,participationRate:65,averagePoints:1580,satisfaction:4.2,trend:-2.8}],f.value=[{id:"1",name:"Корпоративный хакатон",participantsCount:89,rating:4.8,growth:15.3},{id:"2",name:"Тренинг по лидерству",participantsCount:67,rating:4.7,growth:8.9},{id:"3",name:"Обучение по безопасности",participantsCount:45,rating:4.5,growth:-2.1},{id:"4",name:"Командообразование",participantsCount:34,rating:4.6,growth:22.7}],_.value=[{id:"1",type:"insight-warning",icon:"fas fa-exclamation-triangle",title:"Снижение активности в отделе продаж",description:"Участие снизилось на 15% за последний месяц",detailedDescription:"Детальный анализ показывает, что основные причины снижения связаны с высокой загрузкой сотрудников и недостатком времени на участие в мероприятиях."},{id:"2",type:"insight-success",icon:"fas fa-chart-line",title:"Рост вовлеченности IT отдела",description:"Показатели выросли на 20% после внедрения новых форматов",detailedDescription:"Успех связан с введением технических мероприятий и хакатонов, которые больше соответствуют интересам IT-специалистов."}],M.value=[{id:"1",priority:"high",title:"Увеличить частоту мероприятий для продажников",description:"Организовать короткие 30-минутные сессии в обеденное время",expectedImprovement:"+25% участия"},{id:"2",priority:"medium",title:"Внедрить геймификацию",description:"Добавить командные соревнования между отделами",expectedImprovement:"+15% вовлеченности"}],R.value=[{name:"Все сотрудники",count:247,percentage:100},{name:"Зарегистрированы в системе",count:198,percentage:80},{name:"Участвовали в мероприятиях",count:156,percentage:63},{name:"Активные участники",count:89,percentage:36},{name:"Постоянные участники",count:34,percentage:14}]}catch(p){console.error("Ошибка загрузки данных:",p),a.error("Ошибка загрузки статистики")}finally{d.value=!1}},W=()=>{setTimeout(()=>{q(),O()},100)},q=()=>{const p=document.getElementById("activityTimelineChart");if(p){const T=p.getContext("2d");T.fillStyle="#f8f9fa",T.fillRect(0,0,p.width,p.height),T.fillStyle="#333",T.font="16px Arial",T.textAlign="center",T.fillText("График динамики активности",p.width/2,p.height/2)}},O=()=>{const p=document.getElementById("departmentsComparisonChart");if(p){const T=p.getContext("2d");T.fillStyle="#f8f9fa",T.fillRect(0,0,p.width,p.height),T.fillStyle="#333",T.font="16px Arial",T.textAlign="center",T.fillText("График сравнения отделов",p.width/2,p.height/2)}},C=()=>{L(),a.success("Данные обновлены")},b=p=>{const T={executive:"отчета для руководства",detailed:"детальной статистики",hr:"HR аналитики"};a.info(`Экспорт ${T[p]} будет доступен в следующей версии`)},B=p=>{u.value=p,new bootstrap.Modal(document.getElementById("insightModal")).show()},at=p=>{a.info(`Реализация рекомендации "${p.title}" будет доступна в следующей версии`)};return dt(()=>{e.setPageTitle("Детальная статистика"),L().then(()=>{W()})}),{loading:d,selectedTimelineMetric:s,departmentView:m,selectedInsight:u,filters:o,kpiMetrics:l,departmentStats:v,topEvents:f,hrInsights:_,recommendations:M,funnelData:R,timelineMetrics:k,departments:V,formatNumber:I,getTrendClass:F,getTrendIcon:$,getParticipationClass:x,getPriorityClass:y,getPriorityLabel:D,loadData:L,refreshData:C,exportReport:b,viewInsightDetails:B,implementRecommendation:at}}},M5={class:"statistics-page"},I5={class:"page-header mb-4"},A5={class:"row align-items-center"},R5={class:"col-md-4 text-md-end"},E5={class:"header-actions"},N5={class:"dropdown"},U5={class:"dropdown-menu"},L5={class:"controls-section mb-4"},V5={class:"row g-3"},B5={class:"col-lg-3 col-md-6"},F5={key:0,class:"col-lg-3 col-md-6"},O5={key:1,class:"col-lg-3 col-md-6"},q5={class:"col-lg-3 col-md-6"},j5=["value"],H5={class:"kpi-section mb-4"},z5={class:"row g-3"},Z5={class:"col-lg-3 col-md-6"},W5={class:"kpi-card participation-kpi"},Y5={class:"kpi-content"},G5={class:"kpi-value"},Q5={class:"col-lg-3 col-md-6"},K5={class:"kpi-card engagement-kpi"},X5={class:"kpi-content"},J5={class:"kpi-value"},t6={class:"col-lg-3 col-md-6"},e6={class:"kpi-card satisfaction-kpi"},s6={class:"kpi-content"},a6={class:"kpi-value"},o6={class:"col-lg-3 col-md-6"},n6={class:"kpi-card retention-kpi"},i6={class:"kpi-content"},l6={class:"kpi-value"},r6={class:"statistics-content"},d6={class:"row"},c6={class:"col-lg-8"},u6={class:"chart-card activity-timeline-card mb-4"},m6={class:"card-header"},v6={class:"chart-controls"},f6=["onClick"],g6={class:"chart-card departments-comparison-card mb-4"},p6={class:"card-header"},b6={class:"view-toggle"},h6={class:"card-body"},_6={key:0,class:"departments-chart"},y6={key:1,class:"departments-table"},w6={class:"table-responsive"},k6={class:"table table-hover"},C6={class:"text-center"},x6={class:"text-center"},S6={class:"text-center"},$6={class:"text-center"},P6={class:"rating-stars"},D6={class:"text-center"},T6={class:"chart-card funnel-card"},M6={class:"card-body"},I6={class:"funnel-chart"},A6={class:"stage-content"},R6={class:"stage-name"},E6={class:"stage-count"},N6={class:"stage-percentage"},U6={class:"col-lg-4"},L6={class:"analytics-card top-events-card mb-4"},V6={class:"card-body"},B6={class:"top-events-list"},F6={class:"event-rank"},O6={class:"event-info"},q6={class:"event-name"},j6={class:"event-stats"},H6={class:"participants"},z6={class:"rating"},Z6={class:"analytics-card hr-insights-card mb-4"},W6={class:"card-body"},Y6={class:"insights-list"},G6={class:"insight-content"},Q6={class:"insight-title"},K6={class:"insight-description"},X6={class:"insight-action"},J6=["onClick"],t8={class:"analytics-card recommendations-card"},e8={class:"card-body"},s8={class:"recommendations-list"},a8={class:"recommendation-content"},o8={class:"recommendation-title"},n8={class:"recommendation-description"},i8={class:"recommendation-impact"},l8={class:"recommendation-actions"},r8=["onClick"],d8={id:"insightModal",class:"modal fade",tabindex:"-1","aria-labelledby":"insightModalLabel","aria-hidden":"true"},c8={class:"modal-dialog modal-lg"},u8={class:"modal-content"},m8={class:"modal-body"},v8={key:0};function f8(a,e,d,s,m,u){return n(),i("div",M5,[t("div",I5,[t("div",A5,[e[19]||(e[19]=t("div",{class:"col-md-8"},[t("h1",{class:"page-title"},[t("i",{class:"fas fa-chart-bar me-3"}),c(" Детальная статистика ")]),t("p",{class:"page-subtitle"}," Комплексная аналитика активности и вовлеченности сотрудников ")],-1)),t("div",R5,[t("div",E5,[t("button",{class:"btn btn-outline-light me-2",onClick:e[0]||(e[0]=(...o)=>s.refreshData&&s.refreshData(...o))},e[14]||(e[14]=[t("i",{class:"fas fa-sync-alt me-2"},null,-1),c(" Обновить ",-1)])),t("div",N5,[e[18]||(e[18]=t("button",{class:"btn btn-warning dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[t("i",{class:"fas fa-download me-2"}),c(" Экспорт ")],-1)),t("ul",U5,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=lt(o=>s.exportReport("executive"),["prevent"]))},e[15]||(e[15]=[t("i",{class:"fas fa-file-pdf me-2"},null,-1),c(" Отчет для руководства ",-1)]))]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=lt(o=>s.exportReport("detailed"),["prevent"]))},e[16]||(e[16]=[t("i",{class:"fas fa-file-excel me-2"},null,-1),c(" Детальная статистика ",-1)]))]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=lt(o=>s.exportReport("hr"),["prevent"]))},e[17]||(e[17]=[t("i",{class:"fas fa-users me-2"},null,-1),c(" HR аналитика ",-1)]))])])])])])])]),t("div",L5,[t("div",V5,[t("div",B5,[e[21]||(e[21]=t("label",{class:"form-label"},"Период анализа",-1)),E(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.filters.period=o),class:"form-select",onChange:e[5]||(e[5]=(...o)=>s.loadData&&s.loadData(...o))},e[20]||(e[20]=[rt('<option value="week" data-v-0404efc6>Последняя неделя</option><option value="month" data-v-0404efc6>Последний месяц</option><option value="quarter" data-v-0404efc6>Последний квартал</option><option value="year" data-v-0404efc6>Последний год</option><option value="custom" data-v-0404efc6>Выбрать период</option>',5)]),544),[[ot,s.filters.period]])]),s.filters.period==="custom"?(n(),i("div",F5,[e[22]||(e[22]=t("label",{class:"form-label"},"От",-1)),E(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=o=>s.filters.dateFrom=o),class:"form-control",onChange:e[7]||(e[7]=(...o)=>s.loadData&&s.loadData(...o))},null,544),[[et,s.filters.dateFrom]])])):g("",!0),s.filters.period==="custom"?(n(),i("div",O5,[e[23]||(e[23]=t("label",{class:"form-label"},"До",-1)),E(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=o=>s.filters.dateTo=o),class:"form-control",onChange:e[9]||(e[9]=(...o)=>s.loadData&&s.loadData(...o))},null,544),[[et,s.filters.dateTo]])])):g("",!0),t("div",q5,[e[25]||(e[25]=t("label",{class:"form-label"},"Отдел",-1)),E(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>s.filters.department=o),class:"form-select",onChange:e[11]||(e[11]=(...o)=>s.loadData&&s.loadData(...o))},[e[24]||(e[24]=t("option",{value:""},"Все отделы",-1)),(n(!0),i(H,null,G(s.departments,o=>(n(),i("option",{key:o,value:o},r(o),9,j5))),128))],544),[[ot,s.filters.department]])])])]),t("div",H5,[t("div",z5,[t("div",Z5,[t("div",W5,[e[27]||(e[27]=t("div",{class:"kpi-icon"},[t("i",{class:"fas fa-users"})],-1)),t("div",Y5,[t("div",G5,r(s.kpiMetrics.participationRate)+"%",1),e[26]||(e[26]=t("div",{class:"kpi-label"},"Участие в мероприятиях",-1)),t("div",{class:h(["kpi-trend",s.getTrendClass(s.kpiMetrics.participationTrend)])},[t("i",{class:h(s.getTrendIcon(s.kpiMetrics.participationTrend))},null,2),c(" "+r(Math.abs(s.kpiMetrics.participationTrend))+"% к прошлому периоду ",1)],2)])])]),t("div",Q5,[t("div",K5,[e[29]||(e[29]=t("div",{class:"kpi-icon"},[t("i",{class:"fas fa-fire"})],-1)),t("div",X5,[t("div",J5,r(s.kpiMetrics.engagementScore),1),e[28]||(e[28]=t("div",{class:"kpi-label"},"Индекс вовлеченности",-1)),t("div",{class:h(["kpi-trend",s.getTrendClass(s.kpiMetrics.engagementTrend)])},[t("i",{class:h(s.getTrendIcon(s.kpiMetrics.engagementTrend))},null,2),c(" "+r(Math.abs(s.kpiMetrics.engagementTrend))+"% к прошлому периоду ",1)],2)])])]),t("div",t6,[t("div",e6,[e[31]||(e[31]=t("div",{class:"kpi-icon"},[t("i",{class:"fas fa-smile"})],-1)),t("div",s6,[t("div",a6,r(s.kpiMetrics.satisfactionScore)+"/5",1),e[30]||(e[30]=t("div",{class:"kpi-label"},"Удовлетворенность",-1)),t("div",{class:h(["kpi-trend",s.getTrendClass(s.kpiMetrics.satisfactionTrend)])},[t("i",{class:h(s.getTrendIcon(s.kpiMetrics.satisfactionTrend))},null,2),c(" "+r(Math.abs(s.kpiMetrics.satisfactionTrend))+"% к прошлому периоду ",1)],2)])])]),t("div",o6,[t("div",n6,[e[33]||(e[33]=t("div",{class:"kpi-icon"},[t("i",{class:"fas fa-heart"})],-1)),t("div",i6,[t("div",l6,r(s.kpiMetrics.retentionRate)+"%",1),e[32]||(e[32]=t("div",{class:"kpi-label"},"Удержание участников",-1)),t("div",{class:h(["kpi-trend",s.getTrendClass(s.kpiMetrics.retentionTrend)])},[t("i",{class:h(s.getTrendIcon(s.kpiMetrics.retentionTrend))},null,2),c(" "+r(Math.abs(s.kpiMetrics.retentionTrend))+"% к прошлому периоду ",1)],2)])])])])]),t("div",r6,[t("div",d6,[t("div",c6,[t("div",u6,[t("div",m6,[e[34]||(e[34]=t("h5",{class:"card-title"},[t("i",{class:"fas fa-chart-line me-2"}),c(" Динамика активности ")],-1)),t("div",v6,[(n(!0),i(H,null,G(s.timelineMetrics,o=>(n(),i("button",{key:o.key,class:h(["btn btn-sm",s.selectedTimelineMetric===o.key?"btn-primary":"btn-outline-primary"]),onClick:l=>s.selectedTimelineMetric=o.key},r(o.label),11,f6))),128))])]),e[35]||(e[35]=t("div",{class:"card-body"},[t("canvas",{id:"activityTimelineChart",width:"400",height:"250"})],-1))]),t("div",g6,[t("div",p6,[e[36]||(e[36]=t("h5",{class:"card-title"},[t("i",{class:"fas fa-building me-2"}),c(" Сравнение отделов ")],-1)),t("div",b6,[t("button",{class:h(["btn btn-sm",s.departmentView==="chart"?"btn-primary":"btn-outline-primary"]),onClick:e[12]||(e[12]=o=>s.departmentView="chart")}," График ",2),t("button",{class:h(["btn btn-sm",s.departmentView==="table"?"btn-primary":"btn-outline-primary"]),onClick:e[13]||(e[13]=o=>s.departmentView="table")}," Таблица ",2)])]),t("div",h6,[s.departmentView==="chart"?(n(),i("div",_6,e[37]||(e[37]=[t("canvas",{id:"departmentsComparisonChart",width:"400",height:"250"},null,-1)]))):(n(),i("div",y6,[t("div",w6,[t("table",k6,[e[38]||(e[38]=t("thead",null,[t("tr",null,[t("th",null,"Отдел"),t("th",{class:"text-center"},"Сотрудников"),t("th",{class:"text-center"},"Участие"),t("th",{class:"text-center"},"Ср. баллы"),t("th",{class:"text-center"},"Удовлетворенность"),t("th",{class:"text-center"},"Тренд")])],-1)),t("tbody",null,[(n(!0),i(H,null,G(s.departmentStats,o=>(n(),i("tr",{key:o.name},[t("td",null,[t("strong",null,r(o.name),1)]),t("td",C6,r(o.employeeCount),1),t("td",x6,[t("span",{class:h(["participation-badge",s.getParticipationClass(o.participationRate)])},r(o.participationRate)+"% ",3)]),t("td",S6,r(s.formatNumber(o.averagePoints)),1),t("td",$6,[t("div",P6,[(n(),i(H,null,G(5,l=>t("i",{key:l,class:h([l<=o.satisfaction?"fas fa-star":"far fa-star","star"])},null,2)),64))])]),t("td",D6,[t("div",{class:h(["trend-indicator",s.getTrendClass(o.trend)])},[t("i",{class:h(s.getTrendIcon(o.trend))},null,2),c(" "+r(Math.abs(o.trend))+"% ",1)],2)])]))),128))])])])]))])]),t("div",T6,[e[39]||(e[39]=t("div",{class:"card-header"},[t("h5",{class:"card-title"},[t("i",{class:"fas fa-filter me-2"}),c(" Воронка участия ")])],-1)),t("div",M6,[t("div",I6,[(n(!0),i(H,null,G(s.funnelData,o=>(n(),i("div",{class:"funnel-stage",key:o.name},[t("div",{class:"stage-bar",style:st({width:o.percentage+"%"})},[t("div",A6,[t("span",R6,r(o.name),1),t("span",E6,r(s.formatNumber(o.count)),1),t("span",N6,r(o.percentage)+"%",1)])],4)]))),128))])])])]),t("div",U6,[t("div",L6,[e[40]||(e[40]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-trophy me-2"}),c(" Самые популярные мероприятия ")])],-1)),t("div",V6,[t("div",B6,[(n(!0),i(H,null,G(s.topEvents,(o,l)=>(n(),i("div",{key:o.id,class:"top-event-item"},[t("div",F6,r(l+1),1),t("div",O6,[t("div",q6,r(o.name),1),t("div",j6,[t("span",H6,r(o.participantsCount)+" участников",1),t("span",z6,r(o.rating)+"/5 ⭐",1)])]),t("div",{class:h(["event-growth",s.getTrendClass(o.growth)])},[t("i",{class:h(s.getTrendIcon(o.growth))},null,2),c(" "+r(Math.abs(o.growth))+"% ",1)],2)]))),128))])])]),t("div",Z6,[e[41]||(e[41]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-lightbulb me-2"}),c(" HR Insights ")])],-1)),t("div",W6,[t("div",Y6,[(n(!0),i(H,null,G(s.hrInsights,o=>(n(),i("div",{key:o.id,class:"insight-item"},[t("div",{class:h(["insight-icon",o.type])},[t("i",{class:h(o.icon)},null,2)],2),t("div",G6,[t("div",Q6,r(o.title),1),t("div",K6,r(o.description),1),t("div",X6,[t("button",{class:"btn btn-sm btn-outline-primary",onClick:l=>s.viewInsightDetails(o)}," Подробнее ",8,J6)])])]))),128))])])]),t("div",t8,[e[43]||(e[43]=t("div",{class:"card-header"},[t("h6",{class:"card-title"},[t("i",{class:"fas fa-robot me-2"}),c(" Рекомендации системы ")])],-1)),t("div",e8,[t("div",s8,[(n(!0),i(H,null,G(s.recommendations,o=>(n(),i("div",{key:o.id,class:"recommendation-item"},[t("div",{class:h(["recommendation-priority",s.getPriorityClass(o.priority)])},r(s.getPriorityLabel(o.priority)),3),t("div",a8,[t("div",o8,r(o.title),1),t("div",n8,r(o.description),1),t("div",i8,[e[42]||(e[42]=c(" Ожидаемое улучшение: ",-1)),t("strong",null,r(o.expectedImprovement),1)])]),t("div",l8,[t("button",{class:"btn btn-sm btn-success",onClick:l=>s.implementRecommendation(o)}," Применить ",8,r8)])]))),128))])])])])])]),t("div",d8,[t("div",c8,[t("div",u8,[e[44]||(e[44]=t("div",{class:"modal-header"},[t("h5",{id:"insightModalLabel",class:"modal-title"}," Детальный анализ "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть"})],-1)),t("div",m8,[s.selectedInsight?(n(),i("div",v8,[t("h6",null,r(s.selectedInsight.title),1),t("p",null,r(s.selectedInsight.detailedDescription),1)])):g("",!0)])])])])])}const g8=J(T5,[["render",f8],["__scopeId","data-v-0404efc6"]]),p8={name:"NotFoundPage",setup(){const a=bt();return{goBack:()=>{a.go(-1)}}}},b8={class:"not-found-page"},h8={class:"container"},_8={class:"text-center py-5"},y8={class:"error-actions mt-4"};function w8(a,e,d,s,m,u){const o=Q("router-link");return n(),i("div",b8,[t("div",h8,[t("div",_8,[e[3]||(e[3]=t("div",{class:"error-code"},"404",-1)),e[4]||(e[4]=t("h1",{class:"error-title"},"Страница не найдена",-1)),e[5]||(e[5]=t("p",{class:"error-description"}," Запрашиваемая страница не существует или была перемещена ",-1)),t("div",y8,[A(o,{to:"/dashboard",class:"btn btn-primary me-3"},{default:N(()=>e[1]||(e[1]=[t("i",{class:"fas fa-home me-2"},null,-1),c(" На главную ",-1)])),_:1,__:[1]}),t("button",{class:"btn btn-outline-secondary",onClick:e[0]||(e[0]=(...l)=>s.goBack&&s.goBack(...l))},e[2]||(e[2]=[t("i",{class:"fas fa-arrow-left me-2"},null,-1),c(" Назад ",-1)]))])])])])}const k8=J(p8,[["render",w8],["__scopeId","data-v-c907c1fa"]]),C8=[{path:"/",redirect:"/dashboard"},{path:"/auth",component:In,children:[{path:"",redirect:"/auth/login"},{path:"login",name:"Login",component:ei,meta:{title:"Вход в систему",requiresGuest:!0}},{path:"register",name:"Register",component:il,meta:{title:"Регистрация",requiresGuest:!0}}]},{path:"/",component:yn,meta:{requiresAuth:!0},children:[{path:"dashboard",name:"Dashboard",component:Or,meta:{title:"Главная",icon:"fas fa-home",showInNav:!0}},{path:"events",name:"Events",component:jc,meta:{title:"Мероприятия",icon:"fas fa-calendar-alt",showInNav:!0}},{path:"events/create",name:"EventCreate",component:Fu,meta:{title:"Создать мероприятие",roles:["moderator","admin"],breadcrumbs:[{text:"Мероприятия",to:"/events"},{text:"Создать мероприятие"}]}},{path:"events/:id",name:"EventDetail",component:Ru,props:!0,meta:{title:"Мероприятие",breadcrumbs:[{text:"Мероприятия",to:"/events"},{text:"Подробности"}]}},{path:"rewards",name:"Rewards",component:Lm,meta:{title:"Награды",icon:"fas fa-gift",showInNav:!0}},{path:"rewards/create",name:"RewardCreate",component:Av,meta:{title:"Создать награду",roles:["moderator","admin"],breadcrumbs:[{text:"Награды",to:"/rewards"},{text:"Создать награду"}]}},{path:"rewards/:id",name:"RewardDetail",component:Sv,props:!0,meta:{title:"Награда",breadcrumbs:[{text:"Награды",to:"/rewards"},{text:"Подробности"}]}},{path:"leaderboard",name:"Leaderboard",component:dk,meta:{title:"Рейтинг",icon:"fas fa-trophy",showInNav:!0}},{path:"profile",name:"Profile",component:oy,meta:{title:"Мой профиль",icon:"fas fa-user",showInNav:!0,inUserMenu:!0}},{path:"moderator",meta:{roles:["moderator","admin"]},children:[{path:"",name:"ModeratorDashboard",component:Wk,meta:{title:"Панель модератора",icon:"fas fa-shield-alt",showInNav:!0,roles:["moderator","admin"]}}]},{path:"admin",meta:{roles:["admin"]},children:[{path:"",name:"AdminDashboard",component:Nk,meta:{title:"Панель администратора",icon:"fas fa-crown",showInNav:!0,roles:["admin"]}},{path:"users",name:"UsersManagement",component:t5,meta:{title:"Управление пользователями",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Пользователи"}]}},{path:"events",name:"EventsManagement",component:l5,meta:{title:"Управление мероприятиями",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Мероприятия"}]}},{path:"rewards",name:"RewardsManagement",component:f5,meta:{title:"Управление наградами",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Награды"}]}},{path:"purchases",name:"PurchasesManagement",component:w5,meta:{title:"Управление покупками",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Покупки"}]}},{path:"registrations",name:"RegistrationsManagement",component:D5,meta:{title:"Управление регистрациями",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Регистрации"}]}},{path:"statistics",name:"StatisticsPage",component:g8,meta:{title:"Статистика",roles:["admin"],breadcrumbs:[{text:"Администрирование",to:"/admin"},{text:"Статистика"}]}}]}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:k8,meta:{title:"Страница не найдена"}}],Bt=Oe({history:qe("/"),routes:C8,scrollBehavior(a,e,d){return d||{top:0}}});Bt.beforeEach(async(a,e,d)=>{const s=pt(),m=ut();if(m.setLoading(!0),a.meta.requiresAuth){if(!await s.checkAuth())return m.setLoading(!1),d("/auth/login");if(a.meta.roles&&!s.canAccessRoute(a))return m.setLoading(!1),d("/dashboard")}if(a.meta.requiresGuest&&s.isAuthenticated)return m.setLoading(!1),d("/dashboard");d()});Bt.afterEach(a=>{const e=ut();a.meta.title&&e.setPageTitle(a.meta.title),a.meta.breadcrumbs?e.setBreadcrumbs(a.meta.breadcrumbs):e.setBreadcrumbs([]),window.innerWidth<992&&e.setSidebarOpen(!1),e.setLoading(!1)});Bt.onError(a=>{console.error("Ошибка навигации:",a),ut().setLoading(!1)});const x8={name:"AppNavbar",setup(){const a=bt(),e=mt(),d=pt(),s=ut(),m=w(""),u=w([]),o=w(!1),l=w({upcomingEvents:0,unreadNotifications:0,pendingRegistrations:0,pendingPurchases:0,pendingItems:0});let v=null;const f=D=>{if(!D)return"";const L=D.trim().split(" ");return L.length>=2?`${L[0]} ${L[1][0]}.`:D},_=D=>s.formatNumber(D),M=D=>s.formatRelativeDate(new Date(D)),R=()=>{m.value.trim()&&(a.push({name:"Search",query:{q:m.value.trim()}}),m.value="")},k=async()=>{try{o.value=!0}catch(D){console.error("Ошибка загрузки уведомлений:",D)}finally{o.value=!1}},V=async D=>{D.isRead||(D.isRead=!0,l.value.unreadNotifications--),D.actionUrl&&a.push(D.actionUrl)},I=async()=>{u.value.forEach(D=>D.isRead=!0),l.value.unreadNotifications=0,e.success("Все уведомления отмечены как прочитанные")},F=D=>({info:"fas fa-info-circle text-info",success:"fas fa-check-circle text-success",warning:"fas fa-exclamation-triangle text-warning",error:"fas fa-times-circle text-danger",event:"fas fa-calendar text-primary",points:"fas fa-coins text-warning",purchase:"fas fa-shopping-bag text-info"})[D]||"fas fa-bell text-secondary",$=()=>{s.toggleTheme()},x=async()=>{try{await d.logout(),e.success("Вы успешно вышли из системы")}catch{e.error("Ошибка при выходе из системы")}},y=async()=>{try{l.value={upcomingEvents:Math.floor(Math.random()*10),unreadNotifications:Math.floor(Math.random()*5),pendingRegistrations:Math.floor(Math.random()*3),pendingPurchases:Math.floor(Math.random()*2),pendingItems:0},l.value.pendingItems=l.value.pendingRegistrations+l.value.pendingPurchases}catch(D){console.error("Ошибка загрузки счетчиков:",D)}};return dt(()=>{y(),v=setInterval(y,3e4)}),Lt(()=>{v&&clearInterval(v)}),{authStore:d,appStore:s,searchQuery:m,notifications:u,notificationsLoading:o,counters:l,getShortName:f,formatNumber:_,formatRelativeTime:M,performSearch:R,loadNotifications:k,markAsRead:V,markAllAsRead:I,getNotificationIcon:F,toggleTheme:$,logout:x}}},S8={class:"app-navbar navbar navbar-expand-lg"},$8={class:"container-fluid"},P8={class:"collapse navbar-collapse",id:"navbarNav"},D8={class:"navbar-nav me-auto"},T8={class:"nav-item"},M8={class:"nav-item"},I8={key:0,class:"nav-badge"},A8={class:"nav-item"},R8={class:"nav-item"},E8={key:0,class:"nav-item dropdown"},N8={key:0,class:"nav-badge bg-warning"},U8={class:"dropdown-menu"},L8={key:0,class:"badge bg-warning ms-1"},V8={key:0,class:"badge bg-warning ms-1"},B8={key:0},F8={key:1},O8={key:2},q8={class:"navbar-nav"},j8={class:"nav-item d-none d-lg-block"},H8={class:"search-container"},z8={class:"nav-item dropdown"},Z8={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},W8={class:"dropdown-menu dropdown-menu-end notification-dropdown"},Y8={class:"dropdown-header d-flex justify-content-between"},G8={key:0,class:"text-center p-3"},Q8={key:1,class:"text-center p-3 text-muted"},K8=["onClick"],X8={class:"d-flex"},J8={class:"notification-icon me-2"},t7={class:"flex-grow-1"},e7={class:"notification-title"},s7={class:"notification-time small text-muted"},a7={key:0},o7={key:1},n7={class:"nav-item dropdown"},i7={class:"nav-link dropdown-toggle d-flex align-items-center",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},l7={class:"user-avatar me-2"},r7={key:0,class:"avatar-image"},d7=["src","alt"],c7={key:1,class:"avatar-initials"},u7={class:"d-none d-md-inline"},m7={class:"dropdown-menu dropdown-menu-end"},v7={class:"dropdown-header"},f7={class:"user-info"},g7={class:"user-name"},p7={class:"user-email small text-muted"},b7={class:"user-points small"};function h7(a,e,d,s,m,u){var l,v,f;const o=Q("router-link");return n(),i("nav",S8,[t("div",$8,[A(o,{class:"navbar-brand",to:"/dashboard"},{default:N(()=>e[6]||(e[6]=[t("div",{class:"brand-logo"},[t("i",{class:"fas fa-building"})],-1),t("span",{class:"brand-text"},"Учёт активности",-1)])),_:1,__:[6]}),e[40]||(e[40]=t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Переключить навигацию"},[t("span",{class:"navbar-toggler-icon"})],-1)),t("div",P8,[t("ul",D8,[t("li",T8,[A(o,{class:h(["nav-link",{active:a.$route.name==="Dashboard"}]),to:"/dashboard"},{default:N(()=>e[7]||(e[7]=[t("i",{class:"fas fa-home me-1"},null,-1),c(" Главная ",-1)])),_:1,__:[7]},8,["class"])]),t("li",M8,[A(o,{class:h(["nav-link",{active:a.$route.path.startsWith("/events")}]),to:"/events"},{default:N(()=>[e[8]||(e[8]=t("i",{class:"fas fa-calendar-alt me-1"},null,-1)),e[9]||(e[9]=c(" Мероприятия ",-1)),s.counters.upcomingEvents>0?(n(),i("span",I8,r(s.counters.upcomingEvents),1)):g("",!0)]),_:1,__:[8,9]},8,["class"])]),t("li",A8,[A(o,{class:h(["nav-link",{active:a.$route.path.startsWith("/rewards")}]),to:"/rewards"},{default:N(()=>e[10]||(e[10]=[t("i",{class:"fas fa-gift me-1"},null,-1),c(" Награды ",-1)])),_:1,__:[10]},8,["class"])]),t("li",R8,[A(o,{class:h(["nav-link",{active:a.$route.name==="Leaderboard"}]),to:"/leaderboard"},{default:N(()=>e[11]||(e[11]=[t("i",{class:"fas fa-trophy me-1"},null,-1),c(" Рейтинг ",-1)])),_:1,__:[11]},8,["class"])]),s.authStore.isModerator?(n(),i("li",E8,[t("a",{class:h(["nav-link dropdown-toggle",{active:a.$route.path.startsWith("/admin")}]),href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e[12]||(e[12]=t("i",{class:"fas fa-cogs me-1"},null,-1)),e[13]||(e[13]=c(" Управление ",-1)),s.counters.pendingItems>0?(n(),i("span",N8,r(s.counters.pendingItems),1)):g("",!0)],2),t("ul",U8,[t("li",null,[A(o,{class:"dropdown-item",to:"/admin"},{default:N(()=>e[14]||(e[14]=[t("i",{class:"fas fa-tachometer-alt me-2"},null,-1),c(" Панель управления ",-1)])),_:1,__:[14]})]),e[24]||(e[24]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[A(o,{class:"dropdown-item",to:"/admin/events"},{default:N(()=>e[15]||(e[15]=[t("i",{class:"fas fa-calendar-plus me-2"},null,-1),c(" Мероприятия ",-1)])),_:1,__:[15]})]),t("li",null,[A(o,{class:"dropdown-item",to:"/admin/rewards"},{default:N(()=>e[16]||(e[16]=[t("i",{class:"fas fa-gift me-2"},null,-1),c(" Награды ",-1)])),_:1,__:[16]})]),t("li",null,[A(o,{class:"dropdown-item",to:"/admin/registrations"},{default:N(()=>[e[17]||(e[17]=t("i",{class:"fas fa-user-check me-2"},null,-1)),e[18]||(e[18]=c(" Регистрации ",-1)),s.counters.pendingRegistrations>0?(n(),i("span",L8,r(s.counters.pendingRegistrations),1)):g("",!0)]),_:1,__:[17,18]})]),t("li",null,[A(o,{class:"dropdown-item",to:"/admin/purchases"},{default:N(()=>[e[19]||(e[19]=t("i",{class:"fas fa-shopping-cart me-2"},null,-1)),e[20]||(e[20]=c(" Покупки ",-1)),s.counters.pendingPurchases>0?(n(),i("span",V8,r(s.counters.pendingPurchases),1)):g("",!0)]),_:1,__:[19,20]})]),s.authStore.isAdmin?(n(),i("li",B8,e[21]||(e[21]=[t("hr",{class:"dropdown-divider"},null,-1)]))):g("",!0),s.authStore.isAdmin?(n(),i("li",F8,[A(o,{class:"dropdown-item",to:"/admin/users"},{default:N(()=>e[22]||(e[22]=[t("i",{class:"fas fa-users me-2"},null,-1),c(" Пользователи ",-1)])),_:1,__:[22]})])):g("",!0),s.authStore.isAdmin?(n(),i("li",O8,[A(o,{class:"dropdown-item",to:"/admin/statistics"},{default:N(()=>e[23]||(e[23]=[t("i",{class:"fas fa-chart-bar me-2"},null,-1),c(" Статистика ",-1)])),_:1,__:[23]})])):g("",!0)])])):g("",!0)]),t("ul",q8,[t("li",j8,[t("form",{class:"d-flex",onSubmit:e[1]||(e[1]=lt((..._)=>s.performSearch&&s.performSearch(..._),["prevent"]))},[t("div",H8,[E(t("input",{"onUpdate:modelValue":e[0]||(e[0]=_=>s.searchQuery=_),class:"form-control search-input",type:"search",placeholder:"Поиск...","aria-label":"Поиск"},null,512),[[et,s.searchQuery]]),e[25]||(e[25]=t("button",{class:"search-btn",type:"submit"},[t("i",{class:"fas fa-search"})],-1))])],32)]),t("li",z8,[t("a",{class:"nav-link position-relative",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:e[2]||(e[2]=(..._)=>s.loadNotifications&&s.loadNotifications(..._))},[e[26]||(e[26]=t("i",{class:"fas fa-bell"},null,-1)),s.counters.unreadNotifications>0?(n(),i("span",Z8,r(s.counters.unreadNotifications>9?"9+":s.counters.unreadNotifications),1)):g("",!0)]),t("ul",W8,[t("li",Y8,[e[27]||(e[27]=t("span",null,"Уведомления",-1)),s.notifications.length>0?(n(),i("button",{key:0,class:"btn btn-sm btn-link p-0",onClick:e[3]||(e[3]=(..._)=>s.markAllAsRead&&s.markAllAsRead(..._))}," Прочитать все ")):g("",!0)]),e[31]||(e[31]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),s.notificationsLoading?(n(),i("li",G8,e[28]||(e[28]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):s.notifications.length===0?(n(),i("li",Q8," Нет уведомлений ")):(n(),i(H,{key:2},[(n(!0),i(H,null,G(s.notifications.slice(0,5),_=>(n(),i("li",{key:_.id},[t("a",{class:h(["dropdown-item notification-item",{unread:!_.isRead}]),href:"#",onClick:lt(M=>s.markAsRead(_),["prevent"])},[t("div",X8,[t("div",J8,[t("i",{class:h(s.getNotificationIcon(_.type))},null,2)]),t("div",t7,[t("div",e7,r(_.title),1),t("div",s7,r(s.formatRelativeTime(_.createdAt)),1)])])],10,K8)]))),128)),s.notifications.length>5?(n(),i("li",a7,e[29]||(e[29]=[t("hr",{class:"dropdown-divider"},null,-1)]))):g("",!0),s.notifications.length>5?(n(),i("li",o7,[A(o,{class:"dropdown-item text-center",to:"/notifications"},{default:N(()=>e[30]||(e[30]=[c(" Показать все ",-1)])),_:1,__:[30]})])):g("",!0)],64))])]),t("li",n7,[t("a",i7,[t("div",l7,[(l=s.authStore.user)!=null&&l.avatar?(n(),i("div",r7,[t("img",{src:s.authStore.user.avatar,alt:s.authStore.fullName},null,8,d7)])):(n(),i("div",c7,r(s.authStore.initials),1))]),t("span",u7,r(s.getShortName(s.authStore.fullName)),1)]),t("ul",m7,[t("li",v7,[t("div",f7,[t("div",g7,r(s.authStore.fullName),1),t("div",p7,r((v=s.authStore.user)==null?void 0:v.email),1),t("div",b7,[e[32]||(e[32]=t("i",{class:"fas fa-coins text-warning"},null,-1)),c(" "+r(s.formatNumber(((f=s.authStore.user)==null?void 0:f.points)||0))+" баллов ",1)])])]),e[37]||(e[37]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[A(o,{class:"dropdown-item",to:"/profile"},{default:N(()=>e[33]||(e[33]=[t("i",{class:"fas fa-user me-2"},null,-1),c(" Мой профиль ",-1)])),_:1,__:[33]})]),t("li",null,[A(o,{class:"dropdown-item",to:"/profile/events"},{default:N(()=>e[34]||(e[34]=[t("i",{class:"fas fa-calendar me-2"},null,-1),c(" Мои мероприятия ",-1)])),_:1,__:[34]})]),t("li",null,[A(o,{class:"dropdown-item",to:"/profile/purchases"},{default:N(()=>e[35]||(e[35]=[t("i",{class:"fas fa-shopping-bag me-2"},null,-1),c(" Мои покупки ",-1)])),_:1,__:[35]})]),e[38]||(e[38]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[t("button",{class:"dropdown-item",onClick:e[4]||(e[4]=(..._)=>s.toggleTheme&&s.toggleTheme(..._))},[t("i",{class:h([s.appStore.theme==="dark"?"fas fa-sun":"fas fa-moon","me-2"])},null,2),c(" "+r(s.appStore.theme==="dark"?"Светлая тема":"Темная тема"),1)])]),e[39]||(e[39]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[t("button",{class:"dropdown-item text-danger",onClick:e[5]||(e[5]=(..._)=>s.logout&&s.logout(..._))},e[36]||(e[36]=[t("i",{class:"fas fa-sign-out-alt me-2"},null,-1),c(" Выйти ",-1)]))])])])])])])])}const _7=J(x8,[["render",h7],["__scopeId","data-v-f9629e97"]]),y7={name:"App",components:{AppNavbar:_7,AppFooter:Re},setup(){const a=jt(),e=pt(),d=ut(),s=j(()=>a.path.startsWith("/auth")),m=j(()=>d.isLoading);return dt(async()=>{await e.checkAuth()}),{isAuthPage:s,isLoading:m}}},w7={id:"app",class:"min-vh-100 d-flex flex-column"},k7={class:"flex-grow-1 d-flex flex-column"},C7={key:2,class:"global-loader"};function x7(a,e,d,s,m,u){const o=Q("AppNavbar"),l=Q("router-view"),v=Q("AppFooter");return n(),i("div",w7,[s.isAuthPage?g("",!0):(n(),ft(o,{key:0})),t("main",k7,[A(l)]),s.isAuthPage?g("",!0):(n(),ft(v,{key:1})),s.isLoading?(n(),i("div",C7,e[0]||(e[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Загрузка...")],-1)]))):g("",!0)])}const S7=J(y7,[["render",x7]]),$7={position:"top-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1},At=ue(S7);At.use(je());At.use(Bt);At.use(Bs,$7);At.config.globalProperties.$filters={formatDate(a,e="dd.MM.yyyy"){if(!a)return"";const d=new Date(a);if(isNaN(d.getTime()))return"";const s=String(d.getDate()).padStart(2,"0"),m=String(d.getMonth()+1).padStart(2,"0"),u=d.getFullYear(),o=String(d.getHours()).padStart(2,"0"),l=String(d.getMinutes()).padStart(2,"0");switch(e){case"dd.MM.yyyy":return`${s}.${m}.${u}`;case"dd.MM.yyyy HH:mm":return`${s}.${m}.${u} ${o}:${l}`;case"DD MMM YYYY":return`${s} ${["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"][d.getMonth()]} ${u}`;default:return`${s}.${m}.${u}`}},formatTime(a){if(!a)return"";const e=new Date(a);if(isNaN(e.getTime()))return"";const d=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return`${d}:${s}`},formatNumber(a){return!a&&a!==0?"":new Intl.NumberFormat("ru-RU").format(a)},pluralize(a,e){const d=[2,0,1,1,1,2];return e[a%100>4&&a%100<20?2:d[a%10<5?a%10:5]]},truncate(a,e=100){return a?a.length<=e?a:a.slice(0,e)+"...":""}};At.config.errorHandler=(a,e,d)=>{console.error("Глобальная ошибка Vue:",a),console.error("Контекст:",d);const s=At.config.globalProperties.$toast;s&&s.error("Произошла неожиданная ошибка. Попробуйте обновить страницу.")};At.mount("#app");
